(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,16015,(e,t,s)=>{},98547,(e,t,s)=>{var n=e.i(47167);e.r(16015);var i=e.r(71645),a=i&&"object"==typeof i&&"default"in i?i:{default:i},d=void 0!==n.default&&n.default.env&&!0,o=function(e){return"[object String]"===Object.prototype.toString.call(e)},r=function(){function e(e){var t=void 0===e?{}:e,s=t.name,n=void 0===s?"stylesheet":s,i=t.optimizeForSpeed,a=void 0===i?d:i;u(o(n),"`name` must be a string"),this._name=n,this._deletedRulePlaceholder="#"+n+"-deleted-rule____{}",u("boolean"==typeof a,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=a,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var r="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=r?r.getAttribute("content"):null}var t,s=e.prototype;return s.setOptimizeForSpeed=function(e){u("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),u(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},s.isOptimizeForSpeed=function(){return this._optimizeForSpeed},s.inject=function(){var e=this;if(u(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(d||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,s){return"number"==typeof s?e._serverSheet.cssRules[s]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),s},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},s.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},s.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},s.insertRule=function(e,t){if(u(o(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var s=this.getSheet();"number"!=typeof t&&(t=s.cssRules.length);try{s.insertRule(e,t)}catch(t){return d||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var n=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,n))}return this._rulesCount++},s.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var s="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!s.cssRules[e])return e;s.deleteRule(e);try{s.insertRule(t,e)}catch(n){d||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),s.insertRule(this._deletedRulePlaceholder,e)}}else{var n=this._tags[e];u(n,"old rule at index `"+e+"` not found"),n.textContent=t}return e},s.deleteRule=function(e){if("undefined"==typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];u(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},s.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},s.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,s){return s?t=t.concat(Array.prototype.map.call(e.getSheetForTag(s).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},s.makeStyleTag=function(e,t,s){t&&u(o(t),"makeStyleTag accepts only strings as second parameter");var n=document.createElement("style");this._nonce&&n.setAttribute("nonce",this._nonce),n.type="text/css",n.setAttribute("data-"+e,""),t&&n.appendChild(document.createTextNode(t));var i=document.head||document.getElementsByTagName("head")[0];return s?i.insertBefore(n,s):i.appendChild(n),n},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();function u(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var l=function(e){for(var t=5381,s=e.length;s;)t=33*t^e.charCodeAt(--s);return t>>>0},c={};function h(e,t){if(!t)return"jsx-"+e;var s=String(t),n=e+s;return c[n]||(c[n]="jsx-"+l(e+"-"+s)),c[n]}function m(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var s=e+t;return c[s]||(c[s]=t.replace(/__jsx-style-dynamic-selector/g,e)),c[s]}var _=function(){function e(e){var t=void 0===e?{}:e,s=t.styleSheet,n=void 0===s?null:s,i=t.optimizeForSpeed,a=void 0!==i&&i;this._sheet=n||new r({name:"styled-jsx",optimizeForSpeed:a}),this._sheet.inject(),n&&"boolean"==typeof a&&(this._sheet.setOptimizeForSpeed(a),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var s=this.getIdAndRules(e),n=s.styleId,i=s.rules;if(n in this._instancesCounts){this._instancesCounts[n]+=1;return}var a=i.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[n]=a,this._instancesCounts[n]=1},t.remove=function(e){var t=this,s=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(s in this._instancesCounts,"styleId: `"+s+"` not found"),this._instancesCounts[s]-=1,this._instancesCounts[s]<1){var n=this._fromServer&&this._fromServer[s];n?(n.parentNode.removeChild(n),delete this._fromServer[s]):(this._indices[s].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[s]),delete this._instancesCounts[s]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],s=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return s[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,s;return t=this.cssRules(),void 0===(s=e)&&(s={}),t.map(function(e){var t=e[0],n=e[1];return a.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:s.nonce?s.nonce:void 0,dangerouslySetInnerHTML:{__html:n}})})},t.getIdAndRules=function(e){var t=e.children,s=e.dynamic,n=e.id;if(s){var i=h(n,s);return{styleId:i,rules:Array.isArray(t)?t.map(function(e){return m(i,e)}):[m(i,t)]}}return{styleId:h(n),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),f=i.createContext(null);function p(){return new _}function g(){return i.useContext(f)}f.displayName="StyleSheetContext";var v=a.default.useInsertionEffect||a.default.useLayoutEffect,y="undefined"!=typeof window?p():void 0;function S(e){var t=y||g();return t&&("undefined"==typeof window?t.add(e):v(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}S.dynamic=function(e){return e.map(function(e){return h(e[0],e[1])}).join(" ")},s.StyleRegistry=function(e){var t=e.registry,s=e.children,n=i.useContext(f),d=i.useState(function(){return n||t||p()})[0];return a.default.createElement(f.Provider,{value:d},s)},s.createStyleRegistry=p,s.style=S,s.useStyleRegistry=g},37902,(e,t,s)=>{t.exports=e.r(98547).style},11870,e=>{"use strict";e.i(43476),e.i(37902);var t=e.i(71645),s=e.i(57951),n=e.i(18566);function i(e,a="/login"){let{user:d,isLoading:o,isAuthenticated:r,hasAccess:u}=(0,s.useAuth)(),l=(0,n.useRouter)(),[c,h]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{if(!o){if(!r)return void l.replace(a);if(!u(e)){if(d&&d.accessPages&&d.accessPages.length>0){let e=d.accessPages[0];l.replace({home:"/",sample1:"/sample1",sample2:"/sample2",users:"/users",products:"/products/add",suppliers:"/suppliers/add",shops:"/shops/add",grn:"/grn/add",discounts:"/discounts/add",settings:"/settings",reports:"/reports",debug:"/debug-access"}[e]||"/")}else l.replace("/login");return}h(!0)}},[o,r,u,e,d,l,a]),{isAuthorized:c&&r,isLoading:o,user:d,hasAccess:u}}e.s(["usePageProtection",()=>i])},83290,e=>{e.v({actions:"add-module__V-wXqG__actions",activate:"add-module__V-wXqG__activate",active:"add-module__V-wXqG__active",clearButton:"add-module__V-wXqG__clearButton",container:"add-module__V-wXqG__container",deactivate:"add-module__V-wXqG__deactivate",deleteButton:"add-module__V-wXqG__deleteButton",disabledButton:"add-module__V-wXqG__disabledButton",disabledInput:"add-module__V-wXqG__disabledInput",discountName:"add-module__V-wXqG__discountName",discountsContent:"add-module__V-wXqG__discountsContent",discountsHeader:"add-module__V-wXqG__discountsHeader",discountsList:"add-module__V-wXqG__discountsList",discountsTable:"add-module__V-wXqG__discountsTable",editButton:"add-module__V-wXqG__editButton",error:"add-module__V-wXqG__error",field:"add-module__V-wXqG__field",form:"add-module__V-wXqG__form",header:"add-module__V-wXqG__header",inactive:"add-module__V-wXqG__inactive",input:"add-module__V-wXqG__input",label:"add-module__V-wXqG__label",loadButton:"add-module__V-wXqG__loadButton",noDiscounts:"add-module__V-wXqG__noDiscounts",pageBtn:"add-module__V-wXqG__pageBtn",pageNumbers:"add-module__V-wXqG__pageNumbers",pagination:"add-module__V-wXqG__pagination",paginationInfo:"add-module__V-wXqG__paginationInfo",percentage:"add-module__V-wXqG__percentage",row:"add-module__V-wXqG__row",searchButton:"add-module__V-wXqG__searchButton",searchForm:"add-module__V-wXqG__searchForm",searchInput:"add-module__V-wXqG__searchInput",searchSection:"add-module__V-wXqG__searchSection",slideIn:"add-module__V-wXqG__slideIn",status:"add-module__V-wXqG__status",submitButton:"add-module__V-wXqG__submitButton",submitSection:"add-module__V-wXqG__submitSection",subtitle:"add-module__V-wXqG__subtitle",success:"add-module__V-wXqG__success",tableHeader:"add-module__V-wXqG__tableHeader",tableRow:"add-module__V-wXqG__tableRow",title:"add-module__V-wXqG__title",toggleButton:"add-module__V-wXqG__toggleButton",user:"add-module__V-wXqG__user"})},51228,e=>{"use strict";var t=e.i(43476),s=e.i(71645),n=e.i(57951),i=e.i(11870),a=e.i(75144),d=e.i(83290);function o(){let{isAuthorized:e,isLoading:o}=(0,i.usePageProtection)("discounts"),{user:r}=(0,n.useAuth)(),{isDarkMode:u}=(0,a.useTheme)(),[l,c]=(0,s.useState)([]),[h,m]=(0,s.useState)(""),[_,f]=(0,s.useState)(!1),[p,g]=(0,s.useState)(""),[v,y]=(0,s.useState)(""),[S,w]=(0,s.useState)({discountName:"",percentage:""}),[b,N]=(0,s.useState)(!1),[j,x]=(0,s.useState)(null),[C,q]=(0,s.useState)(!1),[R,G]=(0,s.useState)(1),[V,X]=(0,s.useState)({currentPage:1,totalPages:1,totalCount:0,hasNext:!1,hasPrev:!1,limit:10});if(o||!e)return null;let F=async(e=1,t="")=>{try{f(!0),y("");let s=new URLSearchParams({page:e.toString(),limit:"10",...t&&{search:t}}),n=await fetch(`/api/discounts?${s}`),i=await n.json();n.ok&&i.success?(c(i.discounts),X(i.pagination),G(e),q(!0),g(`Discounts loaded successfully! (Page ${e} of ${i.pagination.totalPages})`),setTimeout(()=>g(""),3e3)):y(i.error||"Failed to load discounts")}catch(e){y("An error occurred while loading discounts")}finally{f(!1)}},A=async e=>{if(e.preventDefault(),!r)return void y("Please log in to manage discounts");if(!S.discountName.trim()||!S.percentage.trim())return void y("Please fill in all fields");let t=parseFloat(S.percentage);if(isNaN(t)||t<0||t>100)return void y("Percentage must be a number between 0 and 100");f(!0),y(""),g("");try{let e=b?"PUT":"POST",s=await fetch("/api/discounts",{method:e,headers:{"Content-Type":"application/json","x-user-data":JSON.stringify(r)},body:JSON.stringify({...b&&{id:j},discountName:S.discountName.trim(),percentage:t,isActive:!0})}),n=await s.json();n.success?(g(b?"Discount updated successfully!":"Discount created successfully!"),w({discountName:"",percentage:""}),N(!1),x(null),C&&F(R,h),setTimeout(()=>g(""),3e3)):y(n.error||"Failed to save discount")}catch(e){y("An error occurred while saving discount")}finally{f(!1)}},P=e=>"cash"===e.toLowerCase()||"credit"===e.toLowerCase(),B=async(e,t,s)=>{if(P(t))return void y("Cash and Credit discounts cannot be deactivated as they are system required discounts.");if(window.confirm(`Are you sure you want to ${s?"deactivate":"activate"} the discount "${t}"?`)){f(!0);try{let t=await fetch(`/api/discounts?id=${e}&action=toggle`,{method:"DELETE"}),s=await t.json();s.success?(g(s.message),C&&F(R,h),setTimeout(()=>g(""),3e3)):y(s.error||"Failed to update discount status")}catch(e){y("An error occurred while updating discount status")}finally{f(!1)}}},T=async(e,t)=>{if(P(t))return void y("Cash and Credit discounts cannot be deleted as they are system required discounts.");if(window.confirm(`⚠️ PERMANENT DELETE WARNING!

Are you sure you want to PERMANENTLY delete "${t}"?

This action CANNOT be undone and will remove the discount from the database completely.`)&&window.confirm(`Final confirmation: Permanently delete "${t}"?

Click OK to proceed with permanent deletion.`)){f(!0);try{let s=await fetch(`/api/discounts?id=${e}&action=permanent`,{method:"DELETE"}),n=await s.json();n.success?(g(`Discount "${t}" permanently deleted successfully!`),C&&F(R,h),setTimeout(()=>g(""),3e3)):y(n.error||"Failed to permanently delete discount")}catch(e){y("An error occurred while permanently deleting discount")}finally{f(!1)}}};return(0,t.jsxs)("div",{className:`${d.default.container} ${u?"dark":"light"}`,children:[(0,t.jsxs)("div",{className:d.default.header,children:[(0,t.jsx)("h1",{className:d.default.title,children:b?"Edit Discount":"Discount Management"}),b&&(0,t.jsx)("button",{type:"button",onClick:()=>{w({discountName:"",percentage:""}),N(!1),x(null),y(""),g("")},className:d.default.clearButton,children:"Cancel Edit"})]}),(0,t.jsxs)("form",{onSubmit:A,className:d.default.form,children:[(0,t.jsxs)("div",{className:d.default.row,children:[(0,t.jsxs)("div",{className:d.default.field,children:[(0,t.jsx)("label",{className:d.default.label,children:"Discount Name:"}),(0,t.jsx)("input",{type:"text",value:S.discountName,onChange:e=>w(t=>({...t,discountName:e.target.value})),className:`${d.default.input} ${b&&P(S.discountName)?d.default.disabledInput:""}`,placeholder:"Enter discount name (e.g., Summer Sale, VIP Discount)",readOnly:b&&P(S.discountName),disabled:b&&P(S.discountName),title:b&&P(S.discountName)?"Cash and Credit discount names cannot be changed":"",required:!0})]}),(0,t.jsxs)("div",{className:d.default.field,children:[(0,t.jsx)("label",{className:d.default.label,children:"Percentage (%):"}),(0,t.jsx)("input",{type:"number",step:"0.01",min:"0",max:"100",value:S.percentage,onChange:e=>w(t=>({...t,percentage:e.target.value})),className:d.default.input,placeholder:"Enter percentage (0-100)",required:!0})]})]}),(0,t.jsx)("div",{className:d.default.submitSection,children:(0,t.jsx)("button",{type:"submit",className:d.default.submitButton,disabled:_,children:_?b?"Updating...":"Creating...":b?"Update Discount":"Create Discount"})}),p&&(0,t.jsx)("p",{className:d.default.success,children:p}),v&&(0,t.jsx)("p",{className:d.default.error,children:v})]}),(0,t.jsxs)("div",{className:d.default.discountsList,children:[(0,t.jsxs)("div",{className:d.default.discountsHeader,children:[(0,t.jsx)("h2",{className:d.default.subtitle,children:"Existing Discounts"}),(0,t.jsxs)("div",{className:d.default.searchSection,children:[(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),C&&F(1,h)},className:d.default.searchForm,children:[(0,t.jsx)("input",{type:"text",placeholder:"Search discounts...",value:h,onChange:e=>m(e.target.value),className:d.default.searchInput}),(0,t.jsx)("button",{type:"submit",className:d.default.searchButton,disabled:_,children:"Search"})]}),(0,t.jsx)("button",{onClick:()=>F(1),className:d.default.loadButton,disabled:_,children:_?"Loading...":"Load Discounts"})]})]}),C&&(0,t.jsxs)("div",{className:d.default.discountsContent,children:[0===l.length?(0,t.jsx)("p",{className:d.default.noDiscounts,children:"No discounts found."}):(0,t.jsxs)("div",{className:d.default.discountsTable,children:[(0,t.jsxs)("div",{className:d.default.tableHeader,children:[(0,t.jsx)("div",{children:"Discount Name"}),(0,t.jsx)("div",{children:"Percentage"}),(0,t.jsx)("div",{children:"Status"}),(0,t.jsx)("div",{children:"Created By"}),(0,t.jsx)("div",{children:"Actions"})]}),l.map(e=>(0,t.jsxs)("div",{className:d.default.tableRow,children:[(0,t.jsx)("div",{className:d.default.discountName,children:e.discountName}),(0,t.jsxs)("div",{className:d.default.percentage,children:[e.percentage,"%"]}),(0,t.jsx)("div",{children:(0,t.jsx)("span",{className:`${d.default.status} ${e.isActive?d.default.active:d.default.inactive}`,children:e.isActive?"Active":"Inactive"})}),(0,t.jsx)("div",{className:d.default.user,children:e.user}),(0,t.jsx)("div",{className:d.default.actions,children:P(e.discountName)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>{w({discountName:e.discountName,percentage:e.percentage.toString()}),N(!0),x(e.id),y(""),g(`Editing ${e.discountName} discount - Name cannot be changed, only percentage can be updated.`),window.scrollTo({top:0,behavior:"smooth"})},className:d.default.editButton,disabled:_,title:"Edit percentage only",children:"Edit %"}),(0,t.jsx)("button",{className:`${d.default.toggleButton} ${d.default.disabledButton}`,disabled:!0,title:"System discounts are always active",children:"Always Active"}),(0,t.jsx)("button",{className:`${d.default.deleteButton} ${d.default.disabledButton}`,disabled:!0,title:"System discounts cannot be deleted",children:"Protected"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>{P(e.discountName)?y("Cash and Credit discount names cannot be edited. You can only change their percentage values."):(w({discountName:e.discountName,percentage:e.percentage.toString()}),N(!0),x(e.id),y(""),g(""),window.scrollTo({top:0,behavior:"smooth"}))},className:d.default.editButton,disabled:_,children:"Edit"}),(0,t.jsx)("button",{onClick:()=>B(e.id,e.discountName,e.isActive),className:`${d.default.toggleButton} ${e.isActive?d.default.deactivate:d.default.activate}`,disabled:_,children:e.isActive?"Deactivate":"Activate"}),(0,t.jsx)("button",{onClick:()=>T(e.id,e.discountName),className:d.default.deleteButton,disabled:_,children:"Delete"})]})})]},e.id))]}),V.totalPages>1&&(0,t.jsxs)("div",{className:d.default.pagination,children:[(0,t.jsx)("button",{onClick:()=>F(R-1,h),disabled:!V.hasPrev||_,className:d.default.pageBtn,children:"Previous"}),(0,t.jsx)("div",{className:d.default.pageNumbers,children:Array.from({length:Math.min(5,V.totalPages)},(e,s)=>{let n=Math.max(1,R-2)+s;return n<=V.totalPages?(0,t.jsx)("button",{onClick:()=>F(n,h),disabled:_,className:`${d.default.pageBtn} ${n===R?d.default.active:""}`,children:n},n):null})}),(0,t.jsx)("button",{onClick:()=>F(R+1,h),disabled:!V.hasNext||_,className:d.default.pageBtn,children:"Next"})]}),(0,t.jsx)("div",{className:d.default.paginationInfo,children:(0,t.jsxs)("p",{children:["Showing page ",V.currentPage," of ",V.totalPages,"(",V.totalCount," total discounts)"]})})]})]})]})}e.s(["default",()=>o])}]);