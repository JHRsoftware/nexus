(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,16015,(e,t,s)=>{},98547,(e,t,s)=>{var a=e.i(47167);e.r(16015);var r=e.r(71645),n=r&&"object"==typeof r&&"default"in r?r:{default:r},i=void 0!==a.default&&a.default.env&&!0,d=function(e){return"[object String]"===Object.prototype.toString.call(e)},l=function(){function e(e){var t=void 0===e?{}:e,s=t.name,a=void 0===s?"stylesheet":s,r=t.optimizeForSpeed,n=void 0===r?i:r;o(d(a),"`name` must be a string"),this._name=a,this._deletedRulePlaceholder="#"+a+"-deleted-rule____{}",o("boolean"==typeof n,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=n,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var l="undefined"!=typeof window&&document.querySelector('meta[property="csp-nonce"]');this._nonce=l?l.getAttribute("content"):null}var t,s=e.prototype;return s.setOptimizeForSpeed=function(e){o("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),o(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},s.isOptimizeForSpeed=function(){return this._optimizeForSpeed},s.inject=function(){var e=this;if(o(!this._injected,"sheet already injected"),this._injected=!0,"undefined"!=typeof window&&this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(i||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,s){return"number"==typeof s?e._serverSheet.cssRules[s]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),s},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},s.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},s.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},s.insertRule=function(e,t){if(o(d(e),"`insertRule` accepts only strings"),"undefined"==typeof window)return"number"!=typeof t&&(t=this._serverSheet.cssRules.length),this._serverSheet.insertRule(e,t),this._rulesCount++;if(this._optimizeForSpeed){var s=this.getSheet();"number"!=typeof t&&(t=s.cssRules.length);try{s.insertRule(e,t)}catch(t){return i||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var a=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,a))}return this._rulesCount++},s.replaceRule=function(e,t){if(this._optimizeForSpeed||"undefined"==typeof window){var s="undefined"!=typeof window?this.getSheet():this._serverSheet;if(t.trim()||(t=this._deletedRulePlaceholder),!s.cssRules[e])return e;s.deleteRule(e);try{s.insertRule(t,e)}catch(a){i||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),s.insertRule(this._deletedRulePlaceholder,e)}}else{var a=this._tags[e];o(a,"old rule at index `"+e+"` not found"),a.textContent=t}return e},s.deleteRule=function(e){if("undefined"==typeof window)return void this._serverSheet.deleteRule(e);if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];o(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},s.flush=function(){this._injected=!1,this._rulesCount=0,"undefined"!=typeof window?(this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]):this._serverSheet.cssRules=[]},s.cssRules=function(){var e=this;return"undefined"==typeof window?this._serverSheet.cssRules:this._tags.reduce(function(t,s){return s?t=t.concat(Array.prototype.map.call(e.getSheetForTag(s).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},s.makeStyleTag=function(e,t,s){t&&o(d(t),"makeStyleTag accepts only strings as second parameter");var a=document.createElement("style");this._nonce&&a.setAttribute("nonce",this._nonce),a.type="text/css",a.setAttribute("data-"+e,""),t&&a.appendChild(document.createTextNode(t));var r=document.head||document.getElementsByTagName("head")[0];return s?r.insertBefore(a,s):r.appendChild(a),a},t=[{key:"length",get:function(){return this._rulesCount}}],function(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(e.prototype,t),e}();function o(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var u=function(e){for(var t=5381,s=e.length;s;)t=33*t^e.charCodeAt(--s);return t>>>0},c={};function p(e,t){if(!t)return"jsx-"+e;var s=String(t),a=e+s;return c[a]||(c[a]="jsx-"+u(e+"-"+s)),c[a]}function m(e,t){"undefined"==typeof window&&(t=t.replace(/\/style/gi,"\\/style"));var s=e+t;return c[s]||(c[s]=t.replace(/__jsx-style-dynamic-selector/g,e)),c[s]}var h=function(){function e(e){var t=void 0===e?{}:e,s=t.styleSheet,a=void 0===s?null:s,r=t.optimizeForSpeed,n=void 0!==r&&r;this._sheet=a||new l({name:"styled-jsx",optimizeForSpeed:n}),this._sheet.inject(),a&&"boolean"==typeof n&&(this._sheet.setOptimizeForSpeed(n),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),"undefined"==typeof window||this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var s=this.getIdAndRules(e),a=s.styleId,r=s.rules;if(a in this._instancesCounts){this._instancesCounts[a]+=1;return}var n=r.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[a]=n,this._instancesCounts[a]=1},t.remove=function(e){var t=this,s=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(s in this._instancesCounts,"styleId: `"+s+"` not found"),this._instancesCounts[s]-=1,this._instancesCounts[s]<1){var a=this._fromServer&&this._fromServer[s];a?(a.parentNode.removeChild(a),delete this._fromServer[s]):(this._indices[s].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[s]),delete this._instancesCounts[s]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],s=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return s[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,s;return t=this.cssRules(),void 0===(s=e)&&(s={}),t.map(function(e){var t=e[0],a=e[1];return n.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:s.nonce?s.nonce:void 0,dangerouslySetInnerHTML:{__html:a}})})},t.getIdAndRules=function(e){var t=e.children,s=e.dynamic,a=e.id;if(s){var r=p(a,s);return{styleId:r,rules:Array.isArray(t)?t.map(function(e){return m(r,e)}):[m(r,t)]}}return{styleId:p(a),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),f=r.createContext(null);function _(){return new h}function g(){return r.useContext(f)}f.displayName="StyleSheetContext";var y=n.default.useInsertionEffect||n.default.useLayoutEffect,v="undefined"!=typeof window?_():void 0;function N(e){var t=v||g();return t&&("undefined"==typeof window?t.add(e):y(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)])),null}N.dynamic=function(e){return e.map(function(e){return p(e[0],e[1])}).join(" ")},s.StyleRegistry=function(e){var t=e.registry,s=e.children,a=r.useContext(f),i=r.useState(function(){return a||t||_()})[0];return n.default.createElement(f.Provider,{value:i},s)},s.createStyleRegistry=_,s.style=N,s.useStyleRegistry=g},37902,(e,t,s)=>{t.exports=e.r(98547).style},11870,e=>{"use strict";e.i(43476),e.i(37902);var t=e.i(71645),s=e.i(57951),a=e.i(18566);function r(e,n="/login"){let{user:i,isLoading:d,isAuthenticated:l,hasAccess:o}=(0,s.useAuth)(),u=(0,a.useRouter)(),[c,p]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{if(!d){if(!l)return void u.replace(n);if(!o(e)){if(i&&i.accessPages&&i.accessPages.length>0){let e=i.accessPages[0];u.replace({home:"/",sample1:"/sample1",sample2:"/sample2",users:"/users",products:"/products/add",suppliers:"/suppliers/add",shops:"/shops/add",grn:"/grn/add",discounts:"/discounts/add",settings:"/settings",reports:"/reports",debug:"/debug-access"}[e]||"/")}else u.replace("/login");return}p(!0)}},[d,l,o,e,i,u,n]),{isAuthorized:c&&l,isLoading:d,user:i,hasAccess:o}}e.s(["usePageProtection",()=>r])},89088,e=>{"use strict";e.s(["handleNumberInputWheel",0,e=>{e.target.blur(),e.preventDefault()}])},78966,e=>{e.v({active:"add-module__gyZfRq__active",addButton:"add-module__gyZfRq__addButton",clearButton:"add-module__gyZfRq__clearButton",clearSupplierButton:"add-module__gyZfRq__clearSupplierButton",container:"add-module__gyZfRq__container",dropdown:"add-module__gyZfRq__dropdown",dropdownItem:"add-module__gyZfRq__dropdownItem",editButton:"add-module__gyZfRq__editButton",error:"add-module__gyZfRq__error",field:"add-module__gyZfRq__field",form:"add-module__gyZfRq__form",grnActions:"add-module__gyZfRq__grnActions",grnAmount:"add-module__gyZfRq__grnAmount",grnDetails:"add-module__gyZfRq__grnDetails",grnHeader:"add-module__gyZfRq__grnHeader",grnInfo:"add-module__gyZfRq__grnInfo",grnItem:"add-module__gyZfRq__grnItem",grnItems:"add-module__gyZfRq__grnItems",grnsContent:"add-module__gyZfRq__grnsContent",grnsHeader:"add-module__gyZfRq__grnsHeader",grnsList:"add-module__gyZfRq__grnsList",header:"add-module__gyZfRq__header",input:"add-module__gyZfRq__input",inputWrapper:"add-module__gyZfRq__inputWrapper",itemsTable:"add-module__gyZfRq__itemsTable",label:"add-module__gyZfRq__label",loadButton:"add-module__gyZfRq__loadButton",noGrns:"add-module__gyZfRq__noGrns",pageBtn:"add-module__gyZfRq__pageBtn",pageNumbers:"add-module__gyZfRq__pageNumbers",pagination:"add-module__gyZfRq__pagination",paginationInfo:"add-module__gyZfRq__paginationInfo",productInfo:"add-module__gyZfRq__productInfo",productSearch:"add-module__gyZfRq__productSearch",readOnlyInput:"add-module__gyZfRq__readOnlyInput",removeButton:"add-module__gyZfRq__removeButton",row:"add-module__gyZfRq__row",searchContainer:"add-module__gyZfRq__searchContainer",section:"add-module__gyZfRq__section",sectionTitle:"add-module__gyZfRq__sectionTitle",select:"add-module__gyZfRq__select",selectedInput:"add-module__gyZfRq__selectedInput",slideIn:"add-module__gyZfRq__slideIn",smallInput:"add-module__gyZfRq__smallInput",submitButton:"add-module__gyZfRq__submitButton",submitSection:"add-module__gyZfRq__submitSection",subtitle:"add-module__gyZfRq__subtitle",success:"add-module__gyZfRq__success",supplierInfo:"add-module__gyZfRq__supplierInfo",tableFooter:"add-module__gyZfRq__tableFooter",tableHeader:"add-module__gyZfRq__tableHeader",tableRow:"add-module__gyZfRq__tableRow",title:"add-module__gyZfRq__title",totalAmount:"add-module__gyZfRq__totalAmount",totalCost:"add-module__gyZfRq__totalCost"})},20111,e=>{"use strict";var t=e.i(43476),s=e.i(57951),a=e.i(75144),r=e.i(11870),n=e.i(89088),i=e.i(71645),d=e.i(78966);function l(){let{isAuthorized:e,isLoading:l}=(0,r.usePageProtection)("grn"),{user:o}=(0,s.useAuth)(),{isDarkMode:u}=(0,a.useTheme)(),[c,p]=(0,i.useState)(""),[m,h]=(0,i.useState)(""),[f,_]=(0,i.useState)(!1),[g,y]=(0,i.useState)({grnDate:new Date().toISOString().split("T")[0],supplierId:"",invoiceNumber:"",poNumber:"",paymentType:"cash"}),[v,N]=(0,i.useState)(null),[x,S]=(0,i.useState)(""),[R,j]=(0,i.useState)([]),[b,I]=(0,i.useState)(!1),[C,q]=(0,i.useState)(""),[w,P]=(0,i.useState)([]),[T,F]=(0,i.useState)(!1),[Z,A]=(0,i.useState)([]),[G,O]=(0,i.useState)({productId:0,quantity:1,costPrice:0}),[B,$]=(0,i.useState)([]),[z,k]=(0,i.useState)(!1),[D,E]=(0,i.useState)(1),[W,L]=(0,i.useState)({currentPage:1,totalPages:1,totalCount:0,hasNext:!1,hasPrev:!1}),[H,U]=(0,i.useState)(!1),[J,Q]=(0,i.useState)(null),[M,Y]=(0,i.useState)(null),K=async e=>{if(e.length<2)return void j([]);try{let t=await fetch(`/api/suppliers/search?q=${encodeURIComponent(e)}`),s=await t.json();t.ok&&j(s.suppliers||[])}catch(e){}},V=async e=>{if(e.length<2)return void P([]);try{let t=await fetch(`/api/products/search?q=${encodeURIComponent(e)}`),s=await t.json();t.ok&&P(s.products||[])}catch(e){}};(0,i.useEffect)(()=>{let e=setTimeout(()=>{x&&!v?(K(x),I(!0)):x&&v&&x!==v.supplierName?(N(null),y(e=>({...e,supplierId:""})),K(x),I(!0)):(j([]),I(!1))},300);return()=>clearTimeout(e)},[x,v]),(0,i.useEffect)(()=>{let e=setTimeout(()=>{C?(V(C),F(!0)):(P([]),F(!1))},300);return()=>clearTimeout(e)},[C]);let X=async e=>{if(Z.find(t=>t.productId===e.id))return void h("Product already added to GRN. You can update quantity in the table below.");if(!G.quantity||G.quantity<=0)return void h("Invalid quantity. Please enter a number greater than 0.");if(!G.costPrice||G.costPrice<=0)return void h("Invalid cost price. Please enter a number greater than 0.");if(H&&J&&o){_(!0);try{let t=await fetch("/api/grn/add-item",{method:"POST",headers:{"Content-Type":"application/json","x-user-data":JSON.stringify(o)},body:JSON.stringify({grnId:J,productId:e.id,quantity:G.quantity,costPrice:G.costPrice})}),s=await t.json();if(!s.success){h(s.error||"Failed to add item to GRN"),_(!1);return}let{result:a}=s;p(`Item added successfully! GRN total updated to Rs. ${parseFloat(a.newTotalAmount).toFixed(2)}. ${a.totalItemsCount} item(s) in GRN.`);let r={productId:e.id,productCode:e.productCode,itemName:e.itemName,quantity:G.quantity,costPrice:G.costPrice,totalCost:G.quantity*G.costPrice};A(e=>[...e,r]),q(""),F(!1),P([]),O({productId:0,quantity:1,costPrice:0}),h(""),z&&es(D),setTimeout(()=>p(""),5e3)}catch(e){h("An error occurred while adding item to GRN")}finally{_(!1)}}else{let t={productId:e.id,productCode:e.productCode,itemName:e.itemName,quantity:G.quantity,costPrice:G.costPrice,totalCost:G.quantity*G.costPrice};A(e=>[...e,t]),q(""),F(!1),P([]),O({productId:0,quantity:1,costPrice:0}),h(""),p("Product added to GRN successfully!"),setTimeout(()=>p(""),3e3)}},ee=async e=>{let t=Z.find(t=>t.productId===e);if(!t)return void h("Item not found");if(window.confirm(`Are you sure you want to remove this item?

Product: ${t.itemName}
Quantity: ${t.quantity}
Cost Price: Rs. ${parseFloat(t.costPrice.toString()).toFixed(2)}
Total Cost: Rs. ${parseFloat(t.totalCost.toString()).toFixed(2)}

This action cannot be undone.`)){if(Y(e),H&&J&&o)try{let t=await fetch(`/api/grn/remove-item?grnId=${J}&productId=${e}`,{method:"DELETE",headers:{"Content-Type":"application/json","x-user-data":JSON.stringify(o)}}),s=await t.json();if(!s.success){h(s.error||"Failed to remove item from GRN"),Y(null);return}let{result:a}=s;p(`Item removed successfully! GRN total updated to Rs. ${parseFloat(a.newTotalAmount).toFixed(2)}. ${a.remainingItemsCount} item(s) remaining in GRN.`),setTimeout(()=>p(""),5e3),A(t=>t.filter(t=>t.productId!==e)),Y(null),z&&es(D);return}catch(e){h("An error occurred while removing GRN item"),Y(null);return}A(t=>t.filter(t=>t.productId!==e)),Y(null),H||(p("Item removed successfully!"),setTimeout(()=>p(""),3e3))}},et=(e,t,s)=>{A(a=>a.map(a=>{if(a.productId===e){let e={...a,[t]:s};return e.totalCost=e.quantity*e.costPrice,e}return a}))},es=async(e=1,t="")=>{try{_(!0),h("");let s=new URLSearchParams({page:e.toString(),limit:"10",...t&&{search:t}}),a=await fetch(`/api/grn?${s}`),r=await a.json();a.ok&&r.grns?($(r.grns),L(r.pagination),E(e),k(!0),p(`GRNs loaded successfully! (Page ${e} of ${r.pagination.totalPages})`)):h(r.error||"Failed to load GRNs")}catch(e){h("An error occurred while loading GRNs")}finally{_(!1)}},ea=()=>{U(!1),Q(null),Y(null),y({grnDate:new Date().toISOString().split("T")[0],supplierId:"",invoiceNumber:"",poNumber:"",paymentType:"cash"}),N(null),S(""),A([]),O({productId:0,quantity:1,costPrice:0}),h(""),p("Form cleared. You can now create a new GRN.")},er=async e=>{if(e.preventDefault(),!o)return void h("Please log in to "+(H?"update":"create")+" GRN");if(!v)return void h("Please select a supplier");if(0===Z.length)return void h("Please add at least one product");_(!0),h(""),p("");try{let e=H?`/api/grn/${J}`:"/api/grn",t=H?"PUT":"POST",s=await fetch(e,{method:t,headers:{"Content-Type":"application/json","x-user-data":JSON.stringify(o)},body:JSON.stringify({...g,items:Z})}),a=await s.json();a.success?(p(H?"GRN updated successfully!":"GRN created successfully!"),H?ea():(y({grnDate:new Date().toISOString().split("T")[0],supplierId:"",invoiceNumber:"",poNumber:"",paymentType:"cash"}),N(null),S(""),A([])),z&&es(D)):h(a.error||"Failed to "+(H?"update":"create")+" GRN")}catch(e){h("An error occurred while "+(H?"updating":"creating")+" GRN")}finally{_(!1)}};return l||!e?null:o?(0,t.jsxs)("div",{className:`${d.default.container} ${u?"dark":"light"}`,children:[(0,t.jsxs)("div",{className:d.default.header,children:[(0,t.jsx)("h1",{className:d.default.title,children:H?`Edit GRN #${J}`:"Create New GRN"}),H&&(0,t.jsx)("button",{type:"button",onClick:ea,className:d.default.clearButton,children:"Clear & Create New"})]}),(0,t.jsxs)("form",{onSubmit:er,className:d.default.form,children:[(0,t.jsxs)("div",{className:d.default.section,children:[(0,t.jsx)("h2",{className:d.default.sectionTitle,children:"GRN Details"}),(0,t.jsxs)("div",{className:d.default.row,children:[(0,t.jsxs)("div",{className:d.default.field,children:[(0,t.jsx)("label",{className:d.default.label,children:"GRN Date:"}),(0,t.jsx)("input",{type:"date",value:g.grnDate,onChange:e=>y(t=>({...t,grnDate:e.target.value})),className:d.default.input,required:!0})]}),(0,t.jsxs)("div",{className:d.default.field,children:[(0,t.jsx)("label",{className:d.default.label,children:"Invoice Number:"}),(0,t.jsx)("input",{type:"text",value:g.invoiceNumber,onChange:e=>y(t=>({...t,invoiceNumber:e.target.value})),className:d.default.input,placeholder:"Enter invoice number",required:!0})]})]}),(0,t.jsxs)("div",{className:d.default.row,children:[(0,t.jsxs)("div",{className:d.default.field,children:[(0,t.jsx)("label",{className:d.default.label,children:"PO Number:"}),(0,t.jsx)("input",{type:"text",value:g.poNumber,onChange:e=>y(t=>({...t,poNumber:e.target.value})),className:d.default.input,placeholder:"Enter PO number (optional)"})]}),(0,t.jsxs)("div",{className:d.default.field,children:[(0,t.jsx)("label",{className:d.default.label,children:"Payment Type:"}),(0,t.jsxs)("select",{value:g.paymentType,onChange:e=>y(t=>({...t,paymentType:e.target.value})),className:d.default.select,required:!0,children:[(0,t.jsx)("option",{value:"cash",children:"Cash"}),(0,t.jsx)("option",{value:"credit",children:"Credit"}),(0,t.jsx)("option",{value:"other",children:"Other"})]})]})]}),(0,t.jsxs)("div",{className:d.default.field,children:[(0,t.jsx)("label",{className:d.default.label,children:"Supplier:"}),(0,t.jsxs)("div",{className:d.default.searchContainer,children:[(0,t.jsxs)("div",{className:d.default.inputWrapper,children:[(0,t.jsx)("input",{type:"text",value:x,onChange:e=>S(e.target.value),onBlur:()=>{setTimeout(()=>{I(!1)},200)},onFocus:()=>{R.length>0&&!v&&I(!0)},className:`${d.default.input} ${v?d.default.selectedInput:""}`,placeholder:"Search supplier by name, contact, or email...",required:!0}),v&&(0,t.jsx)("button",{type:"button",onClick:()=>{N(null),S(""),y(e=>({...e,supplierId:""})),I(!1),j([])},className:d.default.clearSupplierButton,title:"Clear selected supplier",children:"Ã—"})]}),b&&R.length>0&&(0,t.jsx)("div",{className:d.default.dropdown,children:R.map(e=>(0,t.jsx)("div",{className:d.default.dropdownItem,onClick:()=>{N(e),S(e.supplierName),y(t=>({...t,supplierId:e.id.toString()})),I(!1),j([]),setTimeout(()=>{let e=document.activeElement;e&&e.blur&&e.blur()},100)},children:(0,t.jsxs)("div",{className:d.default.supplierInfo,children:[(0,t.jsx)("strong",{children:e.supplierName}),(0,t.jsx)("span",{children:e.contactNumber}),(0,t.jsx)("small",{children:e.email})]})},e.id))})]})]})]}),(0,t.jsxs)("div",{className:d.default.section,children:[(0,t.jsx)("h2",{className:d.default.sectionTitle,children:"Add Products"}),(0,t.jsx)("div",{className:d.default.productSearch,children:(0,t.jsxs)("div",{className:d.default.row,children:[(0,t.jsxs)("div",{className:d.default.field,children:[(0,t.jsx)("label",{className:d.default.label,children:"Search Product:"}),(0,t.jsxs)("div",{className:d.default.searchContainer,children:[(0,t.jsx)("input",{type:"text",value:C,onChange:e=>q(e.target.value),className:d.default.input,placeholder:"Search product by code or name..."}),T&&w.length>0&&(0,t.jsx)("div",{className:d.default.dropdown,children:w.map(e=>(0,t.jsx)("div",{className:d.default.dropdownItem,onClick:()=>{O(t=>({...t,productId:e.id})),q(`${e.productCode} - ${e.itemName}`),F(!1),h("")},children:(0,t.jsxs)("div",{className:d.default.productInfo,children:[(0,t.jsx)("strong",{children:e.productCode}),(0,t.jsx)("span",{children:e.itemName}),(0,t.jsxs)("small",{children:["Category: ",e.category," | Available: ",e.availableQty]})]})},e.id))})]})]}),(0,t.jsxs)("div",{className:d.default.field,children:[(0,t.jsx)("label",{className:d.default.label,children:"Quantity:"}),(0,t.jsx)("input",{type:"number",value:G.quantity,onChange:e=>O(t=>({...t,quantity:parseInt(e.target.value)||1})),onWheel:n.handleNumberInputWheel,className:d.default.input,min:"1",required:!0})]}),(0,t.jsxs)("div",{className:d.default.field,children:[(0,t.jsx)("label",{className:d.default.label,children:"Cost Price:"}),(0,t.jsx)("input",{type:"number",step:"0.01",value:G.costPrice,onChange:e=>O(t=>({...t,costPrice:parseFloat(e.target.value)||0})),onWheel:n.handleNumberInputWheel,className:d.default.input,min:"0",required:!0})]}),(0,t.jsx)("div",{className:d.default.field,children:(0,t.jsx)("button",{type:"button",onClick:()=>{if(h(""),p(""),!G.productId||0===G.productId)return void h("Please select a product from the dropdown");if(!G.quantity||G.quantity<=0)return void h("Please enter a valid quantity (greater than 0)");if(!G.costPrice||G.costPrice<=0)return void h("Please enter a valid cost price (greater than 0)");let e=w.find(e=>e.id===G.productId)||(C?{id:G.productId,productCode:C.split(" - ")[0],itemName:C.split(" - ")[1]||C,category:"",sellingPrice:0,availableQty:0}:null);e?X(e):h("Selected product not found. Please search and select again.")},className:d.default.addButton,disabled:!G.productId||G.quantity<=0||G.costPrice<=0,children:"Add Product"})})]})})]}),Z.length>0&&(0,t.jsxs)("div",{className:d.default.section,children:[(0,t.jsx)("h2",{className:d.default.sectionTitle,children:"GRN Items"}),(0,t.jsxs)("div",{className:d.default.itemsTable,children:[(0,t.jsxs)("div",{className:d.default.tableHeader,children:[(0,t.jsx)("div",{children:"Product Code"}),(0,t.jsx)("div",{children:"Product Name"}),(0,t.jsx)("div",{children:"Quantity"}),(0,t.jsx)("div",{children:"Cost Price"}),(0,t.jsx)("div",{children:"Total Cost"}),(0,t.jsx)("div",{children:"Actions"})]}),Z.map(e=>(0,t.jsxs)("div",{className:d.default.tableRow,children:[(0,t.jsx)("div",{children:e.productCode}),(0,t.jsx)("div",{children:e.itemName}),(0,t.jsx)("div",{children:(0,t.jsx)("input",{type:"number",value:e.quantity,onChange:H?void 0:t=>et(e.productId,"quantity",parseInt(t.target.value)||1),onWheel:n.handleNumberInputWheel,className:`${d.default.smallInput} ${H?d.default.readOnlyInput:""}`,min:"1",readOnly:H,disabled:H})}),(0,t.jsx)("div",{children:(0,t.jsx)("input",{type:"number",step:"0.01",value:e.costPrice,onChange:H?void 0:t=>et(e.productId,"costPrice",parseFloat(t.target.value)||0),onWheel:n.handleNumberInputWheel,className:`${d.default.smallInput} ${H?d.default.readOnlyInput:""}`,min:"0",readOnly:H,disabled:H})}),(0,t.jsxs)("div",{className:d.default.totalCost,children:["Rs. ",e.totalCost.toFixed(2)]}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{type:"button",onClick:()=>ee(e.productId),className:d.default.removeButton,disabled:M===e.productId||f,children:M===e.productId?"Removing...":"Remove"})})]},e.productId)),(0,t.jsx)("div",{className:d.default.tableFooter,children:(0,t.jsx)("div",{className:d.default.totalAmount,children:(0,t.jsxs)("strong",{children:["Total Amount: Rs. ",Z.reduce((e,t)=>e+t.totalCost,0).toFixed(2)]})})})]})]}),(0,t.jsx)("div",{className:d.default.submitSection,children:(0,t.jsx)("button",{type:"submit",className:d.default.submitButton,disabled:f||!v||0===Z.length,children:f?H?"Updating GRN...":"Creating GRN...":H?"Update GRN":"Create GRN"})}),c&&(0,t.jsx)("p",{className:d.default.success,children:c}),m&&(0,t.jsx)("p",{className:d.default.error,children:m})]}),(0,t.jsxs)("div",{className:d.default.grnsList,children:[(0,t.jsxs)("div",{className:d.default.grnsHeader,children:[(0,t.jsx)("h2",{className:d.default.subtitle,children:"Existing GRNs"}),(0,t.jsx)("button",{onClick:()=>es(1),className:d.default.loadButton,disabled:f,children:f?"Loading...":"Load GRNs"})]}),z&&(0,t.jsxs)("div",{className:d.default.grnsContent,children:[0===B.length?(0,t.jsx)("p",{className:d.default.noGrns,children:"No GRNs found."}):(0,t.jsx)("div",{className:d.default.grnItems,children:B.map(e=>(0,t.jsxs)("div",{className:d.default.grnItem,children:[(0,t.jsxs)("div",{className:d.default.grnHeader,children:[(0,t.jsxs)("div",{className:d.default.grnInfo,children:[(0,t.jsxs)("strong",{children:["GRN #",e.id]}),(0,t.jsxs)("span",{children:["Date: ",new Date(e.grnDate).toLocaleDateString()]}),(0,t.jsxs)("span",{children:["Invoice: ",e.invoiceNumber]})]}),(0,t.jsxs)("div",{className:d.default.grnActions,children:[(0,t.jsxs)("div",{className:d.default.grnAmount,children:["Rs. ",parseFloat(e.totalAmount.toString()).toFixed(2)]}),(0,t.jsx)("button",{type:"button",onClick:()=>(e=>{try{h(""),p(""),U(!0),Q(e.id),y({grnDate:e.grnDate.split("T")[0],supplierId:e.supplier.id.toString(),invoiceNumber:e.invoiceNumber,poNumber:e.poNumber||"",paymentType:e.paymentType}),N({id:e.supplier.id,supplierName:e.supplier.supplierName,contactNumber:e.supplier.contactNumber,email:e.supplier.email||"",address:e.supplier.address||""}),S(e.supplier.supplierName);let t=e.grnItems.map(e=>({productId:e.product.id,productCode:e.product.productCode,itemName:e.product.itemName,quantity:e.quantity,costPrice:e.costPrice,totalCost:e.quantity*e.costPrice}));A(t),p(`GRN #${e.id} loaded for editing. You can now modify and update.`),window.scrollTo({top:0,behavior:"smooth"})}catch(e){h("Failed to load GRN for editing")}})(e),className:d.default.editButton,disabled:f,children:"Edit"})]})]}),(0,t.jsxs)("div",{className:d.default.grnDetails,children:[(0,t.jsxs)("div",{children:["Supplier: ",e.supplier.supplierName]}),(0,t.jsxs)("div",{children:["Payment: ",e.paymentType.toUpperCase()]}),(0,t.jsxs)("div",{children:["Items: ",e.grnItems.length]}),(0,t.jsxs)("div",{children:["User: ",e.user]})]})]},e.id))}),W.totalPages>1&&(0,t.jsxs)("div",{className:d.default.pagination,children:[(0,t.jsx)("button",{onClick:()=>es(D-1),disabled:!W.hasPrev||f,className:d.default.pageBtn,children:"Previous"}),(0,t.jsx)("div",{className:d.default.pageNumbers,children:Array.from({length:Math.min(5,W.totalPages)},(e,s)=>{let a=Math.max(1,D-2)+s;return a<=W.totalPages?(0,t.jsx)("button",{onClick:()=>es(a),disabled:f,className:`${d.default.pageBtn} ${a===D?d.default.active:""}`,children:a},a):null})}),(0,t.jsx)("button",{onClick:()=>es(D+1),disabled:!W.hasNext||f,className:d.default.pageBtn,children:"Next"})]}),(0,t.jsx)("div",{className:d.default.paginationInfo,children:(0,t.jsxs)("p",{children:["Showing page ",W.currentPage," of ",W.totalPages,"(",W.totalCount," total GRNs)"]})})]})]})]}):(0,t.jsx)("div",{className:d.default.container,children:(0,t.jsx)("p",{className:d.default.error,children:"Please log in to access GRN management."})})}e.s(["default",()=>l])}]);