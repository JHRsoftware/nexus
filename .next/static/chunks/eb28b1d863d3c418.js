(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67994,e=>{e.v({actionButton:"orders-module__HlIdNG__actionButton",actions:"orders-module__HlIdNG__actions",cardActions:"orders-module__HlIdNG__cardActions",cardContent:"orders-module__HlIdNG__cardContent",cardHeader:"orders-module__HlIdNG__cardHeader",cardLabel:"orders-module__HlIdNG__cardLabel",cardOrderNumber:"orders-module__HlIdNG__cardOrderNumber",cardRow:"orders-module__HlIdNG__cardRow",cardValue:"orders-module__HlIdNG__cardValue",container:"orders-module__HlIdNG__container",createButton:"orders-module__HlIdNG__createButton",dark:"orders-module__HlIdNG__dark",dateCell:"orders-module__HlIdNG__dateCell",deleteButton:"orders-module__HlIdNG__deleteButton",editButton:"orders-module__HlIdNG__editButton",error:"orders-module__HlIdNG__error",filterSelect:"orders-module__HlIdNG__filterSelect",filters:"orders-module__HlIdNG__filters",filtersSection:"orders-module__HlIdNG__filtersSection",header:"orders-module__HlIdNG__header",itemsCell:"orders-module__HlIdNG__itemsCell",light:"orders-module__HlIdNG__light",loadButton:"orders-module__HlIdNG__loadButton",loadSection:"orders-module__HlIdNG__loadSection",loading:"orders-module__HlIdNG__loading",mobileCards:"orders-module__HlIdNG__mobileCards",noOrders:"orders-module__HlIdNG__noOrders",orderCard:"orders-module__HlIdNG__orderCard",orderDate:"orders-module__HlIdNG__orderDate",orderNumber:"orders-module__HlIdNG__orderNumber",orderNumberContainer:"orders-module__HlIdNG__orderNumberContainer",orderNumberText:"orders-module__HlIdNG__orderNumberText",orderRow:"orders-module__HlIdNG__orderRow",ordersTable:"orders-module__HlIdNG__ordersTable",ownerName:"orders-module__HlIdNG__ownerName",pageButton:"orders-module__HlIdNG__pageButton",pageInfo:"orders-module__HlIdNG__pageInfo",pagination:"orders-module__HlIdNG__pagination",retryButton:"orders-module__HlIdNG__retryButton",salesRepCell:"orders-module__HlIdNG__salesRepCell",searchContainer:"orders-module__HlIdNG__searchContainer",searchInput:"orders-module__HlIdNG__searchInput",shopInfo:"orders-module__HlIdNG__shopInfo",shopName:"orders-module__HlIdNG__shopName",sortInfo:"orders-module__HlIdNG__sortInfo",sortNote:"orders-module__HlIdNG__sortNote",spin:"orders-module__HlIdNG__spin",spinner:"orders-module__HlIdNG__spinner",statusBadge:"orders-module__HlIdNG__statusBadge",summary:"orders-module__HlIdNG__summary",summaryItem:"orders-module__HlIdNG__summaryItem",summaryLabel:"orders-module__HlIdNG__summaryLabel",summaryValue:"orders-module__HlIdNG__summaryValue",tableContainer:"orders-module__HlIdNG__tableContainer",title:"orders-module__HlIdNG__title",totalCell:"orders-module__HlIdNG__totalCell"})},23003,e=>{"use strict";var a=e.i(43476),s=e.i(71645),r=e.i(18566),l=e.i(75144),t=e.i(67994);function d(){let e=(0,r.useRouter)(),{isDarkMode:d}=(0,l.useTheme)(),[o,n]=(0,s.useState)([]),[i,c]=(0,s.useState)([]),[u,m]=(0,s.useState)(!1),[_,h]=(0,s.useState)(null),[N,f]=(0,s.useState)(!1),[p,x]=(0,s.useState)(""),[j,g]=(0,s.useState)("all"),[I,C]=(0,s.useState)("all"),[b,w]=(0,s.useState)("newest"),[H,v]=(0,s.useState)(1),[G]=(0,s.useState)(10),[y,T]=(0,s.useState)(0);(0,s.useEffect)(()=>{S()},[o,p,j,I,b]),(0,s.useEffect)(()=>{T(Math.ceil(i.length/G))},[i,G]);let D=async()=>{try{m(!0),h(null);let e=await fetch("/api/orders");if(!e.ok)throw Error("Failed to fetch orders");let a=await e.json();a.success&&Array.isArray(a.orders)?n(a.orders):n([]),f(!0)}catch(e){h("Failed to load orders. Please try again."),n([]),f(!1)}finally{m(!1)}},S=()=>{if(!Array.isArray(o))return;let e=[...o];if(p){let a=p.toLowerCase();e=e.filter(e=>e.orderNumber.toLowerCase().includes(a)||e.shop.shopName.toLowerCase().includes(a)||e.shop.ownerName.toLowerCase().includes(a)||e.notes?.toLowerCase().includes(a)||e.salesRep?.name.toLowerCase().includes(a))}if("all"!==j&&(e=e.filter(e=>e.status.toLowerCase()===j.toLowerCase())),"all"!==I){let a=new Date,s=new Date(a);switch(I){case"today":s.setHours(0,0,0,0),e=e.filter(e=>new Date(e.orderDate)>=s);break;case"week":s.setDate(a.getDate()-7),e=e.filter(e=>new Date(e.orderDate)>=s);break;case"month":s.setMonth(a.getMonth()-1),e=e.filter(e=>new Date(e.orderDate)>=s)}}e.sort((e,a)=>{let s="pending"===e.status.toLowerCase(),r="pending"===a.status.toLowerCase();if(s&&!r)return -1;if(!s&&r)return 1;switch(b){case"newest":default:return new Date(a.orderDate).getTime()-new Date(e.orderDate).getTime();case"oldest":return new Date(e.orderDate).getTime()-new Date(a.orderDate).getTime();case"amount":return a.netTotal-e.netTotal;case"shop":return e.shop.shopName.localeCompare(a.shop.shopName)}}),c(e),v(1)},L=async e=>{let a=o.find(a=>a.id===e);if(!a)return void alert("Order not found");if(confirm(`Are you sure you want to delete order ${a.orderNumber}?

Shop: ${a.shop.shopName}
Total: Rs. ${Number(a.netTotal).toFixed(2)}

This action cannot be undone.`))try{let s=await fetch(`/api/orders/${e}`,{method:"DELETE"}),r=await s.json();s.ok&&r.success?(alert(`Order ${a.orderNumber} has been successfully deleted.`),await D()):alert(r.error||`Failed to delete order. Status: ${s.status} - ${s.statusText}`)}catch(e){alert("An error occurred while deleting the order. Please check your connection and try again.")}},B=()=>{let e=(H-1)*G;return i.slice(e,e+G)},R=e=>{switch(e.toLowerCase()){case"pending":return"#ffc107";case"completed":return"#28a745";default:return"#6c757d"}};return u?(0,a.jsx)("div",{className:`${t.default.container} ${d?"dark":"light"}`,children:(0,a.jsxs)("div",{className:t.default.loading,children:[(0,a.jsx)("div",{className:t.default.spinner}),(0,a.jsx)("p",{children:"Loading orders..."})]})}):_?(0,a.jsx)("div",{className:`${t.default.container} ${d?"dark":"light"}`,children:(0,a.jsxs)("div",{className:t.default.error,children:[(0,a.jsx)("p",{children:_}),(0,a.jsx)("button",{onClick:D,className:t.default.retryButton,children:"Try Again"})]})}):(0,a.jsxs)("div",{className:`${t.default.container} ${d?"dark":"light"}`,children:[(0,a.jsxs)("div",{className:t.default.header,children:[(0,a.jsx)("h1",{className:t.default.title,children:"Order Management"}),(0,a.jsx)("button",{onClick:()=>e.push("/orders/create"),className:t.default.createButton,children:"+ Create New Order"})]}),!N&&(0,a.jsx)("div",{className:t.default.loadSection,children:(0,a.jsx)("button",{onClick:D,className:t.default.loadButton,disabled:u,children:u?"Loading Orders...":"Load Orders"})}),N&&(0,a.jsxs)("div",{className:t.default.filtersSection,children:[(0,a.jsx)("div",{className:t.default.searchContainer,children:(0,a.jsx)("input",{type:"text",placeholder:"Search orders by number, shop, owner, or notes...",value:p,onChange:e=>x(e.target.value),className:t.default.searchInput})}),(0,a.jsxs)("div",{className:t.default.filters,children:[(0,a.jsxs)("select",{value:j,onChange:e=>g(e.target.value),className:t.default.filterSelect,children:[(0,a.jsx)("option",{value:"all",children:"All Statuses"}),(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"completed",children:"Completed"})]}),(0,a.jsxs)("select",{value:I,onChange:e=>C(e.target.value),className:t.default.filterSelect,children:[(0,a.jsx)("option",{value:"all",children:"All Time"}),(0,a.jsx)("option",{value:"today",children:"Today"}),(0,a.jsx)("option",{value:"week",children:"Last 7 Days"}),(0,a.jsx)("option",{value:"month",children:"Last Month"})]}),(0,a.jsxs)("select",{value:b,onChange:e=>w(e.target.value),className:t.default.filterSelect,children:[(0,a.jsx)("option",{value:"newest",children:"Pending First, Then Newest"}),(0,a.jsx)("option",{value:"oldest",children:"Pending First, Then Oldest"}),(0,a.jsx)("option",{value:"amount",children:"Pending First, Then Highest Amount"}),(0,a.jsx)("option",{value:"shop",children:"Pending First, Then Shop Name"})]})]})]}),N&&(0,a.jsxs)("div",{className:t.default.summary,children:[(0,a.jsxs)("div",{className:t.default.summaryItem,children:[(0,a.jsx)("span",{className:t.default.summaryLabel,children:"Total Pending Orders"}),(0,a.jsx)("span",{className:t.default.summaryValue,children:o.filter(e=>"pending"===e.status.toLowerCase()).length})]}),(0,a.jsxs)("div",{className:t.default.summaryItem,children:[(0,a.jsx)("span",{className:t.default.summaryLabel,children:"Total Pending Orders Value"}),(0,a.jsxs)("span",{className:t.default.summaryValue,children:["Rs. ",o.filter(e=>"pending"===e.status.toLowerCase()).reduce((e,a)=>e+Number(a.netTotal),0).toFixed(2)]})]})]}),N&&(0,a.jsx)(a.Fragment,{children:0===i.length?(0,a.jsxs)("div",{className:t.default.noOrders,children:[(0,a.jsx)("p",{children:"No orders found"}),p||"all"!==j||"all"!==I?(0,a.jsx)("p",{children:"Try adjusting your search criteria or filters"}):(0,a.jsx)("p",{children:"Create your first order to get started"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:t.default.tableContainer,children:(0,a.jsxs)("table",{className:t.default.ordersTable,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Order #"}),(0,a.jsx)("th",{children:"Date"}),(0,a.jsx)("th",{children:"Shop"}),(0,a.jsx)("th",{children:"Sales Rep"}),(0,a.jsx)("th",{children:"Items"}),(0,a.jsx)("th",{children:"Status"}),(0,a.jsx)("th",{children:"Total"}),(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsx)("tbody",{children:B().map(s=>(0,a.jsxs)("tr",{className:t.default.orderRow,children:[(0,a.jsx)("td",{className:t.default.orderNumber,children:(0,a.jsxs)("div",{className:t.default.orderNumberContainer,children:[(0,a.jsx)("span",{className:t.default.orderNumberText,children:s.orderNumber}),(0,a.jsx)("span",{className:t.default.orderDate,children:new Date(s.orderDate).toLocaleDateString()})]})}),(0,a.jsx)("td",{className:t.default.dateCell,children:new Date(s.orderDate).toLocaleDateString()}),(0,a.jsx)("td",{className:t.default.shopCell,children:(0,a.jsxs)("div",{className:t.default.shopInfo,children:[(0,a.jsx)("span",{className:t.default.shopName,children:s.shop.shopName}),(0,a.jsx)("span",{className:t.default.ownerName,children:s.shop.ownerName})]})}),(0,a.jsx)("td",{className:t.default.salesRepCell,children:s.salesRep?s.salesRep.name:"N/A"}),(0,a.jsxs)("td",{className:t.default.itemsCell,children:[s.orderItems.length," item",1!==s.orderItems.length?"s":""]}),(0,a.jsx)("td",{className:t.default.statusCell,children:(0,a.jsx)("span",{className:t.default.statusBadge,style:{backgroundColor:R(s.status)},children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),(0,a.jsxs)("td",{className:t.default.totalCell,children:["Rs. ",Number(s.netTotal).toFixed(2)]}),(0,a.jsx)("td",{className:t.default.actionsCell,children:(0,a.jsxs)("div",{className:t.default.actions,children:["pending"===s.status.toLowerCase()&&(0,a.jsx)("button",{onClick:()=>e.push(`/orders/create?editId=${s.id}`),className:t.default.actionButton,title:"Edit Order",children:"âœï¸"}),(0,a.jsx)("button",{onClick:()=>L(s.id),className:`${t.default.actionButton} ${t.default.deleteButton}`,title:"Delete Order",children:"ðŸ—‘ï¸"})]})})]},s.id))})]})}),(0,a.jsx)("div",{className:t.default.mobileCards,children:B().map(s=>(0,a.jsxs)("div",{className:t.default.orderCard,children:[(0,a.jsxs)("div",{className:t.default.cardHeader,children:[(0,a.jsx)("div",{className:t.default.cardOrderNumber,children:(0,a.jsx)("span",{className:t.default.orderNumberText,children:s.orderNumber})}),(0,a.jsx)("span",{className:t.default.statusBadge,style:{backgroundColor:R(s.status)},children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})]}),(0,a.jsxs)("div",{className:t.default.cardContent,children:[(0,a.jsxs)("div",{className:t.default.cardRow,children:[(0,a.jsx)("span",{className:t.default.cardLabel,children:"Date:"}),(0,a.jsx)("span",{className:t.default.cardValue,children:new Date(s.orderDate).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:t.default.cardRow,children:[(0,a.jsx)("span",{className:t.default.cardLabel,children:"Shop:"}),(0,a.jsx)("span",{className:t.default.cardValue,children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:t.default.shopName,children:s.shop.shopName}),(0,a.jsx)("div",{className:t.default.ownerName,children:s.shop.ownerName})]})})]}),(0,a.jsxs)("div",{className:t.default.cardRow,children:[(0,a.jsx)("span",{className:t.default.cardLabel,children:"Sales Rep:"}),(0,a.jsx)("span",{className:t.default.cardValue,children:s.salesRep?s.salesRep.name:"N/A"})]}),(0,a.jsxs)("div",{className:t.default.cardRow,children:[(0,a.jsx)("span",{className:t.default.cardLabel,children:"Items:"}),(0,a.jsxs)("span",{className:t.default.cardValue,children:[s.orderItems.length," item",1!==s.orderItems.length?"s":""]})]}),(0,a.jsxs)("div",{className:t.default.cardRow,children:[(0,a.jsx)("span",{className:t.default.cardLabel,children:"Total:"}),(0,a.jsxs)("span",{className:t.default.cardValue,children:["Rs. ",Number(s.netTotal).toFixed(2)]})]})]}),(0,a.jsxs)("div",{className:t.default.cardActions,children:["pending"===s.status.toLowerCase()&&(0,a.jsx)("button",{onClick:()=>e.push(`/orders/create?editId=${s.id}`),className:`${t.default.actionButton} ${t.default.editButton}`,title:"Edit Order",children:"âœï¸ Edit"}),(0,a.jsx)("button",{onClick:()=>L(s.id),className:`${t.default.actionButton} ${t.default.deleteButton}`,title:"Delete Order",children:"ðŸ—‘ï¸ Delete"})]})]},`mobile-${s.id}`))}),y>1&&(0,a.jsxs)("div",{className:t.default.pagination,children:[(0,a.jsx)("button",{onClick:()=>v(e=>Math.max(e-1,1)),disabled:1===H,className:t.default.pageButton,children:"â† Previous"}),(0,a.jsxs)("span",{className:t.default.pageInfo,children:["Page ",H," of ",y," (",i.length," orders)"]}),(0,a.jsx)("button",{onClick:()=>v(e=>Math.min(e+1,y)),disabled:H===y,className:t.default.pageButton,children:"Next â†’"})]})]})})]})}e.s(["default",()=>d])}]);