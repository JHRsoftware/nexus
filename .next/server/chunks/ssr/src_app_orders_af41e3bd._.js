module.exports=[23364,a=>{a.v({actionButton:"orders-module__HlIdNG__actionButton",actions:"orders-module__HlIdNG__actions",cardActions:"orders-module__HlIdNG__cardActions",cardContent:"orders-module__HlIdNG__cardContent",cardHeader:"orders-module__HlIdNG__cardHeader",cardLabel:"orders-module__HlIdNG__cardLabel",cardOrderNumber:"orders-module__HlIdNG__cardOrderNumber",cardRow:"orders-module__HlIdNG__cardRow",cardValue:"orders-module__HlIdNG__cardValue",container:"orders-module__HlIdNG__container",createButton:"orders-module__HlIdNG__createButton",dark:"orders-module__HlIdNG__dark",dateCell:"orders-module__HlIdNG__dateCell",deleteButton:"orders-module__HlIdNG__deleteButton",editButton:"orders-module__HlIdNG__editButton",error:"orders-module__HlIdNG__error",filterSelect:"orders-module__HlIdNG__filterSelect",filters:"orders-module__HlIdNG__filters",filtersSection:"orders-module__HlIdNG__filtersSection",header:"orders-module__HlIdNG__header",itemsCell:"orders-module__HlIdNG__itemsCell",light:"orders-module__HlIdNG__light",loadButton:"orders-module__HlIdNG__loadButton",loadSection:"orders-module__HlIdNG__loadSection",loading:"orders-module__HlIdNG__loading",mobileCards:"orders-module__HlIdNG__mobileCards",noOrders:"orders-module__HlIdNG__noOrders",orderCard:"orders-module__HlIdNG__orderCard",orderDate:"orders-module__HlIdNG__orderDate",orderNumber:"orders-module__HlIdNG__orderNumber",orderNumberContainer:"orders-module__HlIdNG__orderNumberContainer",orderNumberText:"orders-module__HlIdNG__orderNumberText",orderRow:"orders-module__HlIdNG__orderRow",ordersTable:"orders-module__HlIdNG__ordersTable",ownerName:"orders-module__HlIdNG__ownerName",pageButton:"orders-module__HlIdNG__pageButton",pageInfo:"orders-module__HlIdNG__pageInfo",pagination:"orders-module__HlIdNG__pagination",retryButton:"orders-module__HlIdNG__retryButton",salesRepCell:"orders-module__HlIdNG__salesRepCell",searchContainer:"orders-module__HlIdNG__searchContainer",searchInput:"orders-module__HlIdNG__searchInput",shopInfo:"orders-module__HlIdNG__shopInfo",shopName:"orders-module__HlIdNG__shopName",sortInfo:"orders-module__HlIdNG__sortInfo",sortNote:"orders-module__HlIdNG__sortNote",spin:"orders-module__HlIdNG__spin",spinner:"orders-module__HlIdNG__spinner",statusBadge:"orders-module__HlIdNG__statusBadge",summary:"orders-module__HlIdNG__summary",summaryItem:"orders-module__HlIdNG__summaryItem",summaryLabel:"orders-module__HlIdNG__summaryLabel",summaryValue:"orders-module__HlIdNG__summaryValue",tableContainer:"orders-module__HlIdNG__tableContainer",title:"orders-module__HlIdNG__title",totalCell:"orders-module__HlIdNG__totalCell"})},76356,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(9453),f=a.i(23364);function g(){let a=(0,d.useRouter)(),{isDarkMode:g}=(0,e.useTheme)(),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)("all"),[v,w]=(0,c.useState)("all"),[x,y]=(0,c.useState)("newest"),[z,A]=(0,c.useState)(1),[B]=(0,c.useState)(10),[C,D]=(0,c.useState)(0);(0,c.useEffect)(()=>{F()},[h,r,t,v,x]),(0,c.useEffect)(()=>{D(Math.ceil(j.length/B))},[j,B]);let E=async()=>{try{m(!0),o(null);let a=await fetch("/api/orders");if(!a.ok)throw Error("Failed to fetch orders");let b=await a.json();b.success&&Array.isArray(b.orders)?i(b.orders):i([]),q(!0)}catch(a){o("Failed to load orders. Please try again."),i([]),q(!1)}finally{m(!1)}},F=()=>{if(!Array.isArray(h))return;let a=[...h];if(r){let b=r.toLowerCase();a=a.filter(a=>a.orderNumber.toLowerCase().includes(b)||a.shop.shopName.toLowerCase().includes(b)||a.shop.ownerName.toLowerCase().includes(b)||a.notes?.toLowerCase().includes(b)||a.salesRep?.name.toLowerCase().includes(b))}if("all"!==t&&(a=a.filter(a=>a.status.toLowerCase()===t.toLowerCase())),"all"!==v){let b=new Date,c=new Date(b);switch(v){case"today":c.setHours(0,0,0,0),a=a.filter(a=>new Date(a.orderDate)>=c);break;case"week":c.setDate(b.getDate()-7),a=a.filter(a=>new Date(a.orderDate)>=c);break;case"month":c.setMonth(b.getMonth()-1),a=a.filter(a=>new Date(a.orderDate)>=c)}}a.sort((a,b)=>{let c="pending"===a.status.toLowerCase(),d="pending"===b.status.toLowerCase();if(c&&!d)return -1;if(!c&&d)return 1;switch(x){case"newest":default:return new Date(b.orderDate).getTime()-new Date(a.orderDate).getTime();case"oldest":return new Date(a.orderDate).getTime()-new Date(b.orderDate).getTime();case"amount":return b.netTotal-a.netTotal;case"shop":return a.shop.shopName.localeCompare(b.shop.shopName)}}),k(a),A(1)},G=async a=>{let b=h.find(b=>b.id===a);if(!b)return void alert("Order not found");if(confirm(`Are you sure you want to delete order ${b.orderNumber}?

Shop: ${b.shop.shopName}
Total: Rs. ${Number(b.netTotal).toFixed(2)}

This action cannot be undone.`))try{let c=await fetch(`/api/orders/${a}`,{method:"DELETE"}),d=await c.json();c.ok&&d.success?(alert(`Order ${b.orderNumber} has been successfully deleted.`),await E()):alert(d.error||`Failed to delete order. Status: ${c.status} - ${c.statusText}`)}catch(a){alert("An error occurred while deleting the order. Please check your connection and try again.")}},H=()=>{let a=(z-1)*B;return j.slice(a,a+B)},I=a=>{switch(a.toLowerCase()){case"pending":return"#ffc107";case"completed":return"#28a745";default:return"#6c757d"}};return l?(0,b.jsx)("div",{className:`${f.default.container} ${g?"dark":"light"}`,children:(0,b.jsxs)("div",{className:f.default.loading,children:[(0,b.jsx)("div",{className:f.default.spinner}),(0,b.jsx)("p",{children:"Loading orders..."})]})}):n?(0,b.jsx)("div",{className:`${f.default.container} ${g?"dark":"light"}`,children:(0,b.jsxs)("div",{className:f.default.error,children:[(0,b.jsx)("p",{children:n}),(0,b.jsx)("button",{onClick:E,className:f.default.retryButton,children:"Try Again"})]})}):(0,b.jsxs)("div",{className:`${f.default.container} ${g?"dark":"light"}`,children:[(0,b.jsxs)("div",{className:f.default.header,children:[(0,b.jsx)("h1",{className:f.default.title,children:"Order Management"}),(0,b.jsx)("button",{onClick:()=>a.push("/orders/create"),className:f.default.createButton,children:"+ Create New Order"})]}),!p&&(0,b.jsx)("div",{className:f.default.loadSection,children:(0,b.jsx)("button",{onClick:E,className:f.default.loadButton,disabled:l,children:l?"Loading Orders...":"Load Orders"})}),p&&(0,b.jsxs)("div",{className:f.default.filtersSection,children:[(0,b.jsx)("div",{className:f.default.searchContainer,children:(0,b.jsx)("input",{type:"text",placeholder:"Search orders by number, shop, owner, or notes...",value:r,onChange:a=>s(a.target.value),className:f.default.searchInput})}),(0,b.jsxs)("div",{className:f.default.filters,children:[(0,b.jsxs)("select",{value:t,onChange:a=>u(a.target.value),className:f.default.filterSelect,children:[(0,b.jsx)("option",{value:"all",children:"All Statuses"}),(0,b.jsx)("option",{value:"pending",children:"Pending"}),(0,b.jsx)("option",{value:"completed",children:"Completed"})]}),(0,b.jsxs)("select",{value:v,onChange:a=>w(a.target.value),className:f.default.filterSelect,children:[(0,b.jsx)("option",{value:"all",children:"All Time"}),(0,b.jsx)("option",{value:"today",children:"Today"}),(0,b.jsx)("option",{value:"week",children:"Last 7 Days"}),(0,b.jsx)("option",{value:"month",children:"Last Month"})]}),(0,b.jsxs)("select",{value:x,onChange:a=>y(a.target.value),className:f.default.filterSelect,children:[(0,b.jsx)("option",{value:"newest",children:"Pending First, Then Newest"}),(0,b.jsx)("option",{value:"oldest",children:"Pending First, Then Oldest"}),(0,b.jsx)("option",{value:"amount",children:"Pending First, Then Highest Amount"}),(0,b.jsx)("option",{value:"shop",children:"Pending First, Then Shop Name"})]})]})]}),p&&(0,b.jsxs)("div",{className:f.default.summary,children:[(0,b.jsxs)("div",{className:f.default.summaryItem,children:[(0,b.jsx)("span",{className:f.default.summaryLabel,children:"Total Pending Orders"}),(0,b.jsx)("span",{className:f.default.summaryValue,children:h.filter(a=>"pending"===a.status.toLowerCase()).length})]}),(0,b.jsxs)("div",{className:f.default.summaryItem,children:[(0,b.jsx)("span",{className:f.default.summaryLabel,children:"Total Pending Orders Value"}),(0,b.jsxs)("span",{className:f.default.summaryValue,children:["Rs. ",h.filter(a=>"pending"===a.status.toLowerCase()).reduce((a,b)=>a+Number(b.netTotal),0).toFixed(2)]})]})]}),p&&(0,b.jsx)(b.Fragment,{children:0===j.length?(0,b.jsxs)("div",{className:f.default.noOrders,children:[(0,b.jsx)("p",{children:"No orders found"}),r||"all"!==t||"all"!==v?(0,b.jsx)("p",{children:"Try adjusting your search criteria or filters"}):(0,b.jsx)("p",{children:"Create your first order to get started"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:f.default.tableContainer,children:(0,b.jsxs)("table",{className:f.default.ordersTable,children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Order #"}),(0,b.jsx)("th",{children:"Date"}),(0,b.jsx)("th",{children:"Shop"}),(0,b.jsx)("th",{children:"Sales Rep"}),(0,b.jsx)("th",{children:"Items"}),(0,b.jsx)("th",{children:"Status"}),(0,b.jsx)("th",{children:"Total"}),(0,b.jsx)("th",{children:"Actions"})]})}),(0,b.jsx)("tbody",{children:H().map(c=>(0,b.jsxs)("tr",{className:f.default.orderRow,children:[(0,b.jsx)("td",{className:f.default.orderNumber,children:(0,b.jsxs)("div",{className:f.default.orderNumberContainer,children:[(0,b.jsx)("span",{className:f.default.orderNumberText,children:c.orderNumber}),(0,b.jsx)("span",{className:f.default.orderDate,children:new Date(c.orderDate).toLocaleDateString()})]})}),(0,b.jsx)("td",{className:f.default.dateCell,children:new Date(c.orderDate).toLocaleDateString()}),(0,b.jsx)("td",{className:f.default.shopCell,children:(0,b.jsxs)("div",{className:f.default.shopInfo,children:[(0,b.jsx)("span",{className:f.default.shopName,children:c.shop.shopName}),(0,b.jsx)("span",{className:f.default.ownerName,children:c.shop.ownerName})]})}),(0,b.jsx)("td",{className:f.default.salesRepCell,children:c.salesRep?c.salesRep.name:"N/A"}),(0,b.jsxs)("td",{className:f.default.itemsCell,children:[c.orderItems.length," item",1!==c.orderItems.length?"s":""]}),(0,b.jsx)("td",{className:f.default.statusCell,children:(0,b.jsx)("span",{className:f.default.statusBadge,style:{backgroundColor:I(c.status)},children:c.status.charAt(0).toUpperCase()+c.status.slice(1)})}),(0,b.jsxs)("td",{className:f.default.totalCell,children:["Rs. ",Number(c.netTotal).toFixed(2)]}),(0,b.jsx)("td",{className:f.default.actionsCell,children:(0,b.jsxs)("div",{className:f.default.actions,children:["pending"===c.status.toLowerCase()&&(0,b.jsx)("button",{onClick:()=>a.push(`/orders/create?editId=${c.id}`),className:f.default.actionButton,title:"Edit Order",children:"âœï¸"}),(0,b.jsx)("button",{onClick:()=>G(c.id),className:`${f.default.actionButton} ${f.default.deleteButton}`,title:"Delete Order",children:"ðŸ—‘ï¸"})]})})]},c.id))})]})}),(0,b.jsx)("div",{className:f.default.mobileCards,children:H().map(c=>(0,b.jsxs)("div",{className:f.default.orderCard,children:[(0,b.jsxs)("div",{className:f.default.cardHeader,children:[(0,b.jsx)("div",{className:f.default.cardOrderNumber,children:(0,b.jsx)("span",{className:f.default.orderNumberText,children:c.orderNumber})}),(0,b.jsx)("span",{className:f.default.statusBadge,style:{backgroundColor:I(c.status)},children:c.status.charAt(0).toUpperCase()+c.status.slice(1)})]}),(0,b.jsxs)("div",{className:f.default.cardContent,children:[(0,b.jsxs)("div",{className:f.default.cardRow,children:[(0,b.jsx)("span",{className:f.default.cardLabel,children:"Date:"}),(0,b.jsx)("span",{className:f.default.cardValue,children:new Date(c.orderDate).toLocaleDateString()})]}),(0,b.jsxs)("div",{className:f.default.cardRow,children:[(0,b.jsx)("span",{className:f.default.cardLabel,children:"Shop:"}),(0,b.jsx)("span",{className:f.default.cardValue,children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:f.default.shopName,children:c.shop.shopName}),(0,b.jsx)("div",{className:f.default.ownerName,children:c.shop.ownerName})]})})]}),(0,b.jsxs)("div",{className:f.default.cardRow,children:[(0,b.jsx)("span",{className:f.default.cardLabel,children:"Sales Rep:"}),(0,b.jsx)("span",{className:f.default.cardValue,children:c.salesRep?c.salesRep.name:"N/A"})]}),(0,b.jsxs)("div",{className:f.default.cardRow,children:[(0,b.jsx)("span",{className:f.default.cardLabel,children:"Items:"}),(0,b.jsxs)("span",{className:f.default.cardValue,children:[c.orderItems.length," item",1!==c.orderItems.length?"s":""]})]}),(0,b.jsxs)("div",{className:f.default.cardRow,children:[(0,b.jsx)("span",{className:f.default.cardLabel,children:"Total:"}),(0,b.jsxs)("span",{className:f.default.cardValue,children:["Rs. ",Number(c.netTotal).toFixed(2)]})]})]}),(0,b.jsxs)("div",{className:f.default.cardActions,children:["pending"===c.status.toLowerCase()&&(0,b.jsx)("button",{onClick:()=>a.push(`/orders/create?editId=${c.id}`),className:`${f.default.actionButton} ${f.default.editButton}`,title:"Edit Order",children:"âœï¸ Edit"}),(0,b.jsx)("button",{onClick:()=>G(c.id),className:`${f.default.actionButton} ${f.default.deleteButton}`,title:"Delete Order",children:"ðŸ—‘ï¸ Delete"})]})]},`mobile-${c.id}`))}),C>1&&(0,b.jsxs)("div",{className:f.default.pagination,children:[(0,b.jsx)("button",{onClick:()=>A(a=>Math.max(a-1,1)),disabled:1===z,className:f.default.pageButton,children:"â† Previous"}),(0,b.jsxs)("span",{className:f.default.pageInfo,children:["Page ",z," of ",C," (",j.length," orders)"]}),(0,b.jsx)("button",{onClick:()=>A(a=>Math.min(a+1,C)),disabled:z===C,className:f.default.pageButton,children:"Next â†’"})]})]})})]})}a.s(["default",()=>g])}];

//# sourceMappingURL=src_app_orders_af41e3bd._.js.map