{"version":3,"sources":["turbopack:///[project]/src/app/invoices/create/invoice.module.css [app-ssr] (css module)","turbopack:///[project]/src/app/invoices/create/page.tsx"],"sourcesContent":["__turbopack_context__.v({\n  \"accessDenied\": \"invoice-module__niiNsW__accessDenied\",\n  \"actions\": \"invoice-module__niiNsW__actions\",\n  \"activePage\": \"invoice-module__niiNsW__activePage\",\n  \"availableCredit\": \"invoice-module__niiNsW__availableCredit\",\n  \"cashDiscountLabel\": \"invoice-module__niiNsW__cashDiscountLabel\",\n  \"checkbox\": \"invoice-module__niiNsW__checkbox\",\n  \"clearButton\": \"invoice-module__niiNsW__clearButton\",\n  \"clearSelection\": \"invoice-module__niiNsW__clearSelection\",\n  \"container\": \"invoice-module__niiNsW__container\",\n  \"creditExceeded\": \"invoice-module__niiNsW__creditExceeded\",\n  \"dark\": \"invoice-module__niiNsW__dark\",\n  \"detailLabel\": \"invoice-module__niiNsW__detailLabel\",\n  \"detailValue\": \"invoice-module__niiNsW__detailValue\",\n  \"discount\": \"invoice-module__niiNsW__discount\",\n  \"discountInput\": \"invoice-module__niiNsW__discountInput\",\n  \"dropdown\": \"invoice-module__niiNsW__dropdown\",\n  \"dropdownItem\": \"invoice-module__niiNsW__dropdownItem\",\n  \"dropdownOpen\": \"invoice-module__niiNsW__dropdownOpen\",\n  \"ellipsis\": \"invoice-module__niiNsW__ellipsis\",\n  \"error\": \"invoice-module__niiNsW__error\",\n  \"fadeIn\": \"invoice-module__niiNsW__fadeIn\",\n  \"field\": \"invoice-module__niiNsW__field\",\n  \"form\": \"invoice-module__niiNsW__form\",\n  \"header\": \"invoice-module__niiNsW__header\",\n  \"input\": \"invoice-module__niiNsW__input\",\n  \"invoiceNumber\": \"invoice-module__niiNsW__invoiceNumber\",\n  \"invoiceTypeNotesRow\": \"invoice-module__niiNsW__invoiceTypeNotesRow\",\n  \"invoicesControls\": \"invoice-module__niiNsW__invoicesControls\",\n  \"invoicesHeader\": \"invoice-module__niiNsW__invoicesHeader\",\n  \"invoicesList\": \"invoice-module__niiNsW__invoicesList\",\n  \"invoicesTable\": \"invoice-module__niiNsW__invoicesTable\",\n  \"itemRow\": \"invoice-module__niiNsW__itemRow\",\n  \"itemsBody\": \"invoice-module__niiNsW__itemsBody\",\n  \"itemsHeader\": \"invoice-module__niiNsW__itemsHeader\",\n  \"itemsSection\": \"invoice-module__niiNsW__itemsSection\",\n  \"itemsTable\": \"invoice-module__niiNsW__itemsTable\",\n  \"label\": \"invoice-module__niiNsW__label\",\n  \"labelRow\": \"invoice-module__niiNsW__labelRow\",\n  \"loadButton\": \"invoice-module__niiNsW__loadButton\",\n  \"loading\": \"invoice-module__niiNsW__loading\",\n  \"netTotal\": \"invoice-module__niiNsW__netTotal\",\n  \"noInvoices\": \"invoice-module__niiNsW__noInvoices\",\n  \"noOrdersMessage\": \"invoice-module__niiNsW__noOrdersMessage\",\n  \"notes\": \"invoice-module__niiNsW__notes\",\n  \"notesInput\": \"invoice-module__niiNsW__notesInput\",\n  \"orderDate\": \"invoice-module__niiNsW__orderDate\",\n  \"orderInfo\": \"invoice-module__niiNsW__orderInfo\",\n  \"orderNotes\": \"invoice-module__niiNsW__orderNotes\",\n  \"orderTotal\": \"invoice-module__niiNsW__orderTotal\",\n  \"overdueAmount\": \"invoice-module__niiNsW__overdueAmount\",\n  \"overdueDays\": \"invoice-module__niiNsW__overdueDays\",\n  \"overdueInvoice\": \"invoice-module__niiNsW__overdueInvoice\",\n  \"overduePaymentItem\": \"invoice-module__niiNsW__overduePaymentItem\",\n  \"overduePaymentsList\": \"invoice-module__niiNsW__overduePaymentsList\",\n  \"overdueTotal\": \"invoice-module__niiNsW__overdueTotal\",\n  \"overdueTotalSection\": \"invoice-module__niiNsW__overdueTotalSection\",\n  \"overdueWarningCard\": \"invoice-module__niiNsW__overdueWarningCard\",\n  \"overdueWarningMessage\": \"invoice-module__niiNsW__overdueWarningMessage\",\n  \"overdueWarningSection\": \"invoice-module__niiNsW__overdueWarningSection\",\n  \"overdueWarningTitle\": \"invoice-module__niiNsW__overdueWarningTitle\",\n  \"pageButton\": \"invoice-module__niiNsW__pageButton\",\n  \"pagination\": \"invoice-module__niiNsW__pagination\",\n  \"paginationButtons\": \"invoice-module__niiNsW__paginationButtons\",\n  \"paginationInfo\": \"invoice-module__niiNsW__paginationInfo\",\n  \"price\": \"invoice-module__niiNsW__price\",\n  \"priceInput\": \"invoice-module__niiNsW__priceInput\",\n  \"printButton\": \"invoice-module__niiNsW__printButton\",\n  \"printInvoiceButton\": \"invoice-module__niiNsW__printInvoiceButton\",\n  \"printLastInvoiceButton\": \"invoice-module__niiNsW__printLastInvoiceButton\",\n  \"productCode\": \"invoice-module__niiNsW__productCode\",\n  \"productDetails\": \"invoice-module__niiNsW__productDetails\",\n  \"productInfo\": \"invoice-module__niiNsW__productInfo\",\n  \"productName\": \"invoice-module__niiNsW__productName\",\n  \"productSearchRow\": \"invoice-module__niiNsW__productSearchRow\",\n  \"productSearchSection\": \"invoice-module__niiNsW__productSearchSection\",\n  \"productTitle\": \"invoice-module__niiNsW__productTitle\",\n  \"profitRow\": \"invoice-module__niiNsW__profitRow\",\n  \"pulse\": \"invoice-module__niiNsW__pulse\",\n  \"pulseWarning\": \"invoice-module__niiNsW__pulseWarning\",\n  \"quantity\": \"invoice-module__niiNsW__quantity\",\n  \"quantityError\": \"invoice-module__niiNsW__quantityError\",\n  \"quantityInput\": \"invoice-module__niiNsW__quantityInput\",\n  \"removeButton\": \"invoice-module__niiNsW__removeButton\",\n  \"repContact\": \"invoice-module__niiNsW__repContact\",\n  \"repName\": \"invoice-module__niiNsW__repName\",\n  \"row\": \"invoice-module__niiNsW__row\",\n  \"searchButton\": \"invoice-module__niiNsW__searchButton\",\n  \"searchContainer\": \"invoice-module__niiNsW__searchContainer\",\n  \"searchInput\": \"invoice-module__niiNsW__searchInput\",\n  \"sectionTitle\": \"invoice-module__niiNsW__sectionTitle\",\n  \"select\": \"invoice-module__niiNsW__select\",\n  \"sellingPrice\": \"invoice-module__niiNsW__sellingPrice\",\n  \"shopDetailItem\": \"invoice-module__niiNsW__shopDetailItem\",\n  \"shopDetailsCard\": \"invoice-module__niiNsW__shopDetailsCard\",\n  \"shopDetailsGrid\": \"invoice-module__niiNsW__shopDetailsGrid\",\n  \"shopDetailsSection\": \"invoice-module__niiNsW__shopDetailsSection\",\n  \"shopDetailsTitle\": \"invoice-module__niiNsW__shopDetailsTitle\",\n  \"shopInfo\": \"invoice-module__niiNsW__shopInfo\",\n  \"shopName\": \"invoice-module__niiNsW__shopName\",\n  \"shopOwner\": \"invoice-module__niiNsW__shopOwner\",\n  \"showOrdersButton\": \"invoice-module__niiNsW__showOrdersButton\",\n  \"slideIn\": \"invoice-module__niiNsW__slideIn\",\n  \"submitButton\": \"invoice-module__niiNsW__submitButton\",\n  \"submitSection\": \"invoice-module__niiNsW__submitSection\",\n  \"subtitle\": \"invoice-module__niiNsW__subtitle\",\n  \"success\": \"invoice-module__niiNsW__success\",\n  \"tableBody\": \"invoice-module__niiNsW__tableBody\",\n  \"tableHeader\": \"invoice-module__niiNsW__tableHeader\",\n  \"tableRow\": \"invoice-module__niiNsW__tableRow\",\n  \"textarea\": \"invoice-module__niiNsW__textarea\",\n  \"title\": \"invoice-module__niiNsW__title\",\n  \"totalPrice\": \"invoice-module__niiNsW__totalPrice\",\n  \"totalRow\": \"invoice-module__niiNsW__totalRow\",\n  \"totalsGrid\": \"invoice-module__niiNsW__totalsGrid\",\n  \"totalsSection\": \"invoice-module__niiNsW__totalsSection\",\n  \"viewButton\": \"invoice-module__niiNsW__viewButton\",\n  \"viewModeLabel\": \"invoice-module__niiNsW__viewModeLabel\",\n});\n","'use client';\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { usePageProtection } from '@/components/ProtectedRoute';\r\nimport { useTheme } from '@/contexts/ThemeContext';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { handleNumberInputWheel } from '@/lib/numberInputUtils';\r\nimport styles from './invoice.module.css';\r\n\r\ninterface Shop {\r\n  id: number;\r\n  shopName: string;\r\n  ownerName: string;\r\n  contactNumber: string;\r\n  creditLimit: number;\r\n  balanceAmount: number;\r\n}\r\n\r\ninterface Discount {\r\n  id: number;\r\n  discountName: string;\r\n  percentage: number;\r\n}\r\n\r\ninterface Product {\r\n  id: number;\r\n  productCode: string;\r\n  itemName: string;\r\n  sellingPrice: number;\r\n  availableQty: number;\r\n  category: string;\r\n  costPrice?: number;\r\n}\r\n\r\ninterface InvoiceItem {\r\n  id: string;\r\n  productId: number;\r\n  productCode: string;\r\n  productName: string;\r\n  quantity: number;\r\n  sellingPrice: number;\r\n  discount: number;\r\n  price: number;\r\n  totalPrice: number;\r\n  availableQty: number;\r\n  costPrice: number;\r\n}\r\n\r\ninterface OverduePayment {\r\n  id: number;\r\n  invoiceNumber: string;\r\n  dueDate: string;\r\n  remainingAmount: number;\r\n  daysPastDue: number;\r\n}\r\n\r\ninterface SalesRep {\r\n  id: number;\r\n  name: string;\r\n  contactNumber: string;\r\n  status: string;\r\n}\r\n\r\ninterface Invoice {\r\n  id: number;\r\n  invoiceNumber: string;\r\n  invoiceDate: string;\r\n  shop: Shop;\r\n  discount?: Discount;\r\n  subTotal: number;\r\n  totalDiscount: number;\r\n  cashDiscount: number;\r\n  cashDiscountEnabled: boolean;\r\n  netTotal: number;\r\n  notes?: string;\r\n  invoiceItems: any[];\r\n}\r\n\r\ninterface Order {\r\n  id: number;\r\n  orderNumber: string;\r\n  orderDate: string;\r\n  shop: Shop;\r\n  salesRep?: SalesRep;\r\n  discount?: Discount;\r\n  invoiceTypePercentage?: number;\r\n  subTotal: number;\r\n  totalDiscount: number;\r\n  cashDiscount: number;\r\n  cashDiscountEnabled: boolean;\r\n  netTotal: number;\r\n  status: string;\r\n  notes?: string;\r\n  orderItems: {\r\n    id: number;\r\n    productId: number;\r\n    quantity: number;\r\n    sellingPrice: number;\r\n    discount: number;\r\n    price: number;\r\n    totalPrice: number;\r\n    itemCost: number;\r\n    itemProfit: number;\r\n    product: Product & { category: { category: string } };\r\n  }[];\r\n}\r\n\r\nconst InvoiceManagement: React.FC = () => {\r\n  // Navigation\r\n  const router = useRouter();\r\n  \r\n  // Page protection\r\n  const { isAuthorized, isLoading: authLoading } = usePageProtection('invoices');\r\n  \r\n  // Theme context\r\n  const { isDarkMode } = useTheme();\r\n  \r\n  // Auth context\r\n  const { user } = useAuth();\r\n\r\n  // Minimum stock requirement - always keep at least 1 in stock\r\n  const MINIMUM_STOCK_REQUIRED = 1;\r\n\r\n  // Date utility functions\r\n  const formatDateForDisplay = (isoDate: string): string => {\r\n    if (!isoDate) return '';\r\n    const date = new Date(isoDate);\r\n    const day = date.getDate().toString().padStart(2, '0');\r\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n    const year = date.getFullYear();\r\n    return `${day}/${month}/${year}`;\r\n  };\r\n\r\n  const formatDateForInput = (displayDate: string): string => {\r\n    if (!displayDate) return '';\r\n    const [day, month, year] = displayDate.split('/');\r\n    if (day && month && year && day.length <= 2 && month.length <= 2 && year.length === 4) {\r\n      return `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;\r\n    }\r\n    return '';\r\n  };\r\n\r\n  const isValidDate = (displayDate: string): boolean => {\r\n    const [day, month, year] = displayDate.split('/');\r\n    if (!day || !month || !year) return false;\r\n    const dayNum = parseInt(day);\r\n    const monthNum = parseInt(month);\r\n    const yearNum = parseInt(year);\r\n    if (isNaN(dayNum) || isNaN(monthNum) || isNaN(yearNum)) return false;\r\n    const date = new Date(yearNum, monthNum - 1, dayNum);\r\n    return date.getDate() === dayNum && \r\n           date.getMonth() + 1 === monthNum && \r\n           date.getFullYear() === yearNum;\r\n  };\r\n  \r\n  // Form state\r\n  const [invoiceDate, setInvoiceDate] = useState(new Date().toISOString().split('T')[0]);\r\n  const [invoiceDateDisplay, setInvoiceDateDisplay] = useState(formatDateForDisplay(new Date().toISOString().split('T')[0]));\r\n  const [selectedShop, setSelectedShop] = useState<Shop | null>(null);\r\n  const [selectedDiscount, setSelectedDiscount] = useState<Discount | null>(null);\r\n  const [cashDiscountEnabled, setCashDiscountEnabled] = useState(false);\r\n  const [dueDate, setDueDate] = useState('');\r\n  const [dueDateDisplay, setDueDateDisplay] = useState('');\r\n  const [dueDateOptions, setDueDateOptions] = useState<{label: string, days: number, isDefault: boolean}[]>([]);\r\n  const [selectedDueDateOption, setSelectedDueDateOption] = useState<{label: string, days: number, isDefault: boolean} | null>(null);\r\n  const [notes, setNotes] = useState('');\r\n  \r\n  // Search states\r\n  const [shopSearchTerm, setShopSearchTerm] = useState('');\r\n  const [productSearchTerm, setProductSearchTerm] = useState('');\r\n  const [salesRepSearchTerm, setSalesRepSearchTerm] = useState('');\r\n  const [shops, setShops] = useState<Shop[]>([]);\r\n  const [discounts, setDiscounts] = useState<Discount[]>([]);\r\n  const [products, setProducts] = useState<Product[]>([]);\r\n  const [salesReps, setSalesReps] = useState<SalesRep[]>([]);\r\n  const [selectedSalesRep, setSelectedSalesRep] = useState<SalesRep | null>(null);\r\n  const [showShopDropdown, setShowShopDropdown] = useState(false);\r\n  const [showProductDropdown, setShowProductDropdown] = useState(false);\r\n  const [showSalesRepDropdown, setShowSalesRepDropdown] = useState(false);\r\n  \r\n  // Free products states\r\n  const [freeProductSearchTerm, setFreeProductSearchTerm] = useState('');\r\n  const [freeProducts, setFreeProducts] = useState<Product[]>([]);\r\n  const [showFreeProductDropdown, setShowFreeProductDropdown] = useState(false);\r\n  \r\n  // Order-related states\r\n  const [orderSearchTerm, setOrderSearchTerm] = useState('');\r\n  const [orders, setOrders] = useState<Order[]>([]);\r\n  const [selectedOrder, setSelectedOrder] = useState<Order | null>(null);\r\n  const [showOrderDropdown, setShowOrderDropdown] = useState(false);\r\n  const [isOrdersLoaded, setIsOrdersLoaded] = useState(false);\r\n  \r\n  // Invoice items\r\n  const [invoiceItems, setInvoiceItems] = useState<InvoiceItem[]>([]);\r\n  \r\n  // UI state\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [message, setMessage] = useState('');\r\n  const [error, setError] = useState('');\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [editingInvoice, setEditingInvoice] = useState<Invoice | null>(null);\r\n  \r\n  // Overdue payment checking\r\n  const [overduePayments, setOverduePayments] = useState<OverduePayment[]>([]);\r\n  const [hasOverduePayments, setHasOverduePayments] = useState(false);\r\n  \r\n  // Invoices list\r\n  const [invoices, setInvoices] = useState<Invoice[]>([]);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [pagination, setPagination] = useState({\r\n    currentPage: 1,\r\n    totalPages: 1,\r\n    totalCount: 0,\r\n    hasNext: false,\r\n    hasPrev: false\r\n  });\r\n  \r\n  // Invoice search and filtering\r\n  const [invoiceSearch, setInvoiceSearch] = useState('');\r\n  const [isViewMode, setIsViewMode] = useState(false);\r\n  const [viewingInvoice, setViewingInvoice] = useState<Invoice | null>(null);\r\n  \r\n  // Last created invoice for quick print access\r\n  const [lastCreatedInvoiceId, setLastCreatedInvoiceId] = useState<number | null>(null);\r\n\r\n  // Settings state\r\n  const [invoiceSettings, setInvoiceSettings] = useState({\r\n    isSellingPriceReadonly: false,\r\n    isDiscountReadonly: false,\r\n    showTotalDiscountFromItems: true,\r\n    showTotalBalanceDiscount: false,\r\n    totalBalanceDiscountPercent: 5,\r\n    hideCostProfit: false\r\n  });\r\n\r\n  // Get user headers for API requests\r\n  const getUserHeaders = () => {\r\n    return {\r\n      'Content-Type': 'application/json',\r\n      'x-user-data': JSON.stringify(user || {})\r\n    };\r\n  };\r\n\r\n  // Load discounts\r\n  useEffect(() => {\r\n    const loadDiscounts = async () => {\r\n      try {\r\n        const response = await fetch('/api/discounts');\r\n        const data = await response.json();\r\n        if (data.success) {\r\n          setDiscounts(data.discounts.filter((d: Discount) => d.percentage > 0));\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading discounts:', error);\r\n      }\r\n    };\r\n\r\n    loadDiscounts();\r\n  }, []);\r\n\r\n  // Load invoice settings from settings\r\n  useEffect(() => {\r\n    const loadInvoiceSettings = async () => {\r\n      try {\r\n        if (user) {\r\n          const response = await fetch('/api/softwareSettings', {\r\n            headers: getUserHeaders()\r\n          });\r\n          const data = await response.json();\r\n          \r\n          if (data.success && data.settings) {\r\n            const newSettings = {\r\n              isSellingPriceReadonly: data.settings.isSellingPriceReadonly === 1 || data.settings.isSellingPriceReadonly === true,\r\n              isDiscountReadonly: data.settings.isDiscountReadonly === 1 || data.settings.isDiscountReadonly === true,\r\n              showTotalDiscountFromItems: !(data.settings.showTotalDiscountFromItems === 1 || data.settings.showTotalDiscountFromItems === true),\r\n              showTotalBalanceDiscount: !(data.settings.showTotalBalanceDiscount === 1 || data.settings.showTotalBalanceDiscount === true),\r\n              totalBalanceDiscountPercent: data.settings.totalBalanceDiscountPercent || 5,\r\n              hideCostProfit: data.settings.hideCostProfit === 1 || data.settings.hideCostProfit === true\r\n            };\r\n            \r\n            setInvoiceSettings(newSettings);\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading invoice settings:', error);\r\n      }\r\n    };\r\n\r\n    loadInvoiceSettings();\r\n  }, [user]);\r\n\r\n  // Load due date options from settings\r\n  useEffect(() => {\r\n    const loadDueDateOptions = async () => {\r\n      try {\r\n        if (user) {\r\n          const response = await fetch('/api/softwareSettings', {\r\n            headers: getUserHeaders()\r\n          });\r\n          \r\n          if (response.ok) {\r\n            const data = await response.json();\r\n            if (data.success && data.settings && data.settings.dueDateOptions) {\r\n              setDueDateOptions(data.settings.dueDateOptions);\r\n              \r\n              // Auto select default option\r\n              const defaultOption = data.settings.dueDateOptions.find((opt: any) => opt.isDefault);\r\n              if (defaultOption) {\r\n                setSelectedDueDateOption(defaultOption);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading due date options:', error);\r\n      }\r\n    };\r\n\r\n    if (user) {\r\n      loadDueDateOptions();\r\n    }\r\n  }, [user]);\r\n\r\n  // Debug invoiceItems state changes\r\n  useEffect(() => {\r\n    console.log('ðŸ” Invoice Items State Changed:', invoiceItems.length, 'items');\r\n    console.log('ðŸ” Items:', invoiceItems);\r\n    if (isViewMode) {\r\n      console.log('ðŸ” In View Mode - Items should display');\r\n    }\r\n  }, [invoiceItems, isViewMode]);\r\n\r\n  // Search shops\r\n  const searchShops = useCallback(async (search: string) => {\r\n    if (search.length < 2) {\r\n      setShops([]);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`/api/shops?search=${encodeURIComponent(search)}&limit=10&activeOnly=true`);\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setShops(data.shops || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error searching shops:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Search products\r\n  const searchProducts = useCallback(async (search: string) => {\r\n    if (search.length < 2) {\r\n      setProducts([]);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`/api/products/search?search=${encodeURIComponent(search)}&limit=10`);\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setProducts(data.products || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error searching products:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Search free products\r\n  const searchFreeProducts = useCallback(async (search: string) => {\r\n    if (search.length < 2) {\r\n      setFreeProducts([]);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await fetch(`/api/products/search?search=${encodeURIComponent(search)}&limit=10`);\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        setFreeProducts(data.products || []);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error searching free products:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Search sales reps\r\n  const searchSalesReps = useCallback(async (search: string) => {\r\n    try {\r\n      const response = await fetch(`/api/sales-rep?search=${encodeURIComponent(search)}&activeOnly=true`);\r\n      const data = await response.json();\r\n      if (data.success) {\r\n        // Filter only active sales reps\r\n        const activeSalesReps = data.salesReps?.filter((rep: SalesRep) => rep.status === 'active') || [];\r\n        setSalesReps(activeSalesReps);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error searching sales reps:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Search orders - Only load orders with pending status\r\n  const searchOrders = useCallback(async (search: string) => {\r\n    try {\r\n      const response = await fetch(`/api/orders/search?search=${encodeURIComponent(search)}&status=pending`);\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        // Handle the API response format: { success: true, orders: [...] }\r\n        if (data.success && Array.isArray(data.orders)) {\r\n          console.log('âœ… Loaded orders with pending status:', data.orders.length);\r\n          setOrders(data.orders);\r\n        } else {\r\n          setOrders([]);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error searching orders:', error);\r\n      setOrders([]);\r\n    }\r\n  }, []);\r\n\r\n  // Load all pending orders when \"Show Orders\" button is clicked\r\n  const loadAllOrders = async () => {\r\n    try {\r\n      console.log('Loading all pending orders...');\r\n      const response = await fetch('/api/orders/search?search=&status=pending&limit=100');\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        if (data.success && Array.isArray(data.orders)) {\r\n          console.log('âœ… Loaded all pending orders:', data.orders.length);\r\n          setOrders(data.orders);\r\n          setIsOrdersLoaded(true);\r\n          setShowOrderDropdown(true);\r\n        } else {\r\n          setOrders([]);\r\n          alert('No pending orders found');\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading orders:', error);\r\n      alert('Failed to load orders. Please try again.');\r\n    }\r\n  };\r\n\r\n  // Debounced shop search\r\n  useEffect(() => {\r\n    const timeoutId = setTimeout(() => {\r\n      if (shopSearchTerm) {\r\n        searchShops(shopSearchTerm);\r\n      }\r\n    }, 300);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [shopSearchTerm, searchShops]);\r\n\r\n  // Debounced product search\r\n  useEffect(() => {\r\n    const timeoutId = setTimeout(() => {\r\n      if (productSearchTerm) {\r\n        searchProducts(productSearchTerm);\r\n      }\r\n    }, 300);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [productSearchTerm, searchProducts]);\r\n\r\n  // Debounced sales rep search\r\n  useEffect(() => {\r\n    const timeoutId = setTimeout(() => {\r\n      if (salesRepSearchTerm) {\r\n        searchSalesReps(salesRepSearchTerm);\r\n      }\r\n    }, 300);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [salesRepSearchTerm, searchSalesReps]);\r\n\r\n  // Debounced free products search\r\n  useEffect(() => {\r\n    const timeoutId = setTimeout(() => {\r\n      if (freeProductSearchTerm) {\r\n        searchFreeProducts(freeProductSearchTerm);\r\n      }\r\n    }, 300);\r\n\r\n    return () => clearTimeout(timeoutId);\r\n  }, [freeProductSearchTerm, searchFreeProducts]);\r\n\r\n  // Debounced order search - Disabled to prevent automatic loading\r\n  // Orders will only load when \"Show Orders\" button is clicked\r\n  // useEffect(() => {\r\n  //   const timeoutId = setTimeout(() => {\r\n  //     if (orderSearchTerm) {\r\n  //       searchOrders(orderSearchTerm);\r\n  //     }\r\n  //   }, 300);\r\n\r\n  //   return () => clearTimeout(timeoutId);\r\n  // }, [orderSearchTerm, searchOrders]);\r\n\r\n  // Function to load order details into invoice form\r\n  const loadOrderDetails = async (order: Order) => {\r\n    try {\r\n      // First fetch the complete order details with items\r\n      const response = await fetch(`/api/orders/${order.id}`);\r\n      if (!response.ok) {\r\n        throw new Error('Failed to fetch order details');\r\n      }\r\n      \r\n      const data = await response.json();\r\n      const fullOrder = data.success ? data.order : null;\r\n      \r\n      if (!fullOrder || !fullOrder.orderItems) {\r\n        alert('Unable to load order details. Please try again.');\r\n        return;\r\n      }\r\n      \r\n      // Check if the order is still pending before loading\r\n      if (fullOrder.status?.toLowerCase() !== 'pending') {\r\n        alert('Only pending orders can be converted to invoices. This order status is: ' + (fullOrder.status || 'Unknown'));\r\n        return;\r\n      }\r\n      \r\n      console.log('âœ… Loading pending order:', fullOrder.orderNumber);\r\n      setSelectedOrder(fullOrder);\r\n      \r\n      // Set shop details\r\n      if (fullOrder.shop) {\r\n        setSelectedShop(fullOrder.shop);\r\n        setShopSearchTerm(fullOrder.shop.shopName);\r\n      }\r\n\r\n      // Set sales rep details\r\n      if (fullOrder.salesRep) {\r\n        setSelectedSalesRep(fullOrder.salesRep);\r\n        setSalesRepSearchTerm(fullOrder.salesRep.name);\r\n      }\r\n\r\n      // Set discount/invoice type details\r\n      if (fullOrder.discount) {\r\n        setSelectedDiscount(fullOrder.discount);\r\n      }\r\n\r\n      // Set cash discount if it was enabled in the order\r\n      if (fullOrder.cashDiscountEnabled) {\r\n        setCashDiscountEnabled(fullOrder.cashDiscountEnabled);\r\n      }\r\n\r\n      // Set notes from the order\r\n      if (fullOrder.notes) {\r\n        setNotes(fullOrder.notes);\r\n      }\r\n\r\n      // Set invoice items from order items\r\n      const invoiceItems = fullOrder.orderItems.map((orderItem: any) => ({\r\n      id: `${Date.now()}_${Math.random()}`, // Generate unique string ID for invoice item\r\n      productId: orderItem.product.id,\r\n      productCode: orderItem.product.productCode,\r\n      productName: orderItem.product.itemName,\r\n      quantity: orderItem.quantity,\r\n      sellingPrice: Number(orderItem.sellingPrice),\r\n      discount: Number(orderItem.discount || 0),\r\n      price: Number(orderItem.price),\r\n      totalPrice: Number(orderItem.totalPrice),\r\n        availableQty: orderItem.product.availableQty,\r\n        costPrice: Number((orderItem.product as any).totalCost || 0)\r\n      }));\r\n\r\n      setInvoiceItems(invoiceItems);\r\n      setShowOrderDropdown(false);\r\n      setOrderSearchTerm(`Order #${fullOrder.id} - ${fullOrder.shop?.shopName || 'N/A'}`);\r\n      \r\n    } catch (error) {\r\n      console.error('Error loading order details:', error);\r\n      alert('Failed to load order details. Please try again.');\r\n    }\r\n  };\r\n\r\n  // Add product to invoice\r\n  const addProductToInvoice = (product: Product) => {\r\n    const existingItem = invoiceItems.find(item => item.productId === product.id);\r\n    \r\n    if (existingItem) {\r\n      // Check if we can increase quantity while maintaining minimum stock\r\n      const newQuantity = Number(existingItem.quantity) + 1;\r\n      const maxAllowedQty = product.availableQty - MINIMUM_STOCK_REQUIRED;\r\n      \r\n      if (newQuantity > maxAllowedQty) {\r\n        setError(`Cannot add more ${product.itemName}. Must maintain minimum stock of ${MINIMUM_STOCK_REQUIRED}. Maximum for sale: ${maxAllowedQty}`);\r\n        return;\r\n      }\r\n      \r\n      // Increase quantity if product already exists and recalculate\r\n      setInvoiceItems(items => \r\n        items.map(item => {\r\n          if (item.productId === product.id) {\r\n            const newPrice = newQuantity * Number(item.sellingPrice);\r\n            const newTotalPrice = newPrice - Number(item.discount);\r\n            return { \r\n              ...item, \r\n              quantity: newQuantity,\r\n              price: newPrice,\r\n              totalPrice: newTotalPrice\r\n            };\r\n          }\r\n          return item;\r\n        })\r\n      );\r\n    } else {\r\n      // Check if product has enough stock to sell (must leave at least 1 in stock)\r\n      const availableForSale = product.availableQty - MINIMUM_STOCK_REQUIRED;\r\n      if (availableForSale < 1) {\r\n        setError(`Cannot add ${product.itemName}. Must maintain minimum stock of ${MINIMUM_STOCK_REQUIRED}. Current stock: ${product.availableQty}`);\r\n        return;\r\n      }\r\n      \r\n      // Add new item\r\n      const quantity = 1;\r\n      const sellingPrice = Number(product.sellingPrice);\r\n      const discount = 0;\r\n      const price = quantity * sellingPrice;\r\n      const totalPrice = price - discount;\r\n      \r\n      const newItem: InvoiceItem = {\r\n        id: `item-${Date.now()}-${product.id}`,\r\n        productId: product.id,\r\n        productCode: product.productCode,\r\n        productName: product.itemName,\r\n        quantity: quantity,\r\n        sellingPrice: sellingPrice,\r\n        discount: discount,\r\n        price: price,\r\n        totalPrice: totalPrice,\r\n        availableQty: product.availableQty,\r\n        costPrice: product.costPrice || 0\r\n      };\r\n      \r\n      setInvoiceItems(items => [...items, newItem]);\r\n    }\r\n    \r\n    setProductSearchTerm('');\r\n    setProducts([]);\r\n    setShowProductDropdown(false);\r\n  };\r\n\r\n  // Add free product to invoice (selling price = 0) - Always as separate row\r\n  const addFreeProductToInvoice = (product: Product) => {\r\n    // Check if product has enough stock to sell (must leave at least 1 in stock)\r\n    const availableForSale = product.availableQty - MINIMUM_STOCK_REQUIRED;\r\n    if (availableForSale < 1) {\r\n      setError(`Cannot add ${product.itemName}. Must maintain minimum stock of ${MINIMUM_STOCK_REQUIRED}. Current stock: ${product.availableQty}`);\r\n      return;\r\n    }\r\n    \r\n    // Always add as new free item (separate row even if product exists as regular item)\r\n    const quantity = 1;\r\n    const sellingPrice = 0; // Free product selling price is 0\r\n    const discount = 0;\r\n    const price = quantity * sellingPrice;\r\n    const totalPrice = price - discount;\r\n    \r\n    const newItem: InvoiceItem = {\r\n      id: `free-item-${Date.now()}-${product.id}-${Math.random()}`, // Unique ID for free items\r\n      productId: product.id,\r\n      productCode: product.productCode,\r\n      productName: `${product.itemName} (FREE)`, // Mark as free in the name\r\n      quantity: quantity,\r\n      sellingPrice: sellingPrice,\r\n      discount: discount,\r\n      price: price,\r\n      totalPrice: totalPrice,\r\n      availableQty: product.availableQty,\r\n      costPrice: product.costPrice || 0\r\n    };\r\n    \r\n    // Add free items to the end of the list (they will appear at the bottom)\r\n    setInvoiceItems(items => [...items, newItem]);\r\n    \r\n    setFreeProductSearchTerm('');\r\n    setFreeProducts([]);\r\n    setShowFreeProductDropdown(false);\r\n  };\r\n\r\n  // Update invoice item with stock validation\r\n  const updateInvoiceItem = (itemId: string, field: string, value: number) => {\r\n    setInvoiceItems(items => \r\n      items.map(item => {\r\n        if (item.id === itemId) {\r\n          let validatedValue = Number(value);\r\n          \r\n          // If updating quantity, validate against available stock\r\n          if (field === 'quantity') {\r\n            if (validatedValue <= 0) {\r\n              validatedValue = 1; // Minimum quantity is 1\r\n              setError(`Quantity must be at least 1 for ${item.productName}`);\r\n            } else if (validatedValue > item.availableQty) {\r\n              setError(`Cannot save invoice! Quantity ${validatedValue} exceeds available stock (${item.availableQty}) for ${item.productName}. Maximum allowed: ${item.availableQty}`);\r\n              validatedValue = item.availableQty; // Set to maximum available\r\n            } else {\r\n              // Clear error if quantity is valid\r\n              setError('');\r\n            }\r\n          }\r\n          \r\n          const updatedItem = { ...item, [field]: validatedValue };\r\n          \r\n          // Recalculate price and total - ensure all values are numbers\r\n          updatedItem.price = Number(updatedItem.quantity) * Number(updatedItem.sellingPrice);\r\n          updatedItem.totalPrice = updatedItem.price - Number(updatedItem.discount);\r\n          \r\n          return updatedItem;\r\n        }\r\n        return item;\r\n      })\r\n    );\r\n  };\r\n\r\n  // Remove invoice item\r\n  const removeInvoiceItem = (itemId: string) => {\r\n    setInvoiceItems(items => items.filter(item => item.id !== itemId));\r\n  };\r\n\r\n  // Calculate totals with useMemo for real-time updates\r\n  const totals = React.useMemo(() => {\r\n    // Sub Total = sum of all Total Price values in the table - ensure numbers\r\n    const subTotal = invoiceItems.reduce((sum, item) => sum + Number(item.totalPrice), 0);\r\n    const totalDiscount = invoiceItems.reduce((sum, item) => sum + Number(item.discount), 0);\r\n    \r\n    // Invoice Type discount (Credit/Cash discount percentage)\r\n    const invoiceTypeDiscount = selectedDiscount ? Number(subTotal) * (parseFloat(selectedDiscount.percentage.toString()) / 100) : 0;\r\n    \r\n    // Cash discount is applied on the Sub Total (after item discounts)\r\n    const cashDiscount = cashDiscountEnabled ? Number(subTotal) * (invoiceSettings.totalBalanceDiscountPercent / 100) : 0;\r\n    \r\n    // Net Total = Sub Total - Invoice Type Discount - Cash Discount\r\n    const netTotal = Number(subTotal) - Number(invoiceTypeDiscount) - Number(cashDiscount);\r\n\r\n    // Calculate total cost and profit for the invoice\r\n    let totalCost = 0;\r\n    let totalProfit = 0;\r\n\r\n    invoiceItems.forEach(item => {\r\n      // Item cost = costPrice * quantity\r\n      const itemCost = (item.costPrice || 0) * item.quantity;\r\n      totalCost += itemCost;\r\n\r\n      // Item profit calculation with all deductions\r\n      const itemTotalPrice = Number(item.totalPrice);\r\n      const itemInvoiceTypeDeduction = selectedDiscount ? (itemTotalPrice * (parseFloat(selectedDiscount.percentage.toString()) / 100)) : 0;\r\n      const itemCashDiscountDeduction = cashDiscountEnabled ? (itemTotalPrice * (invoiceSettings.totalBalanceDiscountPercent / 100)) : 0;\r\n      const itemAdjustedPrice = itemTotalPrice - itemInvoiceTypeDeduction - itemCashDiscountDeduction;\r\n      const itemProfit = itemAdjustedPrice - itemCost;\r\n      \r\n      totalProfit += itemProfit;\r\n    });\r\n\r\n    return {\r\n      subTotal: Number(subTotal),\r\n      totalDiscount: Number(totalDiscount),\r\n      invoiceTypeDiscount: Number(invoiceTypeDiscount),\r\n      cashDiscount: Number(cashDiscount),\r\n      netTotal: Number(netTotal),\r\n      totalCost: Number(totalCost),\r\n      totalProfit: Number(totalProfit)\r\n    };\r\n  }, [invoiceItems, cashDiscountEnabled, selectedDiscount, invoiceSettings.totalBalanceDiscountPercent]);\r\n\r\n  // Calculate due date when invoice date, discount type, or due date option changes\r\n  useEffect(() => {\r\n    if (isCreditInvoice() && invoiceDate && selectedDueDateOption) {\r\n      const invoiceDateObj = new Date(invoiceDate);\r\n      const calculatedDueDate = new Date(invoiceDateObj);\r\n      calculatedDueDate.setDate(calculatedDueDate.getDate() + selectedDueDateOption.days);\r\n      const dueDateISO = calculatedDueDate.toISOString().split('T')[0];\r\n      setDueDate(dueDateISO);\r\n      setDueDateDisplay(formatDateForDisplay(dueDateISO));\r\n    } else {\r\n      setDueDate('');\r\n      setDueDateDisplay('');\r\n    }\r\n  }, [invoiceDate, selectedDiscount, selectedDueDateOption]);\r\n\r\n  // Check if selected invoice type is credit\r\n  const isCreditInvoice = () => {\r\n    return selectedDiscount?.discountName?.toLowerCase().includes('credit') || false;\r\n  };\r\n\r\n  // Handle due date option change\r\n  const handleDueDateOptionChange = (option: {label: string, days: number, isDefault: boolean}) => {\r\n    setSelectedDueDateOption(option);\r\n  };\r\n\r\n  // Check for overdue payments for selected shop\r\n  const checkOverduePayments = async (shopId: number) => {\r\n    try {\r\n      const response = await fetch(`/api/payments?shopId=${shopId}&status=due&limit=100`);\r\n      const data = await response.json();\r\n      \r\n      if (data.success) {\r\n        const overduePmts: OverduePayment[] = data.payments.map((payment: any) => {\r\n          const dueDate = new Date(payment.dueDate);\r\n          const today = new Date();\r\n          today.setHours(0, 0, 0, 0);\r\n          dueDate.setHours(0, 0, 0, 0);\r\n          const daysPastDue = Math.ceil((today.getTime() - dueDate.getTime()) / (1000 * 60 * 60 * 24));\r\n          \r\n          return {\r\n            id: payment.id,\r\n            invoiceNumber: payment.invoice.invoiceNumber,\r\n            dueDate: payment.dueDate,\r\n            remainingAmount: Number(payment.remainingAmount) || 0,\r\n            daysPastDue: Math.max(0, daysPastDue)\r\n          };\r\n        });\r\n        \r\n        setOverduePayments(overduePmts);\r\n        setHasOverduePayments(overduePmts.length > 0);\r\n        \r\n        if (overduePmts.length > 0) {\r\n          const totalOverdue = overduePmts.reduce((sum, p) => sum + Number(p.remainingAmount), 0);\r\n          setError(\r\n            `âš ï¸ This shop has ${overduePmts.length} overdue payment(s) totaling LKR ${totalOverdue.toLocaleString()}. ` +\r\n            `Please settle overdue payments before creating new credit invoices.`\r\n          );\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error checking overdue payments:', error);\r\n    }\r\n  };\r\n\r\n  // Check credit limit validation\r\n  const validateCreditLimit = () => {\r\n    if (!selectedShop || !isCreditInvoice()) return true;\r\n    \r\n    const availableCredit = (selectedShop.creditLimit || 0) - (selectedShop.balanceAmount || 0);\r\n    return totals.netTotal <= availableCredit;\r\n  };\r\n\r\n  // Check if any items have stock validation errors\r\n  const hasStockErrors = () => {\r\n    return invoiceItems.some(item => \r\n      item.quantity <= 0 || item.quantity > item.availableQty\r\n    );\r\n  };\r\n\r\n  // Submit invoice\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!selectedShop) {\r\n      setError('Please select a shop');\r\n      return;\r\n    }\r\n\r\n    if (!selectedSalesRep) {\r\n      setError('Please select a sales representative');\r\n      return;\r\n    }\r\n\r\n    if (!selectedDiscount) {\r\n      setError('Please select an invoice type');\r\n      return;\r\n    }\r\n\r\n    if (invoiceItems.length === 0) {\r\n      setError('Please add at least one product');\r\n      return;\r\n    }\r\n\r\n    // Check for overdue payments if creating a credit invoice\r\n    if (isCreditInvoice() && hasOverduePayments) {\r\n      const totalOverdue = overduePayments.reduce((sum, p) => sum + Number(p.remainingAmount), 0);\r\n      setError(\r\n        `âŒ Cannot create credit invoice! This shop has ${overduePayments.length} overdue payment(s) totaling LKR ${totalOverdue.toLocaleString()}. ` +\r\n        `Please settle all overdue payments before creating new credit invoices.`\r\n      );\r\n      return;\r\n    }\r\n\r\n    // Validate stock availability for all items\r\n    const stockErrors = [];\r\n    for (const item of invoiceItems) {\r\n      if (item.quantity > item.availableQty) {\r\n        stockErrors.push(`${item.productName}: Requested ${item.quantity}, Available ${item.availableQty}`);\r\n      }\r\n      if (item.quantity <= 0) {\r\n        stockErrors.push(`${item.productName}: Invalid quantity ${item.quantity}`);\r\n      }\r\n    }\r\n\r\n    if (stockErrors.length > 0) {\r\n      setError(`Cannot save invoice! Stock validation failed:\\n${stockErrors.join('\\n')}\\nPlease adjust quantities before saving.`);\r\n      return;\r\n    }\r\n\r\n    // Validate credit limit for credit invoices\r\n    if (isCreditInvoice() && !validateCreditLimit()) {\r\n      const availableCredit = (selectedShop.creditLimit || 0) - (selectedShop.balanceAmount || 0);\r\n      setError(`Credit limit exceeded! Available credit: LKR ${availableCredit.toLocaleString()}. Invoice total: LKR ${totals.netTotal.toLocaleString()}`);\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    setError('');\r\n    setMessage('');\r\n\r\n    try {\r\n      const payload = {\r\n        ...(isEditing && { id: editingInvoice?.id }),\r\n        invoiceDate,\r\n        shopId: selectedShop.id,\r\n        salesRepId: selectedSalesRep.id,\r\n        discountId: selectedDiscount?.id || null,\r\n        invoiceType: selectedDiscount?.discountName || null,\r\n        invoiceTypePercentage: selectedDiscount?.percentage || null,\r\n        cashDiscountEnabled,\r\n        ...(isCreditInvoice() && dueDate && { dueDate }),\r\n        ...(selectedOrder && { orderNumber: selectedOrder.orderNumber }),\r\n        notes: notes || null,\r\n        items: invoiceItems.map(item => ({\r\n          productId: item.productId,\r\n          quantity: item.quantity,\r\n          sellingPrice: item.sellingPrice,\r\n          discount: item.discount\r\n        }))\r\n      };\r\n\r\n      const url = '/api/invoices';\r\n      const method = isEditing ? 'PUT' : 'POST';\r\n\r\n      const response = await fetch(url, {\r\n        method,\r\n        headers: getUserHeaders(),\r\n        body: JSON.stringify(payload)\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        setMessage(data.message);\r\n        \r\n        // Store the created invoice ID for printing\r\n        const createdInvoiceId = data.invoice?.id;\r\n        \r\n        // Store last created invoice ID for quick print access\r\n        if (createdInvoiceId && !isEditing) {\r\n          setLastCreatedInvoiceId(createdInvoiceId);\r\n        }\r\n        \r\n        // Show success message briefly, then reset form\r\n        setTimeout(() => {\r\n          if (!isEditing) {\r\n            resetForm();\r\n          }\r\n          setMessage('');\r\n        }, 2000); // Show success message for 2 seconds before resetting\r\n        \r\n        // Show print option for new invoices\r\n        if (createdInvoiceId && !isEditing) {\r\n          setTimeout(() => {\r\n            const shouldPrint = window.confirm('Invoice created successfully! Would you like to print it now?');\r\n            if (shouldPrint) {\r\n              window.open(`/invoices/print/${createdInvoiceId}`, '_blank');\r\n            }\r\n          }, 2500);\r\n        }\r\n      } else {\r\n        setError(data.error || 'Operation failed');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error submitting invoice:', error);\r\n      setError('An error occurred while processing the invoice');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // Reset form\r\n  const resetForm = () => {\r\n    const today = new Date().toISOString().split('T')[0];\r\n    setInvoiceDate(today);\r\n    setInvoiceDateDisplay(formatDateForDisplay(today));\r\n    setSelectedShop(null);\r\n    setSelectedSalesRep(null);\r\n    setSelectedDiscount(null);\r\n    setCashDiscountEnabled(false);\r\n    setDueDate('');\r\n    setDueDateDisplay('');\r\n    setNotes('');\r\n    setInvoiceItems([]);\r\n    setShopSearchTerm('');\r\n    setSalesRepSearchTerm('');\r\n    setProductSearchTerm('');\r\n    setFreeProductSearchTerm('');\r\n    setShowShopDropdown(false);\r\n    setShowSalesRepDropdown(false);\r\n    setShowProductDropdown(false);\r\n    setShowFreeProductDropdown(false);\r\n    setFreeProducts([]);\r\n    setIsEditing(false);\r\n    setEditingInvoice(null);\r\n    setError('');\r\n    setMessage('');\r\n    setOverduePayments([]);\r\n    setHasOverduePayments(false);\r\n  };\r\n\r\n  // Load invoices with search support\r\n  const loadInvoices = useCallback(async (page: number = 1, search: string = '') => {\r\n    setIsLoading(true);\r\n    \r\n    try {\r\n      const params = new URLSearchParams({\r\n        page: page.toString(),\r\n        limit: '5',\r\n        search: search.trim()\r\n      });\r\n\r\n      const response = await fetch(`/api/invoices?${params}`, {\r\n        headers: getUserHeaders()\r\n      });\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        setInvoices(data.invoices);\r\n        setPagination(data.pagination);\r\n        setCurrentPage(page);\r\n        console.log('âœ… Loaded invoices:', data.invoices.length);\r\n      } else {\r\n        setError(data.error || 'Failed to load invoices');\r\n        setInvoices([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading invoices:', error);\r\n      setError('An error occurred while loading invoices');\r\n      setInvoices([]);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Remove auto-loading - invoices will only load when \"Load Invoices\" button is pressed\r\n  // useEffect(() => {\r\n  //   if (user) {\r\n  //     loadInvoices(1, ''); // Load first page automatically\r\n  //   }\r\n  // }, [user, loadInvoices]);\r\n\r\n  // View invoice function\r\n  const viewInvoice = async (invoice: Invoice) => {\r\n    try {\r\n      console.log('ðŸš€ Starting viewInvoice for:', invoice.invoiceNumber, 'ID:', invoice.id);\r\n      \r\n      // Fetch full invoice details\r\n      const response = await fetch(`/api/invoices/${invoice.id}`, {\r\n        headers: getUserHeaders()\r\n      });\r\n      \r\n      console.log('ðŸ“¡ API Response Status:', response.status);\r\n      const data = await response.json();\r\n      console.log('ðŸ“¡ API Response Data:', data);\r\n      \r\n      if (data.success && data.invoice) {\r\n        const fullInvoice = data.invoice;\r\n        \r\n        // Set view mode\r\n        setIsViewMode(true);\r\n        setViewingInvoice(fullInvoice);\r\n        \r\n        // Populate form with invoice data (readonly mode)\r\n        setInvoiceDate(new Date(fullInvoice.invoiceDate).toISOString().split('T')[0]);\r\n        setInvoiceDateDisplay(new Date(fullInvoice.invoiceDate).toLocaleDateString('en-GB'));\r\n        setSelectedShop(fullInvoice.shop);\r\n        setShopSearchTerm(fullInvoice.shop.shopName);\r\n        \r\n        if (fullInvoice.salesRep) {\r\n          setSelectedSalesRep(fullInvoice.salesRep);\r\n          setSalesRepSearchTerm(fullInvoice.salesRep.name);\r\n        }\r\n        \r\n        if (fullInvoice.discount) {\r\n          setSelectedDiscount(fullInvoice.discount);\r\n        }\r\n        \r\n        setCashDiscountEnabled(fullInvoice.cashDiscountEnabled || false);\r\n        setNotes(fullInvoice.notes || '');\r\n        \r\n        // Set due date if available\r\n        if (fullInvoice.dueDate) {\r\n          setDueDate(new Date(fullInvoice.dueDate).toISOString().split('T')[0]);\r\n          setDueDateDisplay(new Date(fullInvoice.dueDate).toLocaleDateString('en-GB'));\r\n        }\r\n        \r\n        // Debug the invoice data structure\r\n        console.log('ðŸ“¦ Full Invoice Data:', fullInvoice);\r\n        console.log('ðŸ“¦ Invoice Items Raw:', fullInvoice.invoiceItems);\r\n        console.log('ðŸ“¦ Free Products Raw:', fullInvoice.freeProducts);\r\n        \r\n        // Convert invoice items from API format to form format\r\n        const formattedItems: InvoiceItem[] = (fullInvoice.invoiceItems || [])\r\n          .map((item: any) => {\r\n            console.log('Processing item:', item);\r\n            return {\r\n              id: `view-${item.productId}-${Date.now()}-${Math.random()}`, // Unique ID for view mode\r\n              productId: item.productId,\r\n              productCode: item.productCode || '',\r\n              productName: item.productName || '',\r\n              quantity: Number(item.quantity || 0),\r\n              sellingPrice: Number(item.sellingPrice || 0),\r\n              discount: Number(item.discount || 0),\r\n              price: Number(item.price || 0),\r\n              totalPrice: Number(item.totalPrice || 0),\r\n              availableQty: Number(item.availableQty || 0),\r\n              costPrice: Number(item.costPrice || 0)\r\n            };\r\n          });\r\n        \r\n        console.log('âœ… Formatted Items for Display:', formattedItems);\r\n        console.log('âœ… Setting', formattedItems.length, 'items to state');\r\n        setInvoiceItems(formattedItems);\r\n        \r\n        // Scroll to top\r\n        window.scrollTo({ top: 0, behavior: 'smooth' });\r\n        \r\n      } else {\r\n        alert('Failed to load invoice details');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error viewing invoice:', error);\r\n      alert('An error occurred while loading invoice details');\r\n    }\r\n  };\r\n\r\n  // Exit view mode\r\n  const exitViewMode = () => {\r\n    setIsViewMode(false);\r\n    setViewingInvoice(null);\r\n    resetForm();\r\n  };\r\n\r\n  // Handle invoice search\r\n  const handleInvoiceSearch = (searchTerm: string) => {\r\n    setInvoiceSearch(searchTerm);\r\n    loadInvoices(1, searchTerm);\r\n  };\r\n\r\n  // Handle page change\r\n  const handlePageChange = (page: number) => {\r\n    if (page >= 1 && page <= pagination.totalPages && !isLoading) {\r\n      loadInvoices(page, invoiceSearch);\r\n    }\r\n  };\r\n\r\n  // Show loading while checking authorization\r\n  if (authLoading) {\r\n    return <div className={styles.loading}>Checking permissions...</div>;\r\n  }\r\n\r\n  // Show access denied if not authorized\r\n  if (!isAuthorized) {\r\n    return <div className={styles.accessDenied}>Access denied to invoice management</div>;\r\n  }\r\n\r\n  return (\r\n    <div className={`${styles.container} ${isDarkMode ? 'dark' : 'light'}`}>\r\n      <div className={styles.header}>\r\n        <h1 className={styles.title}>\r\n          {isViewMode ? `View Invoice - ${viewingInvoice?.invoiceNumber}` : \r\n           isEditing ? 'Edit Invoice' : 'Create Invoice'}\r\n        </h1>\r\n        <p className={styles.subtitle}>\r\n          {isViewMode ? 'Viewing invoice details (read-only mode)' :\r\n           isEditing ? 'Edit invoice details' : 'Create and manage invoices for your business'}\r\n        </p>\r\n        \r\n        {(isEditing || isViewMode) && (\r\n          <button\r\n            type=\"button\"\r\n            onClick={isViewMode ? exitViewMode : resetForm}\r\n            className={styles.clearButton}\r\n          >\r\n            {isViewMode ? 'Back to Create' : 'Cancel Edit'}\r\n          </button>\r\n        )}\r\n      </div>\r\n\r\n      <form onSubmit={handleSubmit} className={styles.form}>\r\n        {/* Load from Order (Optional) */}\r\n        <div className={styles.field}>\r\n          <div className={styles.labelRow}>\r\n            <label className={styles.label}>Load from Order (Optional):</label>\r\n            <button\r\n              type=\"button\"\r\n              onClick={loadAllOrders}\r\n              className={styles.showOrdersButton}\r\n              disabled={isLoading}\r\n            >\r\n              Show Orders\r\n            </button>\r\n          </div>\r\n          <div className={styles.searchContainer}>\r\n            <input\r\n              type=\"text\"\r\n              value={selectedOrder ? `Order #${selectedOrder.id} - ${selectedOrder.shop?.shopName || 'N/A'}` : orderSearchTerm}\r\n              onChange={(e) => {\r\n                if (!selectedOrder && isOrdersLoaded) {\r\n                  const value = e.target.value;\r\n                  setOrderSearchTerm(value);\r\n                  // Filter loaded orders based on search term\r\n                  if (value.trim()) {\r\n                    const filteredOrders = orders.filter(order =>\r\n                      order.orderNumber.toLowerCase().includes(value.toLowerCase()) ||\r\n                      order.shop?.shopName?.toLowerCase().includes(value.toLowerCase()) ||\r\n                      order.notes?.toLowerCase().includes(value.toLowerCase())\r\n                    );\r\n                    setOrders(filteredOrders);\r\n                  } else {\r\n                    // If search is empty, reload all orders\r\n                    loadAllOrders();\r\n                  }\r\n                  setShowOrderDropdown(true);\r\n                }\r\n              }}\r\n              onFocus={() => {\r\n                if (isOrdersLoaded) {\r\n                  setShowOrderDropdown(true);\r\n                }\r\n              }}\r\n              onBlur={() => {\r\n                // Delay hiding to allow clicking on dropdown items\r\n                setTimeout(() => setShowOrderDropdown(false), 150);\r\n              }}\r\n              placeholder={isOrdersLoaded ? \"Search loaded orders...\" : \"Click 'Show Orders' to load orders first\"}\r\n              className={styles.input}\r\n              disabled={isLoading || !isOrdersLoaded}\r\n            />\r\n            \r\n            {selectedOrder && (\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  setSelectedOrder(null);\r\n                  setOrderSearchTerm('');\r\n                  setShowOrderDropdown(false);\r\n                  setIsOrdersLoaded(false);\r\n                  setOrders([]);\r\n                  // Optionally reset the form when clearing order\r\n                  // resetForm();\r\n                }}\r\n                className={styles.clearButton}\r\n                disabled={isLoading}\r\n              >\r\n                Clear Order\r\n              </button>\r\n            )}\r\n            \r\n            {showOrderDropdown && isOrdersLoaded && orders.length > 0 && (\r\n              <div className={styles.dropdown}>\r\n                {orders.map((order) => (\r\n                  <div\r\n                    key={order.id}\r\n                    className={styles.dropdownItem}\r\n                    onClick={() => loadOrderDetails(order)}\r\n                  >\r\n                    <div className={styles.orderInfo}>\r\n                      <strong>Order #{order.id}</strong>\r\n                      <span className={styles.shopName}>{order.shop?.shopName || 'N/A'}</span>\r\n                      <span className={styles.orderDate}>\r\n                        {new Date(order.orderDate).toLocaleDateString()}\r\n                      </span>\r\n                      <span className={styles.orderTotal}>\r\n                        Rs. {Number(order.netTotal || 0).toFixed(2)}\r\n                      </span>\r\n                      {order.notes && (\r\n                        <span className={styles.orderNotes}>{order.notes}</span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n            \r\n            {/* Show message when orders are loaded but none found */}\r\n            {showOrderDropdown && isOrdersLoaded && orders.length === 0 && (\r\n              <div className={styles.dropdown}>\r\n                <div className={styles.noOrdersMessage}>\r\n                  No pending orders found{orderSearchTerm ? ` matching \"${orderSearchTerm}\"` : ''}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Date and Shop Selection */}\r\n        <div className={styles.row}>\r\n          <div className={styles.field}>\r\n            <label className={styles.label}>Invoice Date: *</label>\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"DD/MM/YYYY\"\r\n              value={invoiceDateDisplay}\r\n              onChange={(e) => {\r\n                const value = e.target.value;\r\n                setInvoiceDateDisplay(value);\r\n                \r\n                // Auto-format as user types\r\n                let formattedValue = value.replace(/[^\\d]/g, '');\r\n                if (formattedValue.length >= 3 && formattedValue.length <= 4) {\r\n                  formattedValue = formattedValue.replace(/(\\d{2})(\\d{1,2})/, '$1/$2');\r\n                } else if (formattedValue.length >= 5) {\r\n                  formattedValue = formattedValue.replace(/(\\d{2})(\\d{2})(\\d{4})/, '$1/$2/$3');\r\n                }\r\n                \r\n                if (formattedValue !== value && formattedValue.length <= 10) {\r\n                  setInvoiceDateDisplay(formattedValue);\r\n                }\r\n                \r\n                // Convert to ISO format if valid\r\n                if (isValidDate(formattedValue)) {\r\n                  const isoDate = formatDateForInput(formattedValue);\r\n                  if (isoDate) {\r\n                    setInvoiceDate(isoDate);\r\n                  }\r\n                }\r\n              }}\r\n              onBlur={(e) => {\r\n                const value = e.target.value;\r\n                if (!isValidDate(value)) {\r\n                  const today = new Date().toISOString().split('T')[0];\r\n                  setInvoiceDate(today);\r\n                  setInvoiceDateDisplay(formatDateForDisplay(today));\r\n                }\r\n              }}\r\n              className={styles.input}\r\n              disabled={isLoading}\r\n              required\r\n              maxLength={10}\r\n            />\r\n          </div>\r\n\r\n          <div className={styles.field}>\r\n            <label className={styles.label}>Select Sales Rep: *</label>\r\n            <div className={styles.searchContainer}>\r\n              <input\r\n                type=\"text\"\r\n                value={selectedSalesRep ? `${selectedSalesRep.name} (${selectedSalesRep.contactNumber})` : salesRepSearchTerm}\r\n                onChange={(e) => {\r\n                  if (!selectedSalesRep) {\r\n                    const value = e.target.value;\r\n                    setSalesRepSearchTerm(value);\r\n                    // Show dropdown only if there's text, hide if empty\r\n                    setShowSalesRepDropdown(value.length > 0);\r\n                  }\r\n                }}\r\n                onFocus={() => setShowSalesRepDropdown(true)}\r\n                onBlur={() => {\r\n                  // Delay hiding to allow clicking on dropdown items\r\n                  setTimeout(() => setShowSalesRepDropdown(false), 150);\r\n                }}\r\n                placeholder=\"Type to search sales representatives...\"\r\n                className={styles.input}\r\n                disabled={isLoading}\r\n                required\r\n              />\r\n              {selectedSalesRep && (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    setSelectedSalesRep(null);\r\n                    setSalesRepSearchTerm('');\r\n                    setShowSalesRepDropdown(false);\r\n                  }}\r\n                  className={styles.clearSelection}\r\n                  disabled={isLoading}\r\n                >\r\n                  Ã—\r\n                </button>\r\n              )}\r\n              {showSalesRepDropdown && salesReps.length > 0 && (\r\n                <div className={styles.dropdown}>\r\n                  {salesReps.map((rep) => (\r\n                    <div\r\n                      key={rep.id}\r\n                      className={styles.dropdownItem}\r\n                      onClick={() => {\r\n                        setSelectedSalesRep(rep);\r\n                        setSalesRepSearchTerm('');\r\n                        setShowSalesRepDropdown(false);\r\n                      }}\r\n                    >\r\n                      <div className={styles.repName}>{rep.name}</div>\r\n                      <div className={styles.repContact}>{rep.contactNumber}</div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n          \r\n          <div className={styles.field}>\r\n            <label className={styles.label}>Select Shop/Customer: *</label>\r\n            <div className={styles.searchContainer}>\r\n              <input\r\n                type=\"text\"\r\n                value={selectedShop ? `${selectedShop.shopName} (${selectedShop.ownerName})` : shopSearchTerm}\r\n                onChange={(e) => {\r\n                  if (!selectedShop) {\r\n                    const value = e.target.value;\r\n                    setShopSearchTerm(value);\r\n                    // Show dropdown only if there's text, hide if empty\r\n                    setShowShopDropdown(value.length > 0);\r\n                  }\r\n                }}\r\n                onFocus={() => setShowShopDropdown(true)}\r\n                onBlur={() => {\r\n                  // Delay hiding to allow clicking on dropdown items\r\n                  setTimeout(() => setShowShopDropdown(false), 150);\r\n                }}\r\n                placeholder=\"Search shop by name or owner...\"\r\n                className={styles.input}\r\n                disabled={isLoading}\r\n                required\r\n              />\r\n              \r\n              {selectedShop && (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    setSelectedShop(null);\r\n                    setShopSearchTerm('');\r\n                    setShowShopDropdown(false);\r\n                  }}\r\n                  className={styles.clearSelection}\r\n                >\r\n                  Ã—\r\n                </button>\r\n              )}\r\n\r\n              {showShopDropdown && shops.length > 0 && !selectedShop && (\r\n                <div className={styles.dropdown}>\r\n                  {shops.map((shop) => (\r\n                    <div\r\n                      key={shop.id}\r\n                      onClick={async () => {\r\n                        setSelectedShop(shop);\r\n                        setShopSearchTerm('');\r\n                        setShowShopDropdown(false);\r\n                        setError(''); // Clear any existing errors\r\n                        setOverduePayments([]);\r\n                        setHasOverduePayments(false);\r\n                        \r\n                        // Check for overdue payments for this shop\r\n                        await checkOverduePayments(shop.id);\r\n                      }}\r\n                      className={styles.dropdownItem}\r\n                    >\r\n                      <div className={styles.shopInfo}>\r\n                        <div className={styles.shopName}>{shop.shopName}</div>\r\n                        <div className={styles.shopOwner}>{shop.ownerName} â€¢ {shop.contactNumber}</div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Shop Details Display */}\r\n        {selectedShop && (\r\n          <div className={styles.shopDetailsSection}>\r\n            <div className={styles.shopDetailsCard}>\r\n              <h3 className={styles.shopDetailsTitle}>Shop Information</h3>\r\n              <div className={styles.shopDetailsGrid}>\r\n                <div className={styles.shopDetailItem}>\r\n                  <span className={styles.detailLabel}>Shop Name:</span>\r\n                  <span className={styles.detailValue}>{selectedShop.shopName}</span>\r\n                </div>\r\n                <div className={styles.shopDetailItem}>\r\n                  <span className={styles.detailLabel}>Owner:</span>\r\n                  <span className={styles.detailValue}>{selectedShop.ownerName}</span>\r\n                </div>\r\n                <div className={styles.shopDetailItem}>\r\n                  <span className={styles.detailLabel}>Contact:</span>\r\n                  <span className={styles.detailValue}>{selectedShop.contactNumber}</span>\r\n                </div>\r\n                <div className={styles.shopDetailItem}>\r\n                  <span className={styles.detailLabel}>Credit Limit:</span>\r\n                  <span className={styles.detailValue}>LKR {selectedShop.creditLimit?.toLocaleString() || '0'}</span>\r\n                </div>\r\n                <div className={styles.shopDetailItem}>\r\n                  <span className={styles.detailLabel}>Current Balance:</span>\r\n                  <span className={styles.detailValue}>LKR {selectedShop.balanceAmount?.toLocaleString() || '0'}</span>\r\n                </div>\r\n                <div className={styles.shopDetailItem}>\r\n                  <span className={styles.detailLabel}>Available Credit:</span>\r\n                  <span className={`${styles.detailValue} ${\r\n                    ((selectedShop.creditLimit || 0) - (selectedShop.balanceAmount || 0)) <= 0 \r\n                      ? styles.creditExceeded \r\n                      : styles.availableCredit\r\n                  }`}>\r\n                    LKR {((selectedShop.creditLimit || 0) - (selectedShop.balanceAmount || 0)).toLocaleString()}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Overdue Payments Warning */}\r\n        {selectedShop && hasOverduePayments && (\r\n          <div className={styles.overdueWarningSection}>\r\n            <div className={styles.overdueWarningCard}>\r\n              <h3 className={styles.overdueWarningTitle}>âš ï¸ Overdue Payments Alert</h3>\r\n              <p className={styles.overdueWarningMessage}>\r\n                This shop has {overduePayments.length} overdue payment(s). Credit invoices cannot be created until all overdue payments are settled.\r\n              </p>\r\n              <div className={styles.overduePaymentsList}>\r\n                {overduePayments.map((payment) => (\r\n                  <div key={payment.id} className={styles.overduePaymentItem}>\r\n                    <div className={styles.overdueInvoice}>Invoice: {payment.invoiceNumber}</div>\r\n                    <div className={styles.overdueDays}>{payment.daysPastDue} days overdue</div>\r\n                    <div className={styles.overdueAmount}>LKR {Number(payment.remainingAmount).toLocaleString()}</div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              <div className={styles.overdueTotalSection}>\r\n                <strong className={styles.overdueTotal}>\r\n                  Total Overdue: LKR {overduePayments.reduce((sum, p) => sum + Number(p.remainingAmount), 0).toLocaleString()}\r\n                </strong>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Invoice Type and Notes Row */}\r\n        <div className={styles.invoiceTypeNotesRow}>\r\n          <div className={styles.field}>\r\n            <label className={styles.label}>Invoice Type: *</label>\r\n            <select\r\n              value={selectedDiscount?.id || ''}\r\n              onChange={(e) => {\r\n                const discountId = e.target.value;\r\n                const discount = discounts.find(d => d.id.toString() === discountId);\r\n                setSelectedDiscount(discount || null);\r\n              }}\r\n              className={styles.input}\r\n              disabled={isLoading}\r\n              required\r\n            >\r\n              <option value=\"\" disabled>Select Invoice Type</option>\r\n              {discounts.map((discount) => (\r\n                <option key={discount.id} value={discount.id}>\r\n                  {discount.discountName} Discount ({discount.percentage}%)\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          <div className={styles.field}>\r\n            <label className={styles.label}>Notes:</label>\r\n            <textarea\r\n              value={notes}\r\n              onChange={(e) => setNotes(e.target.value)}\r\n              placeholder=\"Enter any additional notes for this invoice...\"\r\n              className={styles.notesInput}\r\n              disabled={isLoading}\r\n              rows={1}\r\n            />\r\n          </div>\r\n          \r\n          {/* Payment Terms - Show in third column if credit invoice */}\r\n          {isCreditInvoice() && (\r\n            <div className={styles.field}>\r\n              <label className={styles.label}>Payment Terms:</label>\r\n              <select\r\n                value={selectedDueDateOption ? `${selectedDueDateOption.label}-${selectedDueDateOption.days}` : ''}\r\n                onChange={(e) => {\r\n                  const [label, daysStr] = e.target.value.split('-');\r\n                  const days = parseInt(daysStr);\r\n                  const option = dueDateOptions.find(opt => opt.label === label && opt.days === days);\r\n                  if (option) {\r\n                    handleDueDateOptionChange(option);\r\n                  }\r\n                }}\r\n                className={styles.select}\r\n                disabled={isLoading}\r\n              >\r\n                <option value=\"\">Select Payment Terms</option>\r\n                {dueDateOptions.map((option, index) => (\r\n                  <option \r\n                    key={index} \r\n                    value={`${option.label}-${option.days}`}\r\n                  >\r\n                    {option.label} ({option.days} days) {option.isDefault ? '- Default' : ''}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Payment Due Date for Credit Invoices */}\r\n        {isCreditInvoice() && dueDate && (\r\n          <div className={styles.row}>\r\n            <div className={styles.field}>\r\n              <label className={styles.label}>Payment Due Date:</label>\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"DD/MM/YYYY\"\r\n                  value={dueDateDisplay}\r\n                  onChange={(e) => {\r\n                    const value = e.target.value;\r\n                    setDueDateDisplay(value);\r\n                    \r\n                    // Auto-format as user types\r\n                    let formattedValue = value.replace(/[^\\d]/g, '');\r\n                    if (formattedValue.length >= 3 && formattedValue.length <= 4) {\r\n                      formattedValue = formattedValue.replace(/(\\d{2})(\\d{1,2})/, '$1/$2');\r\n                    } else if (formattedValue.length >= 5) {\r\n                      formattedValue = formattedValue.replace(/(\\d{2})(\\d{2})(\\d{4})/, '$1/$2/$3');\r\n                    }\r\n                    \r\n                    if (formattedValue !== value && formattedValue.length <= 10) {\r\n                      setDueDateDisplay(formattedValue);\r\n                    }\r\n                    \r\n                    // Convert to ISO format if valid\r\n                    if (isValidDate(formattedValue)) {\r\n                      const isoDate = formatDateForInput(formattedValue);\r\n                      if (isoDate) {\r\n                        setDueDate(isoDate);\r\n                      }\r\n                    }\r\n                  }}\r\n                  onBlur={(e) => {\r\n                    const value = e.target.value;\r\n                    if (!isValidDate(value) && dueDate) {\r\n                      // Reset to calculated date if invalid\r\n                      setDueDateDisplay(formatDateForDisplay(dueDate));\r\n                    }\r\n                  }}\r\n                  className={styles.input}\r\n                  disabled={isLoading}\r\n                  maxLength={10}\r\n                />\r\n                <small style={{ color: '#666', fontSize: '0.85em', marginTop: '4px', display: 'block' }}>\r\n                  ðŸ’¡ Calculated from: Invoice Date + {selectedDueDateOption?.days || 0} days\r\n                </small>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n\r\n\r\n        {/* Product Search Row - Add Products and Add Free Products on same line */}\r\n        <div className={styles.productSearchRow}>\r\n          <div className={styles.productSearchSection}>\r\n            <label className={styles.label}>Add Products:</label>\r\n            <div className={styles.searchContainer}>\r\n              <input\r\n                type=\"text\"\r\n                value={productSearchTerm}\r\n                onChange={(e) => {\r\n                  const value = e.target.value;\r\n                  setProductSearchTerm(value);\r\n                  // Show dropdown only if there's text, hide if empty\r\n                  setShowProductDropdown(value.length > 0);\r\n                }}\r\n                onFocus={() => setShowProductDropdown(true)}\r\n                onBlur={() => {\r\n                  // Delay hiding to allow clicking on dropdown items\r\n                  setTimeout(() => setShowProductDropdown(false), 150);\r\n                }}\r\n                placeholder=\"Search products by code or name...\"\r\n                className={styles.input}\r\n                disabled={isLoading}\r\n              />\r\n\r\n              {showProductDropdown && products.length > 0 && (\r\n                <div className={styles.dropdown}>\r\n                  {products.map((product) => (\r\n                    <div\r\n                      key={product.id}\r\n                      onClick={() => addProductToInvoice(product)}\r\n                      className={styles.dropdownItem}\r\n                    >\r\n                      <div className={styles.productInfo}>\r\n                        <div className={styles.productName}>\r\n                          <span className={styles.productCode}>{product.productCode}</span>\r\n                          <span className={styles.productTitle}>{product.itemName}</span>\r\n                        </div>\r\n                        <div className={styles.productDetails}>\r\n                          <span>Price: LKR {product.sellingPrice.toLocaleString()}</span>\r\n                          <span>Available: {product.availableQty}</span>\r\n                          <span>Category: {product.category}</span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          <div className={styles.productSearchSection}>\r\n            <label className={styles.label}>Add Free Products:</label>\r\n            <div className={styles.searchContainer}>\r\n              <input\r\n                type=\"text\"\r\n                value={freeProductSearchTerm}\r\n                onChange={(e) => {\r\n                  const value = e.target.value;\r\n                  setFreeProductSearchTerm(value);\r\n                  // Show dropdown only if there's text, hide if empty\r\n                  setShowFreeProductDropdown(value.length > 0);\r\n                }}\r\n                onFocus={() => setShowFreeProductDropdown(true)}\r\n                onBlur={() => {\r\n                  // Delay hiding to allow clicking on dropdown items\r\n                  setTimeout(() => setShowFreeProductDropdown(false), 150);\r\n                }}\r\n                placeholder=\"Search products to add as free items (price = 0)...\"\r\n                className={styles.input}\r\n                disabled={isLoading}\r\n              />\r\n\r\n              {showFreeProductDropdown && freeProducts.length > 0 && (\r\n                <div className={styles.dropdown}>\r\n                  {freeProducts.map((product) => (\r\n                    <div\r\n                      key={`free-${product.id}`}\r\n                      onClick={() => addFreeProductToInvoice(product)}\r\n                      className={styles.dropdownItem}\r\n                    >\r\n                      <div className={styles.productInfo}>\r\n                        <div className={styles.productName}>\r\n                          <span className={styles.productCode}>{product.productCode}</span>\r\n                          <span className={styles.productTitle}>{product.itemName} (FREE)</span>\r\n                        </div>\r\n                        <div className={styles.productDetails}>\r\n                          <span>Original Price: LKR {product.sellingPrice.toLocaleString()}</span>\r\n                          <span>Free Price: LKR 0</span>\r\n                          <span>Available: {product.availableQty}</span>\r\n                          <span>Category: {product.category}</span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Invoice Items Table */}\r\n        {invoiceItems.length > 0 && (\r\n          <div className={styles.itemsSection}>\r\n            <h3 className={styles.sectionTitle}>Invoice Items</h3>\r\n            <div className={styles.itemsTable}>\r\n              <div className={`${styles.itemsHeader} ${!invoiceSettings.showTotalDiscountFromItems ? styles.itemsHeaderNoDiscount : ''}`}>\r\n                <div>Product Code</div>\r\n                <div>Product Name</div>\r\n                <div>Qty</div>\r\n                <div>Selling Price</div>\r\n                {invoiceSettings.showTotalDiscountFromItems && <div>Discount</div>}\r\n                <div>Price</div>\r\n                {!invoiceSettings.hideCostProfit && <div>Cost</div>}\r\n                {!invoiceSettings.hideCostProfit && <div>Profit</div>}\r\n                <div>Total Price</div>\r\n                <div>Actions</div>\r\n              </div>\r\n              <div className={styles.itemsBody}>\r\n                {invoiceItems\r\n                  .sort((a, b) => {\r\n                    // Sort free items (selling price = 0) to the bottom\r\n                    if (a.sellingPrice === 0 && b.sellingPrice !== 0) return 1;\r\n                    if (a.sellingPrice !== 0 && b.sellingPrice === 0) return -1;\r\n                    return 0; // Keep original order for items of same type\r\n                  })\r\n                  .map((item) => (\r\n                  <div key={item.id} className={`${styles.itemRow} ${!invoiceSettings.showTotalDiscountFromItems ? styles.itemRowNoDiscount : ''}`}>\r\n                    <div className={styles.productCode}>{item.productCode}</div>\r\n                    <div className={styles.productName}>{item.productName}</div>\r\n                    <div className={styles.quantity}>\r\n                      <input\r\n                        type=\"number\"\r\n                        min=\"1\"\r\n                        max={item.availableQty}\r\n                        step=\"1\"\r\n                        value={item.quantity}\r\n                        onChange={(e) => updateInvoiceItem(item.id, 'quantity', parseFloat(e.target.value) || 1)}\r\n                        onWheel={handleNumberInputWheel}\r\n                        className={`${styles.quantityInput} ${item.quantity > item.availableQty ? styles.quantityError : ''}`}\r\n                        title={`Available stock: ${item.availableQty}`}\r\n                        readOnly={isViewMode}\r\n                      />\r\n                    </div>\r\n                    <div className={styles.sellingPrice}>\r\n                      <input\r\n                        type=\"number\"\r\n                        min=\"0\"\r\n                        step=\"0.01\"\r\n                        value={item.sellingPrice}\r\n                        onChange={(e) => updateInvoiceItem(item.id, 'sellingPrice', parseFloat(e.target.value) || 0)}\r\n                        onWheel={handleNumberInputWheel}\r\n                        className={styles.priceInput}\r\n                        readOnly={isViewMode || invoiceSettings.isSellingPriceReadonly || item.sellingPrice === 0}\r\n                        title={\r\n                          isViewMode ? 'View mode - cannot edit' :\r\n                          item.sellingPrice === 0 \r\n                            ? 'Free item - selling price cannot be changed' \r\n                            : (invoiceSettings.isSellingPriceReadonly ? 'Selling price is read-only (configured in settings)' : '')\r\n                        }\r\n                      />\r\n                    </div>\r\n                    {invoiceSettings.showTotalDiscountFromItems && (\r\n                      <div className={styles.discount}>\r\n                        <input\r\n                          type=\"number\"\r\n                          min=\"0\"\r\n                          step=\"0.01\"\r\n                          value={item.discount}\r\n                          onChange={(e) => updateInvoiceItem(item.id, 'discount', parseFloat(e.target.value) || 0)}\r\n                          onWheel={handleNumberInputWheel}\r\n                          className={styles.discountInput}\r\n                          placeholder=\"0.00\"\r\n                          readOnly={isViewMode || invoiceSettings.isDiscountReadonly || item.sellingPrice === 0}\r\n                          title={\r\n                            isViewMode ? 'View mode - cannot edit' :\r\n                            item.sellingPrice === 0 \r\n                              ? 'Free item - no additional discount can be applied' \r\n                              : (invoiceSettings.isDiscountReadonly ? 'Discount is read-only (configured in settings)' : '')\r\n                          }\r\n                        />\r\n                      </div>\r\n                    )}\r\n                    <div className={styles.price}>\r\n                      LKR {item.price.toLocaleString()}\r\n                    </div>\r\n                    {!invoiceSettings.hideCostProfit && (\r\n                      <div className={styles.cost}>\r\n                        LKR {(item.costPrice * item.quantity).toLocaleString()}\r\n                      </div>\r\n                    )}\r\n                    {!invoiceSettings.hideCostProfit && (\r\n                      <div className={styles.profit}>\r\n                        LKR {(() => {\r\n                          // Invoice Type deduction (Credit/Cash Discount %)\r\n                          const invoiceTypeDeduction = selectedDiscount ? (item.totalPrice * (parseFloat(selectedDiscount.percentage.toString()) / 100)) : 0;\r\n                          \r\n                          // Cash Discount deduction (if enabled)\r\n                          const cashDiscountDeduction = cashDiscountEnabled ? (item.totalPrice * (invoiceSettings.totalBalanceDiscountPercent / 100)) : 0;\r\n                          \r\n                          // Calculate final profit: Total Price - Invoice Type % - Cash Discount % - Total Cost\r\n                          const adjustedTotalPrice = item.totalPrice - invoiceTypeDeduction - cashDiscountDeduction;\r\n                          const totalCost = item.costPrice * item.quantity;\r\n                          return (adjustedTotalPrice - totalCost).toLocaleString();\r\n                        })()}\r\n                      </div>\r\n                    )}\r\n                    <div className={styles.totalPrice}>\r\n                      LKR {item.totalPrice.toLocaleString()}\r\n                    </div>\r\n                    <div className={styles.actions}>\r\n                      {!isViewMode && (\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => removeInvoiceItem(item.id)}\r\n                          className={styles.removeButton}\r\n                        >\r\n                          Remove\r\n                        </button>\r\n                      )}\r\n                      {isViewMode && (\r\n                        <span className={styles.viewModeLabel}>View Only</span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Totals Section */}\r\n            <div className={styles.totalsSection}>\r\n              <div className={styles.totalsGrid}>\r\n                <div className={styles.totalRow}>\r\n                  <span>Sub Total{selectedDiscount ? ` - ${selectedDiscount.discountName} Discount (${selectedDiscount.percentage}%)` : ''}:</span>\r\n                  <span>LKR {totals.subTotal.toLocaleString()}</span>\r\n                </div>\r\n                {selectedDiscount && (\r\n                  <div className={styles.totalRow}>\r\n                    <span>Discount Amount ({selectedDiscount.percentage}%):</span>\r\n                    <span>- LKR {totals.invoiceTypeDiscount.toLocaleString()}</span>\r\n                  </div>\r\n                )}\r\n                {invoiceSettings.showTotalDiscountFromItems && (\r\n                  <div className={styles.totalRow}>\r\n                    <span>Total Discount from Items:</span>\r\n                    <span>LKR {totals.totalDiscount.toLocaleString()}</span>\r\n                  </div>\r\n                )}\r\n                {invoiceSettings.showTotalBalanceDiscount && (\r\n                  <div className={styles.totalRow}>\r\n                    <label className={styles.cashDiscountLabel}>\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={cashDiscountEnabled}\r\n                        onChange={(e) => setCashDiscountEnabled(e.target.checked)}\r\n                        className={styles.checkbox}\r\n                      />\r\n                      <span>Cash Discount ({invoiceSettings.totalBalanceDiscountPercent}%):</span>\r\n                    </label>\r\n                    <span>\r\n                      {cashDiscountEnabled && totals.cashDiscount > 0\r\n                        ? `- LKR ${totals.cashDiscount.toLocaleString()}`\r\n                        : 'LKR 0'}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n                <div className={`${styles.totalRow} ${styles.netTotal}`}>\r\n                  <span>Net Total:</span>\r\n                  <span>LKR {totals.netTotal.toLocaleString()}</span>\r\n                </div>\r\n                {!invoiceSettings.hideCostProfit && (\r\n                  <div className={styles.totalRow}>\r\n                    <span>Total Cost:</span>\r\n                    <span>LKR {totals.totalCost.toLocaleString()}</span>\r\n                  </div>\r\n                )}\r\n                {!invoiceSettings.hideCostProfit && (\r\n                  <div className={`${styles.totalRow} ${styles.profitRow}`}>\r\n                    <span>Total Profit:</span>\r\n                    <span style={{color: totals.totalProfit >= 0 ? '#28a745' : '#dc3545', fontWeight: 'bold'}}>\r\n                      LKR {totals.totalProfit.toLocaleString()}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {error && <div className={styles.error}>{error}</div>}\r\n        {message && <div className={styles.success}>{message}</div>}\r\n\r\n        {/* Submit and Print buttons section */}\r\n        <div className={styles.submitSection}>\r\n          {/* Show submit button for create/edit modes */}\r\n          {!isViewMode && (\r\n            <button \r\n              type=\"submit\" \r\n              className={styles.submitButton}\r\n              disabled={isLoading || !selectedShop || !selectedDiscount || invoiceItems.length === 0 || hasStockErrors() || (isCreditInvoice() && hasOverduePayments)}\r\n              title={\r\n                hasStockErrors() ? \"Cannot save: Some items exceed available stock\" : \r\n                (isCreditInvoice() && hasOverduePayments) ? \"Cannot create credit invoice: Shop has overdue payments\" : \"\"\r\n              }\r\n            >\r\n              {isLoading ? 'Processing...' : hasStockErrors() ? 'Check Stock Quantities' : (isEditing ? 'Update Invoice' : 'Create Invoice')}\r\n            </button>\r\n          )}\r\n          \r\n          {/* Print Last Invoice Button - Show next to Create Invoice button */}\r\n          {!isViewMode && lastCreatedInvoiceId && (\r\n            <button \r\n              type=\"button\"\r\n              onClick={() => window.open(`/invoices/print/${lastCreatedInvoiceId}`, '_blank')}\r\n              className={styles.printLastInvoiceButton}\r\n              disabled={isLoading}\r\n              title=\"Print the last created invoice\"\r\n            >\r\n              ðŸ–¨ï¸ Print Last Invoice\r\n            </button>\r\n          )}\r\n          \r\n          {/* Show print button in view mode */}\r\n          {isViewMode && viewingInvoice && (\r\n            <button \r\n              type=\"button\"\r\n              onClick={() => window.open(`/invoices/print/${viewingInvoice.id}`, '_blank')}\r\n              className={styles.printInvoiceButton}\r\n              disabled={isLoading}\r\n            >\r\n              ðŸ–¨ï¸ Print This Invoice\r\n            </button>\r\n          )}\r\n        </div>\r\n      </form>\r\n\r\n      {/* Invoices List Section */}\r\n      <div className={styles.invoicesList}>\r\n        <div className={styles.invoicesHeader}>\r\n          <h2 className={styles.subtitle}>Recent Invoices</h2>\r\n          <div className={styles.invoicesControls}>\r\n            <div className={styles.searchContainer}>\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Search by invoice number or shop name...\"\r\n                value={invoiceSearch}\r\n                onChange={(e) => setInvoiceSearch(e.target.value)}\r\n                onKeyPress={(e) => {\r\n                  if (e.key === 'Enter') {\r\n                    handleInvoiceSearch(invoiceSearch);\r\n                  }\r\n                }}\r\n                className={styles.searchInput}\r\n              />\r\n              <button\r\n                onClick={() => handleInvoiceSearch(invoiceSearch)}\r\n                className={styles.searchButton}\r\n                disabled={isLoading}\r\n              >\r\n                ðŸ”\r\n              </button>\r\n            </div>\r\n            <button\r\n              onClick={() => loadInvoices(1, invoiceSearch)}\r\n              className={styles.loadButton}\r\n              disabled={isLoading}\r\n            >\r\n              {isLoading ? 'Loading...' : 'Load Latest 5 Invoices'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {invoices.length > 0 && (\r\n          <>\r\n            <div className={styles.invoicesTable}>\r\n              <div className={styles.tableHeader}>\r\n                <div>Invoice #</div>\r\n                <div>Date</div>\r\n                <div>Shop</div>\r\n                <div>Items</div>\r\n                <div>Net Total</div>\r\n                <div>Notes</div>\r\n                <div>Actions</div>\r\n              </div>\r\n              <div className={styles.tableBody}>\r\n                {invoices.map((invoice) => (\r\n                  <div key={invoice.id} className={styles.tableRow}>\r\n                    <div className={styles.invoiceNumber}>{invoice.invoiceNumber}</div>\r\n                    <div>{new Date(invoice.invoiceDate).toLocaleDateString()}</div>\r\n                    <div>{invoice.shop.shopName}</div>\r\n                    <div>{invoice.invoiceItems.length} items</div>\r\n                    <div>LKR {Number(invoice.netTotal).toLocaleString()}</div>\r\n                    <div className={styles.notes} title={invoice.notes || 'No notes'}>\r\n                      {invoice.notes ? (invoice.notes.length > 30 ? `${invoice.notes.substring(0, 30)}...` : invoice.notes) : '-'}\r\n                    </div>\r\n                    <div className={styles.actions}>\r\n                      <button \r\n                        className={styles.viewButton}\r\n                        onClick={() => viewInvoice(invoice)}\r\n                        disabled={isLoading}\r\n                      >\r\n                        View\r\n                      </button>\r\n                      <button \r\n                        className={styles.printButton}\r\n                        onClick={() => window.open(`/invoices/print/${invoice.id}`, '_blank')}\r\n                        disabled={isLoading}\r\n                        title=\"Print Invoice\"\r\n                      >\r\n                        Print\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Pagination */}\r\n            {pagination.totalPages > 1 && (\r\n              <div className={styles.pagination}>\r\n                <div className={styles.paginationInfo}>\r\n                  <span>\r\n                    Page {pagination.currentPage} of {pagination.totalPages} \r\n                    ({pagination.totalCount} total invoices)\r\n                    {invoiceSearch && <span> | Filtered by: \"{invoiceSearch}\"</span>}\r\n                  </span>\r\n                </div>\r\n                <div className={styles.paginationButtons}>\r\n                  <button\r\n                    onClick={() => handlePageChange(currentPage - 1)}\r\n                    disabled={!pagination.hasPrev || isLoading}\r\n                    className={styles.pageButton}\r\n                  >\r\n                    â† Previous\r\n                  </button>\r\n                  \r\n                  {/* Page numbers */}\r\n                  {(() => {\r\n                    const pages = [];\r\n                    const totalPages = pagination.totalPages;\r\n                    const current = currentPage;\r\n                    \r\n                    if (totalPages <= 5) {\r\n                      // Show all pages if 5 or fewer\r\n                      for (let i = 1; i <= totalPages; i++) {\r\n                        pages.push(i);\r\n                      }\r\n                    } else {\r\n                      // Show smart pagination\r\n                      pages.push(1);\r\n                      \r\n                      if (current > 3) {\r\n                        pages.push('...');\r\n                      }\r\n                      \r\n                      const start = Math.max(2, current - 1);\r\n                      const end = Math.min(totalPages - 1, current + 1);\r\n                      \r\n                      for (let i = start; i <= end; i++) {\r\n                        if (!pages.includes(i)) {\r\n                          pages.push(i);\r\n                        }\r\n                      }\r\n                      \r\n                      if (current < totalPages - 2) {\r\n                        pages.push('...');\r\n                      }\r\n                      \r\n                      if (!pages.includes(totalPages)) {\r\n                        pages.push(totalPages);\r\n                      }\r\n                    }\r\n                    \r\n                    return pages.map((page, index) => (\r\n                      page === '...' ? (\r\n                        <span key={`ellipsis-${index}`} className={styles.ellipsis}>...</span>\r\n                      ) : (\r\n                        <button\r\n                          key={page}\r\n                          onClick={() => handlePageChange(page as number)}\r\n                          className={`${styles.pageButton} ${page === currentPage ? styles.activePage : ''}`}\r\n                          disabled={isLoading}\r\n                        >\r\n                          {page}\r\n                        </button>\r\n                      )\r\n                    ));\r\n                  })()}\r\n                  \r\n                  <button\r\n                    onClick={() => handlePageChange(currentPage + 1)}\r\n                    disabled={!pagination.hasNext || isLoading}\r\n                    className={styles.pageButton}\r\n                  >\r\n                    Next â†’\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        {/* No invoices message */}\r\n        {invoices.length === 0 && !isLoading && (\r\n          <div className={styles.noInvoices}>\r\n            <p>No invoices found{invoiceSearch ? ` matching \"${invoiceSearch}\"` : ''}.</p>\r\n            <p>Click \"Load Latest 5 Invoices\" to fetch recent invoices.</p>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default InvoiceManagement;"],"names":[],"mappings":"0BAAA,EAAA,CAAA,CAAA,CACA,aAAA,uCACA,QAAA,kCACA,WAAA,qCACA,gBAAA,0CACA,kBAAA,4CACA,SAAA,mCACA,YAAA,sCACA,eAAA,yCACA,UAAA,oCACA,eAAA,yCACA,KAAA,+BACA,YAAA,sCACA,YAAA,sCACA,SAAA,mCACA,cAAA,wCACA,SAAA,mCACA,aAAA,uCACA,aAAA,uCACA,SAAA,mCACA,MAAA,gCACA,OAAA,iCACA,MAAA,gCACA,KAAA,+BACA,OAAA,iCACA,MAAA,gCACA,cAAA,wCACA,oBAAA,8CACA,iBAAA,2CACA,eAAA,yCACA,aAAA,uCACA,cAAA,wCACA,QAAA,kCACA,UAAA,oCACA,YAAA,sCACA,aAAA,uCACA,WAAA,qCACA,MAAA,gCACA,SAAA,mCACA,WAAA,qCACA,QAAA,kCACA,SAAA,mCACA,WAAA,qCACA,gBAAA,0CACA,MAAA,gCACA,WAAA,qCACA,UAAA,oCACA,UAAA,oCACA,WAAA,qCACA,WAAA,qCACA,cAAA,wCACA,YAAA,sCACA,eAAA,yCACA,mBAAA,6CACA,oBAAA,8CACA,aAAA,uCACA,oBAAA,8CACA,mBAAA,6CACA,sBAAA,gDACA,sBAAA,gDACA,oBAAA,8CACA,WAAA,qCACA,WAAA,qCACA,kBAAA,4CACA,eAAA,yCACA,MAAA,gCACA,WAAA,qCACA,YAAA,sCACA,mBAAA,6CACA,uBAAA,iDACA,YAAA,sCACA,eAAA,yCACA,YAAA,sCACA,YAAA,sCACA,iBAAA,2CACA,qBAAA,+CACA,aAAA,uCACA,UAAA,oCACA,MAAA,gCACA,aAAA,uCACA,SAAA,mCACA,cAAA,wCACA,cAAA,wCACA,aAAA,uCACA,WAAA,qCACA,QAAA,kCACA,IAAA,8BACA,aAAA,uCACA,gBAAA,0CACA,YAAA,sCACA,aAAA,uCACA,OAAA,iCACA,aAAA,uCACA,eAAA,yCACA,gBAAA,0CACA,gBAAA,0CACA,mBAAA,6CACA,iBAAA,2CACA,SAAA,mCACA,SAAA,mCACA,UAAA,oCACA,iBAAA,2CACA,QAAA,kCACA,aAAA,uCACA,cAAA,wCACA,SAAA,mCACA,QAAA,kCACA,UAAA,oCACA,YAAA,sCACA,SAAA,mCACA,SAAA,mCACA,MAAA,gCACA,WAAA,qCACA,SAAA,mCACA,WAAA,qCACA,cAAA,wCACA,WAAA,qCACA,cAAA,uCACA,4CCpHA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,wBAoGoC,KAEnB,CAAA,EAAA,EAAA,SAAS,AAAT,IAGf,GAAM,cAAE,CAAY,CAAE,UAAW,CAAW,CAAE,CAAG,CAAA,EAAA,EAAA,iBAAA,AAAiB,EAAC,YAG7D,YAAE,CAAU,CAAE,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,IAGzB,MAAE,CAAI,CAAE,CAAG,CAAA,EAAA,EAAA,OAAA,AAAO,IAMlB,EAAuB,AAAC,IAC5B,GAAI,CAAC,EAAS,MAAO,GACrB,IAAM,EAAO,IAAI,KAAK,GAChB,EAAM,EAAK,OAAO,GAAG,QAAQ,GAAG,QAAQ,CAAC,EAAG,KAC5C,EAAQ,CAAC,EAAK,QAAQ,IAAK,CAAC,CAAE,QAAQ,GAAG,QAAQ,CAAC,EAAG,KACrD,EAAO,EAAK,WAAW,GAC7B,MAAO,CAAA,EAAG,EAAI,CAAC,EAAE,EAAM,CAAC,EAAE,EAAA,CAAM,AAClC,EAEM,EAAqB,AAAC,IAC1B,GAAI,CAAC,EAAa,MAAO,GACzB,GAAM,CAAC,EAAK,EAAO,EAAK,CAAG,EAAY,KAAK,CAAC,YAC7C,AAAI,GAAO,GAAS,GAAQ,EAAI,MAAM,EAAI,GAAK,EAAM,MAAM,EAAI,GAAqB,AAAhB,GAAmB,GAAd,MAAM,CACtE,CAAA,EAAG,EAAK,CAAC,EAAE,EAAM,QAAQ,CAAC,EAAG,KAAK,CAAC,EAAE,EAAI,QAAQ,CAAC,EAAG,KAAA,CAAM,CAE7D,EACT,EAEM,EAAc,AAAC,IACnB,GAAM,CAAC,EAAK,EAAO,EAAK,CAAG,EAAY,KAAK,CAAC,KAC7C,GAAI,CAAC,GAAO,CAAC,GAAS,CAAC,EAAM,OAAO,EACpC,IAAM,EAAS,SAAS,GAClB,EAAW,SAAS,GACpB,EAAU,SAAS,GACzB,GAAI,MAAM,IAAW,MAAM,IAAa,MAAM,GAAU,MAAO,GAC/D,IAAM,EAAO,IAAI,KAAK,EAAS,EAAW,EAAG,GAC7C,OAAO,EAAK,OAAO,KAAO,GACnB,EAAK,QAAQ,GAAK,IAAM,GACxB,EAAK,WAAW,KAAO,CAChC,EAGM,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,EAC/E,CAAC,EAAoB,EAAsB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,EAAqB,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,GAClH,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAc,MACxD,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAkB,MACpE,CAAC,EAAqB,EAAuB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACzD,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC/C,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAsD,EAAE,EACtG,CAAC,EAAuB,EAAyB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA2D,MACvH,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAG7B,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC/C,CAAC,EAAmB,EAAqB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACrD,CAAC,EAAoB,EAAsB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACvD,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAS,EAAE,EACvC,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAa,EAAE,EACnD,CAAC,EAAU,EAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAY,EAAE,EAChD,CAAC,EAAW,EAAa,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAqB,EAAE,EACnD,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAkB,MACpE,CAAC,EAAkB,EAAoB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACnD,CAAC,EAAqB,GAAuB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACzD,CAAC,GAAsB,GAAwB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAG3D,CAAC,GAAuB,GAAyB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7D,CAAC,GAAc,GAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAY,EAAE,EACxD,CAAC,GAAyB,GAA2B,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAGjE,CAAC,GAAiB,GAAmB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,IACjD,CAAC,GAAQ,GAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAU,EAAE,EAC1C,CAAC,GAAe,GAAiB,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAuB,MAC3D,CAAC,GAAmB,GAAqB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACrD,CAAC,GAAgB,GAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAG/C,CAAC,GAAc,GAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,EAAE,EAG5D,CAAC,GAAW,GAAa,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,GAAS,GACrC,CAAC,GAAS,GAAW,CAAG,CAAA,EAAA,EAAA,QAAQ,AAAR,EAAS,IACjC,CAAC,GAAO,GAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7B,CAAC,GAAW,GAAa,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACrC,CAAC,GAAgB,GAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiB,MAG/D,CAAC,GAAiB,GAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAmB,EAAE,EACrE,CAAC,GAAoB,GAAsB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAGvD,CAAC,GAAU,GAAY,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAY,EAAE,EAChD,CAAC,GAAa,GAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,GACzC,CAAC,GAAY,GAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CAC3C,YAAa,EACb,WAAY,EACZ,WAAY,EACZ,SAAS,EACT,SAAS,CACX,GAGM,CAAC,GAAe,GAAiB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IAC7C,CAAC,GAAY,GAAc,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACvC,CAAC,GAAgB,GAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAiB,MAG/D,CAAC,GAAsB,GAAwB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAG1E,CAAC,GAAiB,GAAmB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CACrD,wBAAwB,EACxB,oBAAoB,EACpB,4BAA4B,EAC5B,0BAA0B,EAC1B,4BAA6B,EAC7B,gBAAgB,CAClB,GAGM,GAAiB,KACd,CACL,eAAgB,mBAChB,cAAe,KAAK,SAAS,CAAC,GAAQ,CAAC,GACzC,EAIF,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KAaR,CAZsB,UACpB,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,kBACvB,EAAO,MAAM,EAAS,IAAI,GAC5B,EAAK,OAAO,EAAE,AAChB,EAAa,EAAK,SAAS,CAAC,MAAM,CAAE,AAAD,GAAiB,EAAE,UAAU,CAAG,GAEvE,CAAE,MAAO,EAAO,CAEhB,CACF,IAGF,EAAG,EAAE,EAGL,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,KA2BR,CA1B4B,UAC1B,GAAI,CACF,GAAI,EAAM,CACR,IAAM,EAAW,MAAM,MAAM,wBAAyB,CACpD,QAAS,IACX,GACM,EAAO,MAAM,EAAS,IAAI,GAEhC,GAAI,EAAK,OAAO,EAAI,EAAK,QAAQ,CAAE,CACjC,IAAM,EAAc,CAClB,uBAAiE,IAAzC,EAAK,QAAQ,CAAC,sBAAsB,GAAmD,IAAzC,EAAK,QAAQ,CAAC,sBAAsB,CAC1G,mBAAyD,IAArC,EAAK,QAAQ,CAAC,kBAAkB,EAAU,CAAqC,MAAhC,QAAQ,CAAC,kBAAkB,CAC9F,2BAA2E,CAA/C,CAAC,EAAC,EAAK,QAAQ,CAAC,0BAA0B,EAAU,CAA6C,IAAI,EAA5C,QAAQ,CAAC,0BAA0B,CACxH,yBAAuE,AAA3C,CAAF,CAAC,IAAM,QAAQ,CAAC,wBAAwB,GAAqD,IAA3C,AAA+C,EAA1C,QAAQ,CAAC,wBAAwB,CAClH,4BAA6B,EAAK,QAAQ,CAAC,2BAA2B,EAAI,EAC1E,eAAiD,IAAjC,EAAK,QAAQ,CAAC,cAAc,EAA2C,AAAjC,OAAK,QAAQ,CAAC,cACtE,AADoF,EAGpF,GAAmB,EACrB,CACF,CACF,CAAE,MAAO,EAAO,CAEhB,EACF,GAGF,EAAG,CAAC,EAAK,EAGT,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAqB,UACzB,GAAI,CACF,GAAI,EAAM,CACR,IAAM,EAAW,MAAM,MAAM,wBAAyB,CACpD,QAAS,IACX,GAEA,GAAI,EAAS,EAAE,CAAE,CACf,IAAM,EAAO,MAAM,EAAS,IAAI,GAChC,GAAI,EAAK,OAAO,EAAI,EAAK,QAAQ,EAAI,EAAK,QAAQ,CAAC,cAAc,CAAE,CACjE,EAAkB,EAAK,QAAQ,CAAC,cAAc,EAG9C,IAAM,EAAgB,EAAK,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,AAAC,GAAa,EAAI,SAAS,EAC/E,GACF,EAAyB,EAE7B,CACF,CACF,CACF,CAAE,IANyB,EAMlB,EAAO,CAEhB,CACF,EAEI,GACF,GADQ,AAGZ,EAAG,CAAC,EAAK,EAGT,CAAA,EAAA,EAAA,SAAS,AAAT,EAAU,KAMV,EAAG,CAAC,GAAc,GAAW,EAG7B,IAAM,GAAc,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IACrC,GAAI,EAAO,MAAM,CAAG,EAAG,YACrB,EAAS,EAAE,EAIb,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,kBAAkB,EAAE,mBAAmB,GAAQ,yBAAyB,CAAC,EACjG,EAAO,MAAM,EAAS,IAAI,GAC5B,EAAK,OAAO,EACd,AADgB,EACP,EAAK,KAAK,EAAI,EAAE,CAE7B,CAAE,MAAO,EAAO,CAEhB,CACF,EAAG,EAAE,EAGC,GAAiB,CAAA,EAAA,EAAA,WAAW,AAAX,EAAY,MAAO,IACxC,GAAI,EAAO,MAAM,CAAG,EAAG,YACrB,EAAY,EAAE,EAIhB,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,4BAA4B,EAAE,mBAAmB,GAAQ,SAAS,CAAC,EAC3F,EAAO,MAAM,EAAS,IAAI,GAC5B,EAAK,OAAO,EAAE,AAChB,EAAY,EAAK,QAAQ,EAAI,EAAE,CAEnC,CAAE,MAAO,EAAO,CAEhB,CACF,EAAG,EAAE,EAGC,GAAqB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IAC5C,GAAI,EAAO,MAAM,CAAG,EAAG,YACrB,GAAgB,EAAE,EAIpB,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,4BAA4B,EAAE,mBAAmB,GAAQ,SAAS,CAAC,EAC3F,EAAO,MAAM,EAAS,IAAI,EAC5B,GAAK,OAAO,EAAE,AAChB,GAAgB,EAAK,QAAQ,EAAI,EAAE,CAEvC,CAAE,MAAO,EAAO,CAEhB,CACF,EAAG,EAAE,EAGC,GAAkB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IACzC,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,sBAAsB,EAAE,mBAAmB,GAAQ,gBAAgB,CAAC,EAC5F,EAAO,MAAM,EAAS,IAAI,GAChC,GAAI,EAAK,OAAO,CAAE,CAEhB,IAAM,EAAkB,EAAK,SAAS,EAAE,OAAO,AAAC,GAAiC,WAAf,EAAI,MAAM,GAAkB,EAAE,CAChG,EAAa,EACf,CACF,CAAE,MAAO,EAAO,CAEhB,CACF,EAAG,EAAE,EAGgB,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,IACtC,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,0BAA0B,EAAE,mBAAmB,GAAQ,eAAe,CAAC,EACrG,GAAI,EAAS,EAAE,CAAE,CACf,IAAM,EAAO,MAAM,EAAS,IAAI,GAE5B,EAAK,OAAO,EAAI,MAAM,OAAO,CAAC,EAAK,MAAM,EAE3C,CAF8C,EAEpC,EAAK,MAAM,EAErB,GAAU,EAAE,CAEhB,CACF,CAAE,MAAO,EAAO,CAEd,GAAU,EAAE,CACd,CACF,EAAG,EAAE,EAGL,IAAM,GAAgB,UACpB,GAAI,CAEF,IAAM,EAAW,MAAM,MAAM,uDAC7B,GAAI,EAAS,EAAE,CAAE,CACf,IAAM,EAAO,MAAM,EAAS,IAAI,GAC5B,EAAK,OAAO,EAAI,MAAM,OAAO,CAAC,EAAK,MAAM,GAAG,AAE9C,GAAU,EAAK,MAAM,EACrB,IAAkB,GAClB,IAAqB,KAErB,GAAU,EAAE,EACZ,MAAM,2BAEV,CACF,CAAE,MAAO,EAAO,CAEd,MAAM,2CACR,CACF,EAGA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAY,WAAW,KACvB,GACF,GAAY,EAEhB,EAAG,KAEH,CALsB,KAKf,IAAM,aAAa,EAC5B,EAAG,CAAC,EAAgB,GAAY,EAGhC,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAY,WAAW,KACvB,GACF,GAAe,EAEnB,EAAG,KAEH,IALyB,EAKlB,IAAM,aAAa,EAC5B,EAAG,CAAC,EAAmB,GAAe,EAGtC,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAY,WAAW,KACvB,GACF,GAAgB,EAEpB,EAAG,KAEH,KAL0B,CAKnB,IAAM,aAAa,EAC5B,EAAG,CAAC,EAAoB,GAAgB,EAGxC,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAY,WAAW,KACvB,IACF,GAAmB,GAEvB,EAAG,KAEH,MAAO,AALsB,IAKhB,aAAa,EAC5B,EAAG,CAAC,GAAuB,GAAmB,EAe9C,IAAM,GAAmB,MAAO,IAC9B,GAAI,CAEF,IAAM,EAAW,MAAM,MAAM,CAAC,YAAY,EAAE,EAAM,EAAE,CAAA,CAAE,EACtD,GAAI,CAAC,EAAS,EAAE,CACd,CADgB,KACN,AAAJ,MAAU,iCAGlB,IAAM,EAAO,MAAM,EAAS,IAAI,GAC1B,EAAY,EAAK,OAAO,CAAG,EAAK,KAAK,CAAG,KAE9C,GAAI,CAAC,GAAa,CAAC,EAAU,UAAU,CAAE,YACvC,MAAM,mDAKR,GAAI,EAAU,MAAM,EAAE,gBAAkB,UAAW,YACjD,MAAM,4EAA8E,CAAD,CAAW,MAAM,EAAI,SAAA,CAAS,EAKnH,GAAiB,GAGb,EAAU,IAAI,EAAE,CAClB,EAAgB,EAAU,IAAI,EAC9B,EAAkB,EAAU,IAAI,CAAC,QAAQ,GAIvC,EAAU,QAAQ,EAAE,CACtB,EAAoB,EAAU,QAAQ,EACtC,EAAsB,EAAU,QAAQ,CAAC,IAAI,GAI3C,EAAU,QAAQ,EAAE,AACtB,EAAoB,EAAU,QAAQ,EAIpC,EAAU,mBAAmB,EAAE,AACjC,EAAuB,EAAU,mBAAmB,EAIlD,EAAU,KAAK,EAAE,AACnB,EAAS,EAAU,KAAK,EAI1B,IAAM,EAAe,EAAU,UAAU,CAAC,GAAG,CAAC,AAAC,IAAoB,CACnE,GAAI,CAAA,EAAG,CAD2D,IACtD,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAA,CAAI,CACpC,UAAW,EAAU,OAAO,CAAC,EAAE,CAC/B,YAAa,EAAU,OAAO,CAAC,WAAW,CAC1C,YAAa,EAAU,OAAO,CAAC,QAAQ,CACvC,SAAU,EAAU,QAAQ,CAC5B,aAAc,OAAO,EAAU,YAAY,EAC3C,SAAU,OAAO,EAAU,QAAQ,EAAI,GACvC,MAAO,OAAO,EAAU,KAAK,EAC7B,WAAY,OAAO,EAAU,UAAU,EACrC,aAAc,EAAU,OAAO,CAAC,YAAY,CAC5C,UAAW,OAAQ,EAAU,OAAO,CAAS,SAAS,EAAI,GAC5D,CAAC,EAED,GAAgB,GAChB,IAAqB,GACrB,GAAmB,CAAC,OAAO,EAAE,EAAU,EAAE,CAAC,GAAG,EAAE,EAAU,IAAI,EAAE,UAAY,MAAA,CAAO,CAEpF,CAAE,MAAO,EAAO,CAEd,MAAM,kDACR,CACF,EA4GM,GAAoB,CAAC,EAAgB,EAAe,KACxD,GAAgB,GACd,EAAM,GAAG,CAAC,IACR,GAAI,EAAK,EAAE,GAAK,EAAQ,CACtB,IAAI,EAAiB,OAAO,GAGd,YAAY,CAAtB,IACE,GAAkB,GAAG,AACvB,EAAiB,EACjB,CADoB,EACX,CAAC,qBADkC,WACF,EAAE,EAAK,WAAW,CAAA,CAAE,GACrD,EAAiB,EAAK,YAAY,EAAE,AAC7C,GAAS,CAAC,8BAA8B,EAAE,EAAe,0BAA0B,EAAE,EAAK,YAAY,CAAC,MAAM,EAAE,EAAK,WAAW,CAAC,mBAAmB,EAAE,EAAK,YAAY,CAAA,CAAE,EACxK,EAAiB,EAAK,YAAY,EAAE,AAGpC,GAAS,KAIb,IAAM,EAAc,CAAE,GAAG,CAAI,CAAE,CAAC,EAAM,CAAE,CAAe,EAPY,AAanE,OAHA,EAAY,KAAK,CAAG,OAAO,EAAY,QAAQ,EAAI,OAAO,EAAY,YAAY,EAClF,EAAY,UAAU,CAAG,EAAY,KAAK,CAAG,OAAO,EAAY,QAAQ,EAEjE,CACT,CACA,OAAO,CACT,GAEJ,EAQM,GAAS,EAAA,OAAK,CAAC,OAAO,CAAC,KAE3B,IAAM,EAAW,GAAa,MAAM,CAAC,CAAC,EAAK,IAAS,EAAM,OAAO,EAAK,UAAU,EAAG,GAC7E,EAAgB,GAAa,MAAM,CAAC,CAAC,EAAK,IAAS,EAAM,OAAO,EAAK,QAAQ,EAAG,GAGhF,EAAsB,EAAmB,OAAO,IAAa,QAAD,GAAY,EAAiB,UAAU,CAAC,QAAQ,IAAM,GAAA,CAAG,CAAI,EAGzH,EAAe,EAAsB,OAAO,IAAa,GAAgB,KAAjB,sBAA4C,CAAG,GAAA,CAAG,CAAI,EAG9G,EAAW,OAAO,GAAY,OAAO,GAAuB,OAAO,GAGrE,EAAY,EACZ,EAAc,EAiBlB,OAfA,GAAa,OAAO,CAAC,IAEnB,IAAM,EAAW,AAAC,GAAK,SAAS,GAAI,CAAC,CAAI,EAAK,QAAQ,CACtD,GAAa,EAGb,IAAM,EAAiB,OAAO,EAAK,UAAU,EACvC,EAA2B,EAAoB,GAAkB,WAAW,EAAiB,CAA7B,SAAuC,CAAC,QAAQ,IAAM,GAAA,CAAG,CAAK,EAC9H,EAA4B,EAAuB,GAAkB,GAAgB,WAAjB,gBAA4C,CAAG,GAAA,CAAG,CAAK,EAIjI,GAH0B,AACP,EADwB,EAA2B,EAC/B,CAGzC,GAEO,CACL,CAJe,QAIL,OAAO,GACjB,cAAe,OAAO,GACtB,oBAAqB,OAAO,GAC5B,aAAc,OAAO,GACrB,SAAU,OAAO,GACjB,UAAW,OAAO,GAClB,YAAa,OAAO,EACtB,CACF,EAAG,CAAC,GAAc,EAAqB,EAAkB,GAAgB,2BAA2B,CAAC,EAGrG,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,GAAI,MAAqB,GAAe,EAAuB,CAE7D,IAAM,EAAoB,IAAI,KADP,AACY,IADR,KAAK,IAEhC,EAAkB,OAAO,CAAC,EAAkB,OAAO,GAAK,EAAsB,IAAI,EAClF,IAAM,EAAa,EAAkB,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAChE,EAAW,GACX,EAAkB,EAAqB,GACzC,MACE,CADK,CACM,IACX,EAAkB,GAEtB,EAAG,CAAC,EAAa,EAAkB,EAAsB,EAGzD,IAAM,GAAkB,IACf,GAAkB,cAAc,cAAc,SAAS,YAAa,EASvE,GAAuB,MAAO,IAClC,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,CAAC,qBAAqB,EAAE,EAAO,qBAAqB,CAAC,EAC5E,EAAO,MAAM,EAAS,IAAI,GAEhC,GAAI,EAAK,OAAO,CAAE,CAChB,IAAM,EAAgC,EAAK,QAAQ,CAAC,GAAG,CAAC,AAAC,IACvD,IAAM,EAAU,IAAI,KAAK,EAAQ,OAAO,EAClC,EAAQ,IAAI,KAClB,EAAM,QAAQ,CAAC,EAAG,EAAG,EAAG,GACxB,EAAQ,QAAQ,CAAC,EAAG,EAAG,EAAG,GAC1B,IAAM,EAAc,KAAK,IAAI,CAAC,CAAC,EAAM,OAAO,GAAK,EAAQ,OAAO,EAAA,CAAE,CAAK,GAAD,IAAQ,AAE9E,KAFmF,CAE5E,CACL,GAHsF,AAGlF,EAAQ,AAH4E,EAG1E,CACd,cAAe,EAAQ,OAAO,CAAC,aAAa,CAC5C,QAAS,EAAQ,OAAO,CACxB,gBAAiB,OAAO,EAAQ,eAAe,GAAK,EACpD,YAAa,KAAK,GAAG,CAAC,EAAG,EAC3B,CACF,GAKA,GAHA,GAAmB,GACnB,GAAsB,EAAY,MAAM,CAAG,GAEvC,EAAY,MAAM,CAAG,EAAG,CAC1B,IAAM,EAAe,EAAY,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,OAAO,EAAE,eAAe,EAAG,GACrF,GACE,CAAC,iBAAiB,EAAE,EAAY,MAAM,CAAC,iCAAiC,EAAE,EAAa,cAAc,GAAG,qEAAE,CAAC,CAG/G,CACF,CACF,AAJQ,CAAC,AAIP,MAAO,EAAO,CAEhB,CACF,EAWM,GAAiB,IACd,GAAa,IAAI,CAAC,GACvB,EAAK,QAAQ,EAAI,GAAK,EAAK,QAAQ,CAAG,EAAK,SApB+B,CAAC,EAoBpB,EAKrD,GAAe,MAAO,IAG1B,GAFA,EAAE,cAAc,GAEZ,CAAC,EAAc,YACjB,GAAS,wBAIX,GAAI,CAAC,EAAkB,YACrB,GAAS,wCAIX,GAAI,CAAC,EAAkB,YACrB,GAAS,iCAIX,GAA4B,IAAxB,GAAa,MAAM,CAAQ,YAC7B,GAAS,mCAKX,GAAI,MAAqB,GAAoB,CAC3C,IAAM,EAAe,GAAgB,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,OAAO,EAAE,eAAe,EAAG,GACzF,GACE,CAAC,8CAA8C,EAAE,GAAgB,MAAM,CAAC,iCAAiC,EAAE,EAAa,cAAc,GAAG,yEAAE,CAAC,EAG9I,CAFE,CAAC,IAGL,CAGA,IAAM,EAAc,EAAE,CACtB,IAAK,IAAM,KAAQ,GACb,EAAK,QAAQ,AADc,CACX,EAAK,YAAY,EAAE,AACrC,EAAY,IAAI,CAAC,CAAA,EAAG,EAAK,EAT+C,CAAC,QASrC,CAAC,YAAY,EAAE,EAAK,QAAQ,CAAC,YAAY,EAAE,EAAK,YAAY,CAAA,CAAE,EAEhG,EAAK,QAAQ,EAAI,GAAG,AACtB,EAAY,IAAI,CAAC,CAAA,EAAG,EAAK,WAAW,CAAC,mBAAmB,EAAE,EAAK,QAAQ,CAAA,CAAE,EAI7E,GAAI,EAAY,MAAM,CAAG,EAAG,YAC1B,GAAS,CAAC;AAA+C,EAAE,EAAY,IAAI,CAAC,MAAM;AAAA,uCAAyC,CAAC,EAK9H,GAAI,MAAqB,CAAC,CAjEA,KAC1B,GAAI,CAAC,GAAgB,CAAC,KAAmB,OAAO,EAEhD,IAAM,EAAkB,CAAC,EAAa,WAAW,GAAI,CAAC,EAAK,EAAD,AAAc,aAAa,GAAI,CAAC,CAC1F,OAAO,GAAO,QAAQ,EAAI,CAC5B,KA4DmD,CAC/C,IAAM,EAAkB,CAAC,EAAa,WAAW,GAAI,CAAC,EAAK,EAAD,AAAc,aAAa,EAAI,CAAC,EAC1F,GAAS,CAAC,6CAA6C,EAAE,EAAgB,cAAc,GAAG,qBAAqB,EAAE,GAAO,QAAQ,CAAC,cAAc,GAAA,CAAI,EACnJ,MACF,CAEA,IAAa,GACb,GAAS,IACT,GAAW,IAEX,GAAI,CACF,IAAM,EAAU,CACd,GAAI,IAAa,CAAE,GAAI,IAAgB,EAAG,CAAC,aAC3C,EACA,OAAQ,EAAa,EAAE,CACvB,WAAY,EAAiB,EAAE,CAC/B,WAAY,GAAkB,IAAM,KACpC,YAAa,GAAkB,cAAgB,KAC/C,sBAAuB,GAAkB,YAAc,yBACvD,EACA,GAAI,MAAqB,GAAW,SAAE,CAAQ,CAAC,CAC/C,GAAI,IAAiB,CAAE,YAAa,GAAc,WAAW,AAAC,CAAC,CAC/D,MAAO,GAAS,KAChB,MAAO,GAAa,GAAG,CAAC,IAAS,CAC/B,EAD8B,QACnB,EAAK,SAAS,CACzB,SAAU,EAAK,QAAQ,CACvB,aAAc,EAAK,YAAY,CAC/B,SAAU,EAAK,QAAQ,CACzB,CAAC,CACH,EAKM,EAAW,MAAM,MAAM,AAHjB,gBAGsB,CAChC,OAHa,GAAY,MAAQ,OAIjC,QAAS,KACT,KAAM,KAAK,SAAS,CAAC,EACvB,GAEM,EAAO,MAAM,EAAS,IAAI,GAEhC,GAAI,EAAK,OAAO,CAAE,CAChB,GAAW,EAAK,OAAO,EAGvB,IAAM,EAAmB,EAAK,OAAO,EAAE,GAGnC,GAAoB,CAAC,IACvB,GAAwB,GAI1B,CALoC,UAKzB,KACL,AAAC,IACH,KAEF,EAHgB,CAGL,GACb,EAAG,KAGC,EAHM,CAGc,CAAC,IACvB,OADkC,IACvB,KACW,AAChB,OADuB,MACV,CADiB,CAAC,iBALyB,iDAO1D,OAAO,IAAI,CAAC,CAAC,gBAAgB,EAAE,EAAA,CAAkB,CAAE,SAEvD,EAAG,KAEP,MACE,CADK,EACI,EAAK,KAAK,EAAI,mBAE3B,CAAE,MAAO,EAAO,CAEd,GAAS,iDACX,QAAU,CACR,IAAa,EACf,CACF,EAGM,GAAY,KAChB,IAAM,EAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CACpD,EAAe,GACf,EAAsB,EAAqB,IAC3C,EAAgB,MAChB,EAAoB,MACpB,EAAoB,MACpB,GAAuB,GACvB,EAAW,IACX,EAAkB,IAClB,EAAS,IACT,GAAgB,EAAE,EAClB,EAAkB,IAClB,EAAsB,IACtB,EAAqB,IACrB,GAAyB,IACzB,GAAoB,GACpB,IAAwB,GACxB,IAAuB,GACvB,IAA2B,GAC3B,GAAgB,EAAE,EAClB,IAAa,GACb,GAAkB,MAClB,GAAS,IACT,GAAW,IACX,GAAmB,EAAE,EACrB,IAAsB,EACxB,EAGM,GAAe,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,MAAO,EAAe,CAAC,CAAE,EAAiB,EAAE,IAC3E,IAAa,GAEb,GAAI,CACF,IAAM,EAAS,IAAI,gBAAgB,CACjC,KAAM,EAAK,QAAQ,GACnB,MAAO,IACP,OAAQ,EAAO,IAAI,EACrB,GAEM,EAAW,MAAM,MAAM,CAAC,cAAc,EAAE,EAAA,CAAQ,CAAE,CACtD,QAAS,IACX,GACM,EAAO,MAAM,EAAS,IAAI,GAE5B,EAAK,OAAO,EAAE,AAChB,GAAY,EAAK,QAAQ,EACzB,GAAc,EAAK,UAAU,EAC7B,GAAe,KAGf,GAAS,EAAK,KAAK,EAAI,2BACvB,GAAY,EAAE,EAElB,CAAE,MAAO,EAAO,CAEd,GAAS,4CACT,GAAY,EAAE,CAChB,QAAU,CACR,IAAa,EACf,CACF,EAAG,EAAE,EAUC,GAAc,MAAO,IACzB,GAAI,CAIF,IAAM,EAAW,MAAM,MAAM,CAAC,cAAc,EAAE,EAAQ,EAAE,CAAA,CAAE,CAAE,CAC1D,QAAS,IACX,GAGM,EAAO,MAAM,EAAS,IAAI,GAGhC,GAAI,EAAK,OAAO,EAAI,EAAK,OAAO,CAAE,CAChC,IAAM,EAAc,EAAK,OAAO,CAGhC,GAAc,IACd,GAAkB,GAGlB,EAAe,IAAI,KAAK,EAAY,WAAW,EAAE,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,EAC5E,EAAsB,IAAI,KAAK,EAAY,WAAW,EAAE,kBAAkB,CAAC,UAC3E,EAAgB,EAAY,IAAI,EAChC,EAAkB,EAAY,IAAI,CAAC,QAAQ,EAEvC,EAAY,QAAQ,EAAE,CACxB,EAAoB,EAAY,QAAQ,EACxC,EAAsB,EAAY,QAAQ,CAAC,IAAI,GAG7C,EAAY,QAAQ,EAAE,AACxB,EAAoB,EAAY,QAAQ,EAG1C,EAAuB,EAAY,mBAAmB,GAAI,GAC1D,EAAS,EAAY,KAAK,EAAI,IAG1B,EAAY,OAAO,EAAE,CACvB,EAAW,IAAI,KAAK,EAAY,OAAO,EAAE,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,EACpE,EAAkB,IAAI,KAAK,EAAY,OAAO,EAAE,kBAAkB,CAAC,WASrE,IAAM,EAAgC,CAAC,EAAY,YAAY,EAAI,EAAA,AAAE,EAClE,GAAG,CAAC,AAAC,IAEG,CACL,GAAI,CAAC,KAAK,EAAE,EAAK,SAAS,CAAC,CAAC,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAA,CAAI,CAC3D,UAAW,EAAK,SAAS,CACzB,YAAa,EAAK,WAAW,EAAI,GACjC,YAAa,EAAK,WAAW,EAAI,GACjC,SAAU,OAAO,EAAK,QAAQ,EAAI,GAClC,aAAc,OAAO,EAAK,YAAY,EAAI,GAC1C,SAAU,OAAO,EAAK,QAAQ,EAAI,GAClC,MAAO,OAAO,EAAK,KAAK,EAAI,GAC5B,WAAY,OAAO,EAAK,UAAU,EAAI,GACtC,aAAc,OAAO,EAAK,YAAY,EAAI,GAC1C,UAAW,OAAO,EAAK,SAAS,EAAI,GACtC,GAKJ,GAAgB,GAGhB,OAAO,QAAQ,CAAC,CAAE,IAAK,EAAG,SAAU,QAAS,EAE/C,MACE,CADK,KACC,iCAEV,CAAE,MAAO,EAAO,CAEd,MAAM,kDACR,CACF,EAUM,GAAsB,AAAC,IAC3B,GAAiB,GACjB,GAAa,EAAG,EAClB,EAGM,GAAmB,AAAC,IACpB,GAAQ,GAAK,GAAQ,GAAW,UAAU,EAAI,CAAC,IACjD,GAAa,EAAM,EADyC,CAGhE,SAGA,AAAI,EACK,CAAA,EAAA,EAAA,GAAA,EAAC,CADO,KACP,CAAI,UAAW,EAAA,OAAM,CAAC,OAAO,UAAE,4BAIpC,EAKH,CAAA,EAAA,EAAA,IAAA,EAAC,CALgB,KAKhB,CAAI,UAAW,CAAA,EAAG,EAAA,OAAM,CAAC,SAAS,CAAC,CAAC,EAAE,EAAa,OAAS,QAAA,CAAS,WACpE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,MAAM,WAC3B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAW,EAAA,OAAM,CAAC,KAAK,UACxB,GAAa,CAAC,eAAe,EAAE,IAAgB,cAAA,CAAe,CAC9D,GAAY,eAAiB,mBAEhC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAW,EAAA,OAAM,CAAC,QAAQ,UAC1B,GAAa,2CACb,GAAY,uBAAyB,iDAGvC,CAAC,IAAa,EAAA,CAAU,EACvB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,GA5CE,KACnB,IAAc,CA2CgB,EA1C9B,GAAkB,MAClB,IACF,EAwC+C,GACrC,UAAW,EAAA,OAAM,CAAC,WAAW,UAE5B,GAAa,iBAAmB,mBAKvC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,SAAU,GAAc,UAAW,EAAA,OAAM,CAAC,IAAI,WAElD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,KAAK,WAC1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,WAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,EAAA,OAAM,CAAC,KAAK,UAAE,gCAChC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,GACT,UAAW,EAAA,OAAM,CAAC,gBAAgB,CAClC,SAAU,YACX,mBAIH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,eAAe,WACpC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,MAAO,GAAgB,CAAC,OAAO,EAAE,GAAc,EAAE,CAAC,GAAG,EAAE,GAAc,IAAI,EAAE,UAAY,MAAA,CAAO,CAAG,GACjG,SAAU,AAAC,IACT,GAAI,CAAC,IAAiB,GAAgB,CACpC,IAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,CAC5B,GAAmB,GAEf,EAAM,IAAI,GAMZ,CANgB,EACO,GAAO,IAKpB,EAL0B,CAAC,GACnC,EAAM,WAAW,CAAC,WAAW,GAAG,QAAQ,CAAC,EAAM,WAAW,KAC1D,EAAM,IAAI,EAAE,UAAU,cAAc,SAAS,EAAM,WAAW,KAC9D,EAAM,KAAK,EAAE,cAAc,SAAS,EAAM,WAAW,MAKvD,KAEF,IAAqB,EACvB,CACF,EACA,QAAS,KACH,IACF,IAAqB,EAEzB,EACA,IAJsB,GAId,KAEN,WAAW,IAAM,GAAqB,IAAQ,IAChD,EACA,YAAa,GAAiB,0BAA4B,2CAC1D,UAAW,EAAA,OAAM,CAAC,KAAK,CACvB,SAAU,IAAa,CAAC,KAGzB,IACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,KACP,GAAiB,MACjB,GAAmB,IACnB,GAAqB,IACrB,IAAkB,GAClB,GAAU,EAAE,CAGd,EACA,UAAW,EAAA,OAAM,CAAC,WAAW,CAC7B,SAAU,YACX,gBAKF,IAAqB,IAAkB,GAAO,MAAM,CAAG,GACtD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,UAC5B,GAAO,GAAG,CAAC,AAAC,GACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,UAAW,EAAA,OAAM,CAAC,YAAY,CAC9B,QAAS,IAAM,GAAiB,YAEhC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,SAAS,WAC9B,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,WAAO,UAAQ,EAAM,EAAE,IACxB,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,QAAQ,UAAG,EAAM,IAAI,EAAE,UAAY,QAC3D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,SAAS,UAC9B,IAAI,KAAK,EAAM,SAAS,EAAE,kBAAkB,KAE/C,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,UAAU,WAAE,OAC7B,OAAO,EAAM,QAAQ,EAAI,GAAG,OAAO,CAAC,MAE1C,EAAM,KAAK,EACV,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,UAAU,UAAG,EAAM,KAAK,OAd/C,EAAM,EAAE,KAuBpB,IAAqB,IAAoC,IAAlB,GAAO,MAAM,EACnD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,UAC7B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,eAAe,WAAE,0BACd,GAAkB,CAAC,WAAW,EAAE,GAAgB,CAAC,CAAC,CAAG,cAQvF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,GAAG,WACxB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,KAAK,WAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,EAAA,OAAM,CAAC,KAAK,UAAE,oBAChC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,YAAY,aACZ,MAAO,EACP,SAAU,AAAC,IACT,IAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,CAC5B,EAAsB,GAGtB,IAAI,EAAiB,EAAM,OAAO,CAAC,SAAU,IAY7C,GAXI,EAAe,MAAM,EAAI,GAAK,EAAe,MAAM,EAAI,EACzD,CAD4D,CAC3C,EAAe,OAAO,CAAC,mBAAoB,SACnD,EAAe,MAAM,EAAI,GAAG,CACrC,EAAiB,EAAe,OAAO,CAAC,wBAAyB,WAAA,EAG/D,IAAmB,GAAS,EAAe,MAAM,EAAI,IAAI,AAC3D,EAAsB,GAIpB,EAAY,GAAiB,CAC/B,IAAM,EAAU,EAAmB,GAC/B,GACF,EAAe,EAEnB,CACF,CAJiB,CAKjB,OAAQ,AAAC,IAEP,GAAI,CAAC,EADS,EAAE,MAAM,CAAC,CACN,IADW,EACH,CACvB,IAAM,EAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CACpD,EAAe,GACf,EAAsB,EAAqB,GAC7C,CACF,EACA,UAAW,EAAA,OAAM,CAAC,KAAK,CACvB,SAAU,GACV,QAAQ,CAAA,CAAA,EACR,UAAW,QAIf,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,KAAK,WAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,EAAA,OAAM,CAAC,KAAK,UAAE,wBAChC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,eAAe,WACpC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,MAAO,EAAmB,CAAA,EAAG,EAAiB,IAAI,CAAC,EAAE,EAAE,EAAiB,aAAa,CAAC,CAAC,CAAC,CAAG,EAC3F,SAAU,AAAC,IACT,GAAI,CAAC,EAAkB,CACrB,IAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,CAC5B,EAAsB,GAEtB,GAAwB,EAAM,MAAM,CAAG,EACzC,CACF,EACA,QAAS,IAAM,IAAwB,GACvC,OAAQ,KAEN,WAAW,IAAM,IAAwB,GAAQ,IACnD,EACA,YAAY,0CACZ,UAAW,EAAA,OAAM,CAAC,KAAK,CACvB,SAAU,GACV,QAAQ,CAAA,CAAA,IAET,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,KACP,EAAoB,MACpB,EAAsB,IACtB,IAAwB,EAC1B,EACA,UAAW,EAAA,OAAM,CAAC,cAAc,CAChC,SAAU,YACX,MAIF,IAAwB,EAAU,MAAM,CAAG,GAC1C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,UAC5B,EAAU,GAAG,CAAE,AAAD,GACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAEC,UAAW,EAAA,OAAM,CAAC,YAAY,CAC9B,QAAS,KACP,EAAoB,GACpB,EAAsB,IACtB,IAAwB,EAC1B,YAEA,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,OAAO,UAAG,EAAI,IAAI,GACzC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,UAAU,UAAG,EAAI,aAAa,KAThD,EAAI,EAAE,WAiBvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,KAAK,WAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,EAAA,OAAM,CAAC,KAAK,UAAE,4BAChC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,eAAe,WACpC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,MAAO,EAAe,CAAA,EAAG,EAAa,QAAQ,CAAC,EAAE,EAAE,EAAa,SAAS,CAAC,CAAC,CAAC,CAAG,EAC/E,SAAU,AAAC,IACT,GAAI,CAAC,EAAc,CACjB,IAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,CAC5B,EAAkB,GAElB,EAAoB,EAAM,MAAM,CAAG,EACrC,CACF,EACA,QAAS,IAAM,EAAoB,IACnC,OAAQ,KAEN,WAAW,IAAM,GAAoB,GAAQ,IAC/C,EACA,YAAY,kCACZ,UAAW,EAAA,OAAM,CAAC,KAAK,CACvB,SAAU,GACV,QAAQ,CAAA,CAAA,IAGT,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,KACP,EAAgB,MAChB,EAAkB,IAClB,GAAoB,EACtB,EACA,UAAW,EAAA,OAAM,CAAC,cAAc,UACjC,MAKF,GAAoB,EAAM,MAAM,CAAG,GAAK,CAAC,GACxC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,UAC5B,EAAM,GAAG,CAAC,AAAC,GACV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,QAAS,UACP,EAAgB,GAChB,EAAkB,IAClB,GAAoB,GACpB,GAAS,IACT,CADc,EACK,EAAE,EACrB,IAAsB,GAGtB,MAAM,GAAqB,EAAK,EAAE,CACpC,CAN4C,CAO5C,UAAW,EAAA,OAAM,CAAC,YAAY,UAE9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,WAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,UAAG,EAAK,QAAQ,GAC/C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,SAAS,WAAG,EAAK,SAAS,CAAC,MAAI,EAAK,aAAa,QAhBrE,EAAK,EAAE,cA2BzB,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,kBAAkB,UACvC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,eAAe,WACpC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAW,EAAA,OAAM,CAAC,gBAAgB,UAAE,qBACxC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,eAAe,WACpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,cAAc,WACnC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,UAAE,eACrC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,UAAG,EAAa,QAAQ,MAE7D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,cAAc,WACnC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,UAAE,WACrC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,UAAG,EAAa,SAAS,MAE9D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,cAAc,WACnC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,UAAE,aACrC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,UAAG,EAAa,aAAa,MAElE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,cAAc,WACnC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,UAAE,kBACrC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,WAAE,OAAK,EAAa,WAAW,EAAE,kBAAoB,UAE1F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,cAAc,WACnC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,UAAE,qBACrC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,WAAE,OAAK,EAAa,aAAa,EAAE,kBAAoB,UAE5F,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,cAAc,WACnC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,UAAE,sBACrC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAW,CAAA,EAAG,EAAA,OAAM,CAAC,WAAW,CAAC,CAAC,EACrC,CAAC,EAAa,WAAW,GAAI,CAAC,EAAK,EAAD,AAAc,aAAa,GAAI,CAAC,EAAM,EACrE,EAAA,OAAM,CAAC,cAAc,CACrB,EAAA,OAAM,CAAC,eAAe,CAAA,CAC1B,WAAE,OACG,CAAC,CAAC,EAAa,WAAW,GAAI,CAAC,EAAK,EAAD,AAAc,aAAa,EAAI,EAAC,CAAC,CAAE,cAAc,iBASpG,GAAgB,IACf,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,qBAAqB,UAC1C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,kBAAkB,WACvC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAW,EAAA,OAAM,CAAC,mBAAmB,UAAE,8BAC3C,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAW,EAAA,OAAM,CAAC,qBAAqB,WAAE,iBAC3B,GAAgB,MAAM,CAAC,oGAExC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,mBAAmB,UACvC,GAAgB,GAAG,CAAC,AAAC,GACpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAqB,UAAW,EAAA,OAAM,CAAC,kBAAkB,WACxD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,cAAc,WAAE,YAAU,EAAQ,aAAa,IACtE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,WAAW,WAAG,EAAQ,WAAW,CAAC,mBACzD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,aAAa,WAAE,OAAK,OAAO,EAAQ,eAAe,EAAE,cAAc,QAHjF,EAAQ,EAAE,KAOxB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,mBAAmB,UACxC,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAO,UAAW,EAAA,OAAM,CAAC,YAAY,WAAE,sBAClB,GAAgB,MAAM,CAAC,CAAC,EAAK,IAAM,EAAM,OAAO,EAAE,eAAe,EAAG,GAAG,cAAc,aAQnH,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,mBAAmB,WACxC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,KAAK,WAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,EAAA,OAAM,CAAC,KAAK,UAAE,oBAChC,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,MAAO,GAAkB,IAAM,GAC/B,SAAU,AAAC,IACT,IAAM,EAAa,EAAE,MAAM,CAAC,KAAK,CAEjC,EADiB,AACG,EADO,IAAI,CAAC,GAAK,EAAE,EAAE,CAAC,QAAQ,KAAO,IACzB,KAClC,EACA,UAAW,EAAA,OAAM,CAAC,KAAK,CACvB,SAAU,GACV,QAAQ,CAAA,CAAA,YAER,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,GAAG,QAAQ,CAAA,CAAA,WAAC,wBACzB,EAAU,GAAG,CAAC,AAAC,GACd,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAAyB,MAAO,EAAS,EAAE,WACzC,EAAS,YAAY,CAAC,cAAY,EAAS,UAAU,CAAC,OAD5C,EAAS,EAAE,SAO9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,KAAK,WAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,EAAA,OAAM,CAAC,KAAK,UAAE,WAChC,CAAA,EAAA,EAAA,GAAA,EAAC,WAAA,CACC,MAAO,EACP,SAAU,AAAC,GAAM,EAAS,EAAE,MAAM,CAAC,KAAK,EACxC,YAAY,iDACZ,UAAW,EAAA,OAAM,CAAC,UAAU,CAC5B,SAAU,GACV,KAAM,OAKT,MACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,KAAK,WAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,EAAA,OAAM,CAAC,KAAK,UAAE,mBAChC,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACC,MAAO,EAAwB,CAAA,EAAG,EAAsB,KAAK,CAAC,CAAC,EAAE,EAAsB,IAAI,CAAA,CAAE,CAAG,GAChG,SAAU,AAAC,IACT,GAAM,CAAC,EAAO,EAAQ,CAAG,EAAE,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,KACxC,EAAO,SAAS,GAChB,EAAS,EAAe,IAAI,CAAC,GAAO,EAAI,KAAK,GAAK,GAAS,EAAI,IAAI,GAAK,GAC1E,GAzxBlB,EA0xB0C,EAE9B,CAHc,CAId,UAAW,EAAA,OAAM,AA7xBJ,CA6xBK,MAAM,CACxB,SAAU,aAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAAO,MAAM,YAAG,yBAChB,EAAe,GAAG,CAAC,CAAC,EAAQ,IAC3B,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CAEC,MAAO,CAAA,EAAG,EAAO,KAAK,CAAC,CAAC,EAAE,EAAO,IAAI,CAAA,CAAE,WAEtC,EAAO,KAAK,CAAC,KAAG,EAAO,IAAI,CAAC,UAAQ,EAAO,SAAS,CAAG,YAAc,KAHjE,aAYhB,MAAqB,GACpB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,GAAG,UACxB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,KAAK,WAC1B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,EAAA,OAAM,CAAC,KAAK,UAAE,sBAC9B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,YAAY,aACZ,MAAO,EACP,SAAU,AAAC,IACT,IAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,CAC5B,EAAkB,GAGlB,IAAI,EAAiB,EAAM,OAAO,CAAC,SAAU,IAY7C,GAXI,EAAe,MAAM,EAAI,GAAK,EAAe,MAAM,EAAI,EACzD,CAD4D,CAC3C,EAAe,OAAO,CAAC,mBAAoB,SACnD,EAAe,MAAM,EAAI,GAAG,CACrC,EAAiB,EAAe,OAAO,CAAC,wBAAyB,WAAA,EAG/D,IAAmB,GAAS,EAAe,MAAM,EAAI,IAAI,AAC3D,EAAkB,GAIhB,EAAY,GAAiB,CAC/B,IAAM,EAAU,EAAmB,GAC/B,GACF,EAAW,EAEf,CACF,CAJiB,CAKjB,OAAQ,AAAC,IAEH,CAAC,EADS,EAAE,MAAM,CAAC,CACN,IADW,GACD,GAEzB,EAAkB,EAAqB,EAFL,CAItC,EACA,UAAW,EAAA,OAAM,CAAC,KAAK,CACvB,SAAU,GACV,UAAW,KAEb,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,MAAO,CAAE,MAAO,OAAQ,SAAU,SAAU,UAAW,MAAO,QAAS,OAAQ,YAAG,sCACnD,GAAuB,MAAQ,EAAE,gBAS/E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,gBAAgB,WACrC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,oBAAoB,WACzC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,EAAA,OAAM,CAAC,KAAK,UAAE,kBAChC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,eAAe,WACpC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,MAAO,EACP,SAAU,AAAC,IACT,IAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,CAC5B,EAAqB,GAErB,GAAuB,EAAM,MAAM,CAAG,EACxC,EACA,QAAS,IAAM,IAAuB,GACtC,OAAQ,KAEN,WAAW,IAAM,GAAuB,IAAQ,IAClD,EACA,YAAY,qCACZ,UAAW,EAAA,OAAM,CAAC,KAAK,CACvB,SAAU,KAGX,GAAuB,EAAS,MAAM,CAAG,GACxC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,UAC5B,EAAS,GAAG,CAAC,AAAC,GACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,QAAS,IAAM,CAllCN,AAAD,IAC1B,IAAM,EAAe,GAAa,IAAI,CAAC,GAAQ,EAAK,SAAS,GAAK,EAAQ,EAAE,EAE5E,GAAI,EAAc,CAEhB,IAAM,EAAc,OAAO,EAAa,QAAQ,EAAI,EAC9C,EAAgB,EAAQ,YAAY,GAAG,AAE7C,GAAI,EAAc,EAAe,YAC/B,GAAS,CAAC,gBAAgB,EAAE,EAAQ,QAAQ,CAAC,iCAAiC,EAAE,qBAA6C,EAAtB,CAAqC,EAK9I,GAAgB,GACd,EAAM,GAAG,CAAC,IACR,CAPyH,EAOrH,EAAK,SAAS,GAAK,EAAQ,EAAE,CAAE,CACjC,IAAM,EAAW,EAAc,OAAO,EAAK,YAAY,EACjD,EAAgB,EAAW,OAAO,EAAK,QAAQ,EACrD,MAAO,CACL,GAAG,CAAI,CACP,SAAU,EACV,MAAO,EACP,WAAY,CACd,CACF,CACA,OAAO,CACT,GAEJ,KAAO,CAGL,GADyB,AACrB,EAD6B,YAAY,GAAG,AACzB,EAAG,YACxB,GAAS,CAAC,WAAW,EAAE,EAAQ,QAAQ,CAAC,iCAAiC,EAAE,kBAA0C,EAAQ,GAA3B,SAAuC,EAAE,EAM7I,IANqH,AAM/G,EAAe,OAAO,EAAQ,YAAY,EAE1C,EAAQ,CAAW,EAGnB,EAAuB,CAC3B,GAAI,CAAC,KAAK,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,EAAQ,EAAE,CAAA,CAAE,CACtC,UAAW,EAAQ,EAAE,CACrB,YAAa,EAAQ,WAAW,CAChC,YAAa,EAAQ,QAAQ,CAC7B,SAXe,CAWL,CACV,aAAc,EACd,UAAU,CACV,MAAO,EACP,WAXiB,CAWL,CAbG,EAcf,IAZyB,SAYX,EAAQ,YAAY,CAClC,UAAW,EAAQ,SAAS,EAAI,CAClC,EAEA,GAAgB,GAAS,IAAI,EAAO,EAAQ,CAC9C,CAEA,EAAqB,IACrB,EAAY,EAAE,EACd,IAAuB,GACzB,EAkhCuD,GACnC,UAAW,EAAA,OAAM,CAAC,YAAY,UAE9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,WAAW,WAChC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,WAAW,WAChC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,UAAG,EAAQ,WAAW,GACzD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,YAAY,UAAG,EAAQ,QAAQ,MAEzD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,cAAc,WACnC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,cAAY,EAAQ,YAAY,CAAC,cAAc,MACrD,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,cAAY,EAAQ,YAAY,IACtC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,aAAW,EAAQ,QAAQ,WAZhC,EAAQ,EAAE,WAsB3B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,oBAAoB,WACzC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAW,EAAA,OAAM,CAAC,KAAK,UAAE,uBAChC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,eAAe,WACpC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,MAAO,GACP,SAAU,AAAC,IACT,IAAM,EAAQ,EAAE,MAAM,CAAC,KAAK,CAC5B,GAAyB,GAEzB,GAA2B,EAAM,MAAM,CAAG,EAC5C,EACA,QAAS,IAAM,IAA2B,GAC1C,OAAQ,KAEN,WAAW,IAAM,IAA2B,GAAQ,IACtD,EACA,YAAY,sDACZ,UAAW,EAAA,OAAM,CAAC,KAAK,CACvB,SAAU,KAGX,IAA2B,GAAa,MAAM,CAAG,GAChD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,UAC5B,GAAa,GAAG,CAAC,AAAC,GACjB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAEC,QAAS,IAAM,CA/jCH,AAAC,IAG/B,GADyB,AACrB,EAD6B,YAAY,CA/gBhB,EA+gBmB,AACzB,EAAG,YACxB,GAAS,CAAC,WAAW,EAAE,EAAQ,QAAQ,CAAC,iCAAiC,EAAE,kBAA0C,EAAQ,GAA3B,SAAuC,EAAE,EAQ7I,IAGM,AAX+G,EAQ/G,AAGuB,CAC3B,GAAI,CAAC,UAAU,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,EAAQ,EAAE,CAAC,CAAC,EAAE,KAAK,MAAM,GAAA,CAAI,CAC5D,UAAW,EAAQ,EAAE,CACrB,YAAa,EAAQ,WAAW,CAChC,YAAa,CAAA,EAAG,EAAQ,QAAQ,CAAC,OAAO,CAAC,CACzC,SAXe,CAWL,CACV,aAXmB,CAWL,CACd,CAZsB,QACP,CAWL,CACV,MAXY,CAWL,CACP,SAZuB,EACN,CAWL,CACZ,GAfwD,GAG/B,OAYX,EAAQ,YAAY,CAClC,UAAW,EAAQ,SAAS,EAAI,CAClC,EAGA,GAAgB,GAAS,IAAI,EAAO,EAAQ,EAE5C,GAAyB,IACzB,GAAgB,EAAE,EAClB,IAA2B,EAC7B,GA4hC2D,GACvC,UAAW,EAAA,OAAM,CAAC,YAAY,UAE9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,WAAW,WAChC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,WAAW,WAChC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,WAAW,UAAG,EAAQ,WAAW,GACzD,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,YAAY,WAAG,EAAQ,QAAQ,CAAC,gBAE1D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,cAAc,WACnC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,uBAAqB,EAAQ,YAAY,CAAC,cAAc,MAC9D,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,sBACN,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,cAAY,EAAQ,YAAY,IACtC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,aAAW,EAAQ,QAAQ,WAbhC,CAAC,KAAK,EAAE,EAAQ,EAAE,CAAA,CAAE,cAyBtC,GAAa,MAAM,CAAG,GACrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,YAAY,WACjC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAW,EAAA,OAAM,CAAC,YAAY,UAAE,kBACpC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,UAAU,WAC/B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAA,EAAG,EAAA,OAAM,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,GAAgB,0BAA0B,CAAG,EAAA,OAAM,CAAC,qBAAqB,CAAG,GAAA,CAAI,WACxH,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,iBACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,iBACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,QACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,kBACJ,GAAgB,0BAA0B,EAAI,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,aACpD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,UACJ,CAAC,GAAgB,cAAc,EAAI,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,SACxC,CAAC,GAAgB,cAAc,EAAI,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,WACzC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,gBACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,eAEP,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,SAAS,UAC7B,GACE,IAAI,CAAC,CAAC,EAAG,IAER,AAAuB,IAAnB,EAAE,YAAY,EAA6B,GAAG,CAAtB,EAAE,YAAY,CAAe,EAClC,IAAnB,EAAE,YAAY,EAA6B,GAAG,CAAtB,EAAE,YAAY,CAAe,CAAC,EACnD,GAAG,AAEX,GAAG,CAAC,AAAC,IAqEE,IAAM,EAGA,QAvEd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAkB,KAHsC,KAG3B,CAAA,EAAG,EAAA,OAAM,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,GAAgB,0BAA0B,CAAG,EAAA,OAAM,CAAC,iBAAiB,CAAG,GAAA,CAAI,WAC9H,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,WAAW,UAAG,EAAK,WAAW,GACrD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,WAAW,UAAG,EAAK,WAAW,GACrD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,UAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,SACL,IAAI,IACJ,IAAK,EAAK,YAAY,CACtB,KAAK,IACL,MAAO,EAAK,QAAQ,CACpB,SAAW,AAAD,GAAO,GAAkB,EAAK,EAAE,CAAE,WAAY,WAAW,EAAE,MAAM,CAAC,KAAK,GAAK,GACtF,QAAS,EAAA,sBAAsB,CAC/B,UAAW,CAAA,EAAG,EAAA,OAAM,CAAC,aAAa,CAAC,CAAC,EAAE,EAAK,QAAQ,CAAG,EAAK,YAAY,CAAG,EAAA,OAAM,CAAC,aAAa,CAAG,GAAA,CAAI,CACrG,MAAO,CAAC,iBAAiB,EAAE,EAAK,YAAY,CAAA,CAAE,CAC9C,SAAU,OAGd,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,YAAY,UACjC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,SACL,IAAI,IACJ,KAAK,OACL,MAAO,EAAK,YAAY,CACxB,SAAU,AAAC,GAAM,GAAkB,EAAK,EAAE,CAAE,eAAgB,WAAW,EAAE,MAAM,CAAC,KAAK,GAAK,GAC1F,QAAS,EAAA,sBAAsB,CAC/B,UAAW,EAAA,OAAM,CAAC,UAAU,CAC5B,SAAU,IAAc,GAAgB,sBAAsB,EAAI,AAAsB,MAAjB,YAAY,CACnF,MACE,GAAa,0BACS,IAAtB,EAAK,YAAY,CACb,8CACC,GAAgB,sBAAsB,CAAG,sDAAwD,OAI3G,GAAgB,0BAA0B,EACzC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,UAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,SACL,IAAI,IACJ,KAAK,OACL,MAAO,EAAK,QAAQ,CACpB,SAAU,AAAC,GAAM,GAAkB,EAAK,EAAE,CAAE,WAAY,WAAW,EAAE,MAAM,CAAC,KAAK,GAAK,GACtF,QAAS,EAAA,sBAAsB,CAC/B,UAAW,EAAA,OAAM,CAAC,aAAa,CAC/B,YAAY,OACZ,SAAU,IAAc,GAAgB,kBAAkB,EAA0B,IAAtB,EAAK,YAAY,CAC/E,MACE,GAAa,0BACS,IAAtB,EAAK,YAAY,CACb,oDACC,GAAgB,kBAAkB,CAAG,iDAAmD,OAKrG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,KAAK,WAAE,OACvB,EAAK,KAAK,CAAC,cAAc,MAE/B,CAAC,GAAgB,cAAc,EAC9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,IAAI,WAAE,OACtB,CAAC,EAAK,SAAS,CAAG,EAAK,QAAA,AAAQ,EAAE,cAAc,MAGvD,CAAC,GAAgB,cAAc,EAC9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,MAAM,WAAE,UAGE,EAAoB,EAAK,UAAU,EAAI,CAAD,UAAY,EAAiB,UAAU,CAAC,QAAQ,IAAM,GAAA,CAAG,CAAK,IAGnG,EAAuB,EAAK,UAAU,EAAI,CAAD,EAAiB,2BAA2B,CAAG,GAAA,CAAG,CAAK,EAKvH,CAAC,AAFmB,EAAK,UAAU,CAAG,EAAuB,EAClD,EAAK,EACM,OADG,CAAG,EAAK,QAAQ,AACnB,CAAS,CAAE,cAAc,OAI5D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,UAAU,WAAE,OAC5B,EAAK,UAAU,CAAC,cAAc,MAErC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,OAAO,WAC3B,CAAC,IACA,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,cA/nCZ,EA+nC8B,EAAK,EAAE,MA9nC9D,GAAgB,GAAS,EAAM,MAAM,CAAC,GAAQ,EAAK,EAAE,GAAK,KA+nCpC,UAAW,EAAA,OAAM,CAAC,YAAY,UAC/B,WAIF,IACC,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,EAAA,OAAM,CAAC,aAAa,UAAE,mBA9FnC,EAAK,EAAE,SAuGvB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,aAAa,UAClC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,UAAU,WAC/B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,WAC7B,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,YAAU,EAAmB,CAAC,GAAG,EAAE,EAAiB,YAAY,CAAC,WAAW,EAAE,EAAiB,UAAU,CAAC,EAAE,CAAC,CAAG,GAAG,OACzH,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,OAAK,GAAO,QAAQ,CAAC,cAAc,SAE1C,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,WAC7B,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,oBAAkB,EAAiB,UAAU,CAAC,SACpD,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,SAAO,GAAO,mBAAmB,CAAC,cAAc,SAGzD,GAAgB,0BAA0B,EACzC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,WAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,+BACN,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,OAAK,GAAO,aAAa,CAAC,cAAc,SAGjD,GAAgB,wBAAwB,EACvC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,WAC7B,CAAA,EAAA,EAAA,IAAA,EAAC,QAAA,CAAM,UAAW,EAAA,OAAM,CAAC,iBAAiB,WACxC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,WACL,QAAS,EACT,SAAU,AAAC,GAAM,EAAuB,EAAE,MAAM,CAAC,OAAO,EACxD,UAAW,EAAA,OAAM,CAAC,QAAQ,GAE5B,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,kBAAgB,GAAgB,2BAA2B,CAAC,YAEpE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UACE,GAAuB,GAAO,YAAY,CAAG,EAC1C,CAAC,MAAM,EAAE,GAAO,YAAY,CAAC,cAAc,GAAA,CAAI,CAC/C,aAIV,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAA,EAAG,EAAA,OAAM,CAAC,QAAQ,CAAC,CAAC,EAAE,EAAA,OAAM,CAAC,QAAQ,CAAA,CAAE,WACrD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,eACN,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,OAAK,GAAO,QAAQ,CAAC,cAAc,SAE1C,CAAC,GAAgB,cAAc,EAC9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,QAAQ,WAC7B,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,gBACN,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,OAAK,GAAO,SAAS,CAAC,cAAc,SAG7C,CAAC,GAAgB,cAAc,EAC9B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,CAAA,EAAG,EAAA,OAAM,CAAC,QAAQ,CAAC,CAAC,EAAE,EAAA,OAAM,CAAC,SAAS,CAAA,CAAE,WACtD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,kBACN,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,MAAO,CAAC,MAAO,GAAO,WAAW,EAAI,EAAI,UAAY,UAAW,WAAY,MAAM,YAAG,OACpF,GAAO,WAAW,CAAC,cAAc,iBASnD,IAAS,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,KAAK,UAAG,KACxC,IAAW,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,OAAO,UAAG,KAG7C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,aAAa,WAEjC,CAAC,IACA,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,UAAW,EAAA,OAAM,CAAC,YAAY,CAC9B,SAAU,IAAa,CAAC,GAAgB,CAAC,GAA4C,AAAxB,OAAa,MAAM,EAAU,MAAqB,MAAqB,GACpI,MACE,KAAmB,iDAClB,MAAqB,GAAsB,0DAA4D,YAGzG,GAAY,gBAAkB,KAAmB,yBAA4B,GAAY,iBAAmB,mBAKhH,CAAC,IAAc,IACd,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,OAAO,IAAI,CAAC,CAAC,gBAAgB,EAAE,GAAA,CAAsB,CAAE,UACtE,UAAW,EAAA,OAAM,CAAC,sBAAsB,CACxC,SAAU,GACV,MAAM,0CACP,2BAMF,IAAc,IACb,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,OAAO,IAAI,CAAC,CAAC,gBAAgB,EAAE,GAAe,EAAE,CAAA,CAAE,CAAE,UACnE,UAAW,EAAA,OAAM,CAAC,kBAAkB,CACpC,SAAU,YACX,iCAQP,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,YAAY,WACjC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,cAAc,WACnC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAW,EAAA,OAAM,CAAC,QAAQ,UAAE,oBAChC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,gBAAgB,WACrC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,eAAe,WACpC,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACC,KAAK,OACL,YAAY,2CACZ,MAAO,GACP,SAAW,AAAD,GAAO,GAAiB,EAAE,MAAM,CAAC,KAAK,EAChD,WAAY,AAAC,IACG,SAAS,CAAnB,EAAE,GAAG,EACP,GAAoB,GAExB,EACA,UAAW,EAAA,OAAM,CAAC,WAAW,GAE/B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAoB,IACnC,UAAW,EAAA,OAAM,CAAC,YAAY,CAC9B,SAAU,YACX,UAIH,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAa,EAAG,IAC/B,UAAW,EAAA,OAAM,CAAC,UAAU,CAC5B,SAAU,YAET,GAAY,aAAe,iCAKjC,GAAS,MAAM,CAAG,GACjB,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,aAAa,WAClC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,WAAW,WAChC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,cACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,SACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,SACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,UACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,cACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,UACL,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAI,eAEP,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,SAAS,UAC7B,GAAS,GAAG,CAAC,AAAC,GACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAqB,UAAW,EAAA,OAAM,CAAC,QAAQ,WAC9C,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,aAAa,UAAG,EAAQ,aAAa,GAC5D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAK,IAAI,KAAK,EAAQ,WAAW,EAAE,kBAAkB,KACtD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,UAAK,EAAQ,IAAI,CAAC,QAAQ,GAC3B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAAK,EAAQ,YAAY,CAAC,MAAM,CAAC,YAClC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WAAI,OAAK,OAAO,EAAQ,QAAQ,EAAE,cAAc,MACjD,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,KAAK,CAAE,MAAO,EAAQ,KAAK,EAAI,oBACnD,EAAQ,KAAK,CAAI,EAAQ,KAAK,CAAC,MAAM,CAAG,GAAK,CAAA,EAAG,EAAQ,KAAK,CAAC,SAAS,CAAC,EAAG,IAAI,GAAG,CAAC,CAAG,EAAQ,KAAK,CAAI,MAE1G,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,OAAO,WAC5B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,UAAW,EAAA,OAAM,CAAC,UAAU,CAC5B,QAAS,IAAM,GAAY,GAC3B,SAAU,YACX,SAGD,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,UAAW,EAAA,OAAM,CAAC,WAAW,CAC7B,QAAS,IAAM,OAAO,IAAI,CAAC,CAAC,gBAAgB,EAAE,EAAQ,EAAE,CAAA,CAAE,CAAE,UAC5D,SAAU,GACV,MAAM,yBACP,eAtBK,EAAQ,EAAE,QAgCzB,GAAW,UAAU,CAAG,GACvB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,UAAU,WAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,cAAc,UACnC,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,QACE,GAAW,WAAW,CAAC,OAAK,GAAW,UAAU,CAAC,IACtD,GAAW,UAAU,CAAC,mBACvB,IAAiB,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WAAK,oBAAkB,GAAc,YAG5D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,iBAAiB,WACtC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAiB,GAAc,GAC9C,SAAU,CAAC,GAAW,OAAO,EAAI,GACjC,UAAW,EAAA,OAAM,CAAC,UAAU,UAC7B,eAKA,CAAC,KACA,IAAM,EAAQ,EAAE,CACV,EAAa,GAAW,UAAU,CAGxC,GAAI,GAAc,EAEhB,CAFmB,GAEd,IAAI,EAAI,EAAG,GAAK,EAAY,IAAK,AACpC,EAAM,IAAI,CAAC,OAER,CAEL,EAAM,IAAI,CAAC,GAEP,GAAU,GAAG,AACf,EAAM,IAAI,CAAC,OAGb,IAAM,EAAQ,KAAK,GAAG,CAAC,EAAG,GAAU,GAC9B,EAAM,KAAK,GAAG,CAAC,EAAa,EAAG,GAAU,GAE/C,IAAK,IAAI,EAAI,EAAO,GAAK,EAAK,IAAK,AAC7B,AAAC,EAAM,QAAQ,CAAC,IAAI,AACtB,EAAM,IAAI,CAAC,EAIX,CAxBU,GAwBA,EAAa,GACzB,AAD4B,EACtB,IAAI,CAAC,OAGT,AAAC,EAAM,QAAQ,CAAC,IAClB,EAAM,IAAI,CAAC,EADoB,AAGnC,CAEA,OAAO,EAAM,GAAG,CAAC,CAAC,EAAM,IACb,QAAT,EACE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAA+B,UAAW,EAAA,OAAM,CAAC,QAAQ,UAAE,OAAjD,CAAC,SAAS,EAAE,EAAA,CAAO,EAE9B,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAEC,QAAS,IAAM,GAAiB,GAChC,UAAW,CAAA,EAAG,EAAA,OAAM,CAAC,UAAU,CAAC,CAAC,EAAE,IAAS,GAAc,EAAA,OAAM,CAAC,UAAU,CAAG,GAAA,CAAI,CAClF,SAAU,YAET,GALI,IASb,CAAC,GAED,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,IAAM,GAAiB,GAAc,GAC9C,SAAU,CAAC,GAAW,OAAO,EAAI,GACjC,UAAW,EAAA,OAAM,CAAC,UAAU,UAC7B,oBAUU,IAApB,GAAS,MAAM,EAAU,CAAC,IACzB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,UAAU,WAC/B,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,WAAE,oBAAkB,GAAgB,CAAC,WAAW,EAAE,GAAc,CAAC,CAAC,CAAG,GAAG,OACzE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,UAAE,sEAx+BJ,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAW,EAAA,OAAM,CAAC,YAAY,UAAE,uCA8+BhD"}